/* Copyright 2018-2022 ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE - author Yves Piguet */
(function(){
var x,aa="function"==typeof Object.create?Object.create:function(a){function c(){}c.prototype=a;return new c},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Qh:!0},ea={};try{ea.__proto__=da;ca=ea.Qh;break a}catch(a){}ca=!1}ba=ca?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)},ia="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ja(a,c){if(c){var b=ia;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&ha(b,a,{configurable:!0,writable:!0,value:c})}}
ja("Array.prototype.find",function(a){return a?a:function(a,b){a:{var c=this;c instanceof String&&(c=String(c));for(var e=c.length,f=0;f<e;f++){var g=c[f];if(a.call(b,g,f,c)){a=g;break a}}a=void 0}return a}});ja("Array.prototype.fill",function(a){return a?a:function(a,b,d){var c=this.length||0;0>b&&(b=Math.max(0,c+b));if(null==d||d>c)d=c;d=Number(d);0>d&&(d=Math.max(0,c+d));for(b=Number(b||0);b<d;b++)this[b]=a;return this}});
ja("Math.sign",function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}});ja("Math.log10",function(a){return a?a:function(a){return Math.log(a)/Math.LN10}});var ka="function"==typeof Object.assign?Object.assign:function(a,c){for(var b=1;b<arguments.length;b++){var d=arguments[b];if(d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a};ja("Object.assign",function(a){return a||ka});
ja("Math.trunc",function(a){return a?a:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b}});var la,na,pa;function ra(a,c){this.name=a;this.xe=c}var sa=[];function ua(){var a=va;if(a)for(var c=sa.length-1;0<=c;c--)sa[c]instanceof a&&sa.splice(c,1);else sa=[]}ra.prototype.b=function(){throw"not implemented";};ra.prototype.addEventListener=function(){throw"not implemented";};function va(a,c,b){ra.call(this,a,c);this.url=b}va.prototype=Object.create(ra.prototype);va.prototype.constructor=va;function wa(a,c,b,d){var e=new XMLHttpRequest;e.timeout=5E3;b&&(e.addEventListener("timeout",function(){b(null)}),e.addEventListener("error",function(){b(null)}),e.addEventListener("load",function(){switch(e.status){case 200:b(e.responseText);break;default:b(null)}}));e.open(a,c,!0);e.send(d)}
function xa(a,c){a=a||"";wa("GET",a+"/nodes",function(b){null!==b&&(b=JSON.parse(b),0===b.length?xa(a,c):(ua(),b.forEach(function(b){var c=new va(b.name,b.aeslId,a+"/nodes/"+b.name,b.protocolVersion);wa("GET",a+"/nodes/"+b.name,function(a){c.description=a?JSON.parse(a):""});sa.push(c)}),c&&c()))})}
function ya(a,c){return"<!DOCTYPE aesl-source>\n<network>\n"+[].map(function(a){return"<event size='"+(a.size||0).toString(10)+"' name='"+a.name+"'/>\n"}).join("")+"<keywords flag='true'/>\n<node nodeId='"+(a.xe||1).toString(10)+"' name='"+a.name+"'><![CDATA["+c+"]]\x3e</node>\n</network>\n"}va.prototype.b=function(a){a=ya(this,a);wa("PUT",this.url,void 0,a)};
va.prototype.addEventListener=function(a,c){a=a.toString();var b=this.url+"/events";a&&(b+="/"+a);b=new EventSource(b);b.onmessage=function(b){c(b.data.split(" ").slice(1).map(function(a){return parseInt(a,10)}),a)};return b};function y(a){this.name=a.name;this.type=a.type;this.va=a.va||["b","a"];this.sh=a.sh||!1;this.sa=a.sa||null;this.fb=a.fb||null;this.df=a.df||null;this.ha=a.ha;this.Sf=a.Sf||null;this.Re=a.Re||null;this.Vc=a.Vc||null;this.Mb=a.Mb||{aseba:"e"===this.type?function(a){return{je:"# onevent "+a.T.name+"\n"}}:function(a){return{ya:"# "+a.T.name+"\n"}}};this.J=a.J||function(a,b){a.text(b.T.name)};this.Ie=a.Ie||!1;this.fa=a.fa||null;this.Qa=a.Qa||null;this.jd=a.jd||null}var Ba=[];
function Ca(a,c,b,d){var e=null;for(b=b||{K:0,Jh:1};;){var f=/`([^`]*)`/.exec(a);if(null==f)break;e=(new Function("$","i","slowdown","rgb","toFixed","return "+f[1]+";"))(c,b.K,b.Jh,function(a){a=[a[0],Math.max(.2+.8*a[1],a[2]/2),a[2]];var b=Math.max(a[0],Math.max(a[1],a[2]));return a.map(function(a){return.88*(1-b)+(.12+.88*b)*a})},function(a,b){return parseFloat(a.toFixed(void 0===b?2:b)).toString()});a=a.slice(0,f.index)+e+a.slice(f.index+f[0].length)}return d?e:a};function A(a){this.controls=a||[]}function Da(a,c,b,d,e,f,g,k){this.top=a;this.left=c;this.bottom=b;this.right=d;this.l=e;this.i=f;this.b=g;this.u=k||null};function B(a,c,b){this.T=a;this.Gb=c;this.Ve=b;this.locked=this.disabled=!1;this.marks={};this.h=a.sa?a.sa():null;this.b=this.i=null}B.prototype.sb=function(a,c,b,d){a=new B(this.T,a,c);a.disabled=this.disabled;a.i=b;a.b=d;this.h&&(a.h=this.h.slice());return a};function D(a){a.i&&a.i()}function F(a){a.b&&a.b()}B.prototype.l=function(a,c){return this.disabled?{}:this.T.Mb[a]?this.T.Mb[a](this,c):Ea[a].b(this)};function Fa(a,c,b){B.call(this,Ha[a],c,b)}Fa.prototype=Object.create(B.prototype);Fa.prototype.constructor=Fa;var Ha={e:new y({name:"empty e",type:"e",J:function(a,c,b,d){var e=Ia("!empty event");e&&e.J(a,c,b,d)}}),a:new y({name:"empty a",type:"a",J:function(a,c,b,d){var e=Ia("!empty action");e&&e.J(a,c,b,d)}}),s:new y({name:"empty s",type:"s",J:function(a,c,b,d){var e=Ia("!empty state")||Ia("!empty event");e&&e.J(a,c,b,d)}})};Fa.prototype.l=function(){return{}};function Ja(){this.X=[];this.actions=[];this.error=null;this.locked=this.disabled=!1}x=Ja.prototype;x.sb=function(){for(var a=new Ja,c=0;c<this.X.length;c++)a.Yb(this.X[c]);for(c=0;c<this.actions.length;c++)a.Yb(this.actions[c]);return a};x.Tb=function(){return 0===this.X.length&&0===this.actions.length};function Ka(a){for(var c=0;c<a.X.length;c++)if("init"===a.X[c].T.name)return a.X[c];return null}
x.Yb=function(a,c,b,d,e){if(a){switch(a.T.type){case "e":case "s":if(a.Gb===this)c&&(this.X.splice(a.Ve.index,1),e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null),this.X.splice(c.index,0,a));else if(c){if(this.X[c.index]===a)return;e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null);this.X[c.index]=a}else e?(a.i=b||null,a.b=d||null):a=a.sb(this,{kd:!0,index:this.X.length},b||null,d||null),this.X.push(a);break;case "a":case "c":if(a.Gb===this)c&&(this.Gg(a.Ve),e?(a.i=b||null,a.b=d||
null):a=a.sb(this,c,b||null,d||null),(c.kd?this.X:this.actions).splice(c.index,0,a));else if(c){if((c.kd?this.X:this.actions)[c.index]===a)return;e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null);(c.kd?this.X:this.actions)[c.index]=a}else e?(a.i=b||null,a.b=d||null):a=a.sb(this,{kd:!1,index:this.actions.length},b||null,d||null),this.actions.push(a)}La(this)}};
x.Gg=function(a){a.kd?this.X[a.index]&&(this.X.splice(a.index,1),La(this)):this.actions[a.index]&&(this.actions.splice(a.index,1),La(this))};function La(a){a.X.forEach(function(a,b){a.Gb=this;a.Ve={kd:!0,index:b}},a);a.actions.forEach(function(a,b){a.Gb=this;a.Ve={kd:!1,index:b}},a)}
x.qf=function(a){function c(a,b){if(a.disabled)return b.disabled?0:1;if(b.disabled)return-1;a=a.T.name;b=b.T.name;return a>b?1:a<b?-1:0}function b(a,b){if(null===a.h&&null===b.h)return!0;if(null===a.h||null===b.h||a.h.length!==b.h.length)return!1;for(var c=0;c<a.h.length;c++)if(a.h[c]!==b.h[c])return!1;return!0}function d(a){for(var b=0;b<a.X.length;b++)if(!a.X[b].disabled)return!1;return!0}if(!(this.disabled||a.disabled||d(this)||d(a)||0===this.X.length||a.X.length!==this.X.length)){for(var e=this.X.slice(0,
1).concat(this.X.slice(1).sort(c)),f=a.X.slice(0,1).concat(a.X.slice(1).sort(c)),g=0;g<e.length&&!e[g].disabled&&!f[g].disabled;g++)if(e[g].T!==f[g].T||!b(e[g],f[g]))return;if(null==this.error||this.error.Wb)e=new Na("Rules with same events"),Pa(e,a),this.error=e;if(null==a.error||a.error.Wb)e=new Na("Rules with same events"),Pa(e,this),a.error=e}};function Qa(a){Ja.call(this);this.ke=a||""}Qa.prototype=Object.create(Ja.prototype);x=Qa.prototype;x.constructor=Qa;x.sb=function(){return new Qa(this.ke)};x.Tb=function(){return!1};x.Yb=function(){throw"internal";};x.Gg=function(){throw"internal";};x.qf=function(){};function Ra(){this.b=[];this.wb=this.Ee=this.hc=!1;this.l=!0;this.i=this.u=!1}function Sa(a,c){a.b=c.slice()}Ra.prototype.toggle=function(a){var c=this.b.indexOf(a);0<=c?this.b.splice(c,1):this.b.push(a)};function Ta(){this.b={};this.language="en"}function Ua(a,c,b){a.b[c]||(a.b[c]={});a=a.b[c];for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}Ta.prototype.translate=function(a,c){return(c=this.b[c||this.language])&&c[a]||a};function Va(){this.b={};this.ff={};this.i=null}Va.prototype.add=function(a){for(var c in a)if(a.hasOwnProperty(c)){this.b[c]||(this.b[c]={});for(var b in a[c])if(a[c].hasOwnProperty(b)){this.b[c][b]||(this.b[c][b]={});for(var d in a[c][b])a[c][b].hasOwnProperty(d)&&(this.b[c][b][d]=a[c][b][d].slice())}}};function Wa(a){a.ff={};a.i=null}Va.prototype.get=function(a,c,b){return this.b[a]&&this.b[a][c]&&this.b[a][c][b]?this.b[a][c][b]:null};
function Xa(a,c){var b="";c.forEach(function(a){function c(b,c){b=a.split(b);if(1<b.length){a=b[0];for(var d=1;d<b.length;d++)a+=(1==d%2?"<":"</")+c+">"+b[d];0==b.length%2&&(a+="</"+c+">")}}a=a.replace(/&\s/g,"&amp; ");var d="p";/^###/.test(a)?(a=a.slice(2),d="h4"):/^##/.test(a)?(a=a.slice(2),d="h3"):/^#/.test(a)&&(a=a.slice(1),d="h2");c(/\*\*|__/,"strong");for(c(/\*|_/,"em");;){var g=/!\[([^\]]*)\]\(([^)]*)\)/.exec(a);if(!g)break;var k=this.ff[g[2]]||(this.i?this.i(g[2]):g[2]);a=a.slice(0,g.index)+
'<img src="'+k+'" alt="'+g[1]+'">'+a.slice(g.index+g[0].length)}a=a.replace(/\[([^\]]*)\]\(([^)]*)\)/g,'<a href="$2">$1</a>');b="p"===d&&/^<img /.test(a)&&!/^.+<img/.test(a)?b+('<p class="md parimg">'+a+"</"+d+">\n"):b+("<"+d+' class="md">'+a+"</"+d+">\n")},a);return b}
Va.prototype.bd=function(a,c,b,d){d=d&&d[a]?"<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>\n"+d[a]+"</div>\n":"<html>\n<style>\nbody {font-family: sans-serif;}\nimg {float: left; margin-right: 10px; margin-bottom: 20px;}\nh1, h2, hr {clear: left;}\np {margin-left: 120px}\np.parimg {margin-left: 0}\n</style>\n<body>\n<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>\nBUTTONS<hr>\nBLOCKS</div>\n</body>\n</html>\n";var e="";c.forEach(function(b){(b=
this.get(a,"buttons",b))&&(e+=Xa(this,b))},this);var f="";b.forEach(function(b){(b=this.get(a,"blocks",b))&&(f+=Xa(this,b))},this);return d.replace("BUTTONS",e).replace("BLOCKS",f)};function Ya(a){this.filename=null;this.Pe=this.readOnly=!1;this.mode="b";this.ta=this.$e=!1;this.Zb=Za;this.kh=!1;this.volume=null;this.j=[];this.ca=-1;this.Af=1;this.Vb=!1;this.Bg=!0;this.Ac=this.qc=!1;this.H=this.u=this.w=this.qa=null;this.xd=new $a;this.code={};this.Bb="aseba";this.message=null;this.ec=ab;this.b=bb;this.jc=cb;this.i=db;this.W=a||new Ra;this.l=null}var Ea={},eb=!0,ab=[],bb=!1,db=!0,cb=[];
function fb(){ab=gb("b").map(function(a){return a.name});cb=gb("a").map(function(a){return a.name})}function hb(a){var c=G.map(function(a){return a.name});switch(a){case "b":ab=c;break;case "a":cb=c}}x=Ya.prototype;x.We=function(){this.W.b=[]};function ib(a,c){c?(c=a.xd,c.Hc=[],c.Id=[]):a.yb();a.mode="b";a.ec=ab;a.b=bb;a.jc=cb;a.i=db;a.filename=null;a.j=[];a.code={};a.Bg=!0;jb(a)}x.Tb=function(){for(var a=0;a<this.j.length;a++)if(!this.j[a].Tb())return!1;return!0};
x.getError=function(){for(var a=0;a<this.j.length;a++)if(null!==this.j[a].error)return this.j[a].error;return null};function kb(a){if("b"===a.mode?a.b:a.i)return!1;for(var c=0;c<a.j.length;c++)if(1<a.j[c].X.length||0<a.j[c].X.length&&"s"===a.j[c].X[0].T.type)return!1;return!0}x.yb=function(){this.xd.yb(lb(this,{filename:!0}),{Vb:this.Vb,qc:this.qc,Ac:this.Ac});this.code={};this.Ac=this.qc=this.Vb=!1};function mb(a){a.w&&a.w()}
x.ig=function(a){if(0<this.xd.Hc.length){var c=this.xd.ig(lb(this,{filename:!0}),{Vb:this.Vb,qc:this.qc,Ac:this.Ac});nb(this,c.state,a);this.Vb=c.marks.Vb;this.qc=c.marks.qc;this.Ac=c.marks.Ac;this.code={}}};x.Fg=function(a){if(0<this.xd.Id.length){var c=this.xd.Fg(lb(this,{filename:!0}),{Vb:this.Vb,qc:this.qc,Ac:this.Ac});nb(this,c.state,a);this.Vb=c.marks.Vb;this.qc=c.marks.qc;this.Ac=c.marks.Ac;this.code={}}};
function ob(a,c){c!==a.mode&&(a.yb(),a.mode=c,a.j.forEach(function(a){a.X.forEach(function(b,c){a.X[c]=b});a.actions.forEach(function(b,c){a.actions[c]=b})}))}var Za="s";function jb(a){if(0!==a.j.length&&a.j[a.j.length-1].Tb())for(;1<a.j.length&&a.j[a.j.length-2].Tb();)a.j.splice(-2,1);else a.j.push(new Ja),jb(a)}
function lb(a,c){var b={};c&&!1===c.qd||(b.basicBlocks=a.ec,b.basicMultiEvent=a.b,eb&&(b.advanced="a"===a.mode,b.advancedBlocks=a.jc,b.advancedMultiEvent=a.i),b.disabledUI=a.W.b);c&&c.filename&&(b.filename=a.filename);if(c&&!1===c.td)return b;c=a.u?a.u():null;var d=null;null==c&&(d=a.j.map(function(a){function b(a){a&&c.push({name:a.T.name,disabled:a.disabled,locked:a.locked,param:a.T.Sf?a.T.Sf(a):a.h?a.h.slice():null})}var c=[];if(a instanceof Qa)return{comment:a.ke,disabled:a.disabled,locked:a.locked};
a.X.forEach(function(a){b(a)});a.actions.forEach(function(a){b(a)});return{blocks:c,disabled:a.disabled,locked:a.locked}}));b.program=d;b.code=c;return b}function pb(a,c){return JSON.stringify(lb(a,c),null,"\t")}
function nb(a,c,b,d){var e=!1,f="vpl";try{if(c){!c.disabledUI||d&&d.Ai||Sa(a.W,c.disabledUI);if(!d||!d.yi){var g=1==c.advanced;eb?(a.mode=g?"a":"b",a.ec=c.basicBlocks||ab,a.b=void 0!==c.basicMultiEvent?c.basicMultiEvent:bb,a.jc=c.advancedBlocks||cb,a.i=void 0!==c.advancedMultiEvent?c.advancedMultiEvent:db):(a.mode="b",a.ec=g?c.advancedBlocks||cb:c.basicBlocks||ab,a.b=g?void 0!==c.advancedMultiEvent?c.advancedMultiEvent:db:void 0!==c.basicMultiEvent?c.basicMultiEvent:bb)}if(!d||!d.gh)if(c.program?
a.j=c.program.map(function(c){if(c.hasOwnProperty("comment")){var d=new Qa(c.ke);d.disabled=c.disabled||!1;d.locked=c.locked||!1;return d}var f=new Ja;c.blocks.forEach(function(c){var d=Ia(c.name);if(d){var g=new B(d,null,null);g.disabled=c.disabled||!1;g.locked=c.locked||!1;d.Re?d.Re(g,c.param,function(){e&&b&&b("vpl")}):g.h=c.param;f.Yb(g,null,function(){a.yb()},function(){mb(a)},!0)}},this);f.disabled=c.disabled||!1;f.locked=c.locked||!1;return f},a):a.j=[],a.H){var k=c.code;a.H(void 0==c.code?
null:k);null!=k&&(f="src")}d&&d.zi||!c.hasOwnProperty("filename")||(a.filename=c.filename)}}catch(l){}jb(a);a.ta="src"===f;b&&b(f);e=!0}function qb(a,c,b,d){try{var e=JSON.parse(c);nb(a,e,b,d);var f=a.xd;f.Hc=[];f.Id=[]}catch(g){}}Ya.prototype.Bc=function(a){"string"!==typeof this.code[a]&&(this.code[a]=Ea[a].bd(this));return this.code[a]};function rb(a,c){var b=Ea[a];a=sb(b,c,!0);c=sb(b,c,!1);return 0<=a&&0<=c?{je:a,end:c}:null}function tb(a,c){a.l=c}Ya.prototype.log=function(a){this.l&&this.l(a)};function ub(a,c,b){this.language=a;this.i=c;this.l=b;this.marks=[]}function vb(a,c,b){this.id=a;this.Rc=c;this.i=b;if(0>a||6399<a)throw"internal";this.v=String.fromCharCode(57344+a);this.b=-1}
function wb(a,c){a.forEach(function(a){a.b=c.indexOf(a.v)});a.sort(function(a,b){return a.b-b.b});for(var b=0;b<a.length;b++)a[b].b-=b,c=c.replace(a[b].v,"");a.forEach(function(a){var b;if(a.i){for(;;){for(b=a.b;" "===c[b]||"\t"===c[b];b++);if("\n"===c[b])a.b=b+1;else break}if(" "===c[a.b-1]||"\t"===c[a.b-1]){for(b=a.b-1;" "===c[b]||"\t"===c[b];b--);"\n"===c[b]&&(a.b=b+1)}}else if(" "===c[a.b-1]||"\t"===c[a.b-1]){for(b=a.b-1;" "===c[b]||"\t"===c[b];b--);"\n"===c[b]&&(a.b=b+1)}});return c}
function xb(a){return a.replace(/[\ue000-\uf8ff]/g,"")}function yb(a,c,b){var d=a.marks.length,e=new vb(d,b,!0);a.marks.push(e);b=new vb(d+1,b,!1);a.marks.push(b);return e.v+c+b.v}function sb(a,c,b){for(var d=0;d<a.marks.length;d++)if(a.marks[d].Rc===c&&a.marks[d].i===b)return a.marks[d].b;return-1}
function zb(a,c,b){if(c.disabled||c.Tb())return{};c.error=null;for(var d=!1,e=!1,f=0;f<c.X.length;f++)if(!c.X[f].disabled){if("e"===c.X[f].T.type){if(d=!0,c.X[f].T.Vc){var g=c.X[f].T.Vc(c.X[f]);if(g&&(Ab(g,[f]),!g.Wb||!c.error)&&(c.error=g,!g.Wb))return{error:g}}}else"s"===c.X[f].T.type&&(e=!0);if(("e"===c.X[f].T.type||"s"===c.X[f].T.type)&&null===c.error)for(var k=f+1;k<c.X.length;k++)c.X[k].disabled||c.X[k].T!==c.X[f].T||(g=new Na("Same block used multiple times",!0),Ab(g,[f,k]),c.error=g)}g=!1;
for(f=0;f<c.actions.length;f++)if(!c.actions[f].disabled&&"a"===c.actions[f].T.type){g=!0;break}if(!d&&!g)return c.error?{error:c.error}:{};if(!d&&!e)return g=new Na("Missing event block"),Ab(g,[]),c.error=g,{error:g};if(!g)return g=new Na("Missing action block"),g.b.push(0),c.error=g,{error:g};if(!c.error)for(f=0;f<c.actions.length;f++)if(!c.actions[f].disabled)for(k=f+1;k<c.actions.length;k++)c.actions[k].disabled||"a"!==c.actions[k].T.type||c.actions[k].T!==c.actions[f].T||(g=new Na("Same block used multiple times",
!0),g.b.push(f),g.b.push(k),c.error=g);var l=[],h=[],q=[],p="",t=[],u="",w=[],m=!1,n="";c.X.forEach(function(a,c){var d=a.l(this.language,b);if(0===c&&d.da)d.cb&&(p=yb(this,d.cb,a),d.na&&(u+=d.na)),d.Lf&&(m=!0);else if(d.fh||d.cb)t.push(yb(this,d.fh||d.cb,a)),d.na&&(w=w.concat(d.na));d.ub&&(l=l.concat(d.ub));d.Cb&&(h=h.concat(d.Cb));d.tb&&(q=q.concat(d.tb));d.ya&&(n+=yb(this,d.ya,a))},a);for(f=b.$e?-1:0;f<c.actions.length;f++)d=0>f?Bb(c,b):c.actions[f],e=d.l(a.language,b),n+=e.ya?yb(a,e.ya,d):"",
e.ub&&e.ub.forEach(function(a){0>l.indexOf(a)&&l.push(a)}),e.Cb&&e.Cb.forEach(function(a){0>h.indexOf(a)&&h.push(a)}),e.tb&&e.tb.forEach(function(a){0>q.indexOf(a)&&q.push(a)});return 0<n.length?(f="e"===c.X[0].T.type?c.X[0].l(a.language,b):null,d=c.X.slice(1).filter(function(a){return"e"===a.T.type}).map(function(a){return a.l(this.language,b)},a),{Di:c.X[0]?c.X[0].T.name:"",ub:l,Cb:h,tb:q,da:f?f.da:"",zb:f?f.zb:"",eb:f?f.eb:"",Vd:d.map(function(a){return a.da||""}),Df:d.map(function(a){return a.zb||
""}),Ef:d.map(function(a){return a.eb||""}),na:u,Ud:w,cb:p,Lf:m,cc:t.join(" "+a.i+" "),ya:(f&&f.ya||"")+n}):{}}function Cb(a){var c=Ia("!init");return c&&c.Mb[a.language]?c.Mb[a.language](null):{}}function Db(a,c){if(null!==c.volume){var b=Ia("!volume");if(null!==b){var d=new B(b,null,null);d.h=[c.volume];if(a=b&&b.Mb[a.language])return"\n"+a(d).ya}}return""}function Bb(a,c){var b=new B(Ia("!trace"),null,null);b.h=[c.j.indexOf(a)];return b}ub.prototype.bd=function(){throw"internal";};
ub.prototype.b=function(){throw"internal";};function Eb(){ub.call(this,"aseba","and","1 == 1")}Eb.prototype=Object.create(ub.prototype);Eb.prototype.constructor=Eb;
Eb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(b){return zb(this,b,a)},this),d={},e=[];b.forEach(function(a){a.da&&(d[a.da]={da:a.da,zb:a.zb,eb:a.eb,na:"",Va:""},0>e.indexOf(a.da)&&e.push(a.da));a.Vd&&a.Vd.forEach(function(b,c){d[b]={da:b,zb:a.Df[c],eb:a.Ef[c],na:"",Va:""};0>e.indexOf(b)&&e.push(b)})});var f=[],g=[],k=[],l=[],h=Cb(this);h&&(h.ub&&h.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)}),h.Cb&&h.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)}),h.tb&&h.tb.forEach(function(a){0>
k.indexOf(a)&&k.push(a)}));b.forEach(function(b,c){b.ub&&b.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)});b.Cb&&b.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)});b.tb&&b.tb.forEach(function(a){0>k.indexOf(a)&&k.push(a)});if(b.da&&(b.hb=l.indexOf(xb(b.cb||b.da)),0>b.hb)){b.hb=l.length;l.push(xb(b.cb||b.da));var e=d[b.da];b.na&&0>e.na.indexOf(b.na)&&(e.na+=b.na);e.Va+=b.cb?(b.Lf?"if "+b.cb+" then\n":"when "+b.cb+" do\n")+"eventCache["+b.hb+"] = 1\nend\n":"eventCache["+b.hb+"] = 1\n"}b.da||(b.ya=
yb(this,b.ya||"",a.j[c]))},this);var q="";if(c){var p=new Ja;h=new B(Ia("init"),null,null);p.Yb(h,null,null,null);c.forEach(function(a){p.Yb(a,null,null,null)});h=zb(this,p,a);var t=!0;h.ub.forEach(function(a){0>f.indexOf(a)&&(t=!1)});h.tb.forEach(function(a){0>k.indexOf(a)&&(t=!1)});t?q=h.ya:h.ki&&(q=h.ki)}var u=[],w="",m="",n=0;for(h=0;h<a.j.length;h++)0<=b[h].hb?(b[h].Ud&&b[h].Ud.forEach(function(a){0>u.indexOf(a)&&u.push(a)}),w+="if eventCache["+b[h].hb+"] != 0"+(b[h].cc?" and "+b[h].cc:"")+" then\ntodo["+
n+"] = 1\nend\n",m+="if todo["+n+"] != 0 then\n"+b[h].ya+"end\n",n++):b[h].cc&&(w+="when "+b[h].cc+" do\ntodo["+n+"] = 1\nend\n",m+="if todo["+n+"] != 0 then\n"+b[h].ya+"end\n",n++);b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="var eventCache[] = ["+l.map(function(){return"0"}).join(", ")+"]\n");if(0<n){b+="var todo[] = [";for(h=0;h<n;h++)b+=0<h?", 0":"0";b+="]\n"}c?b+="\n"+q:(0<g.length&&(b+="\n"+g.join("\n")),w&&(b+=(0<b.length?"\n":"")+"timer.period[1] = 50\n"));for(h=0;h<e.length;h++)!/onevent/.test(d[e[h]].da)&&
(d[e[h]].eb||d[e[h]].na||d[e[h]].Va)&&(b+="\n"+(d[e[h]].da||"")+(d[e[h]].eb||"")+(d[e[h]].na||"")+(d[e[h]].Va||"")+(d[e[h]].zb||""));b+=Db(this,a);0<k.length&&(b+="\n"+k.join("\n"));for(h=0;h<e.length;h++)/onevent/.test(d[e[h]].da)&&(d[e[h]].eb||d[e[h]].na||d[e[h]].Va)&&(b+="\n"+(d[e[h]].da||"")+(d[e[h]].eb||"")+(d[e[h]].na||"")+(d[e[h]].Va||"")+(d[e[h]].zb||""));if(w){b+="\nonevent timer1\n"+u.join("")+w+m;for(h=0;h<l.length;h++)b+="eventCache["+h+"] = 0\n";for(h=0;h<n;h++)b+="todo["+h+"] = 0\n"}"\n"===
b[0]&&(b=b.slice(1));var E=0;c=b.split("\n").map(function(a){return a.trim()}).map(function(a){function b(b){for(var c=xb(a),d=0;d<b.length;d++)if(c.slice(0,b[d].length)===b[d]&&!/^\w/.test(c.slice(b[d].length)))return!0;return!1}if(0<a.length){var c=b("if else elseif for onevent sub when while".split(" "));b(["else","elseif","end","onevent","sub"])&&(E=Math.max(E-1,0));a="\t\t\t\t\t".slice(0,E)+a;c&&E++}return a});for(h=c.length-2;0<=h;h--)/^\s*#/.test(c[h])&&(b=c[h+1].replace(/^(\s*).*$/,"$1"),
c[h]=b+c[h].replace(/^\s*/,""));b=c.join("\n");for(h=0;h<a.j.length;h++)for(c=h+1;c<a.j.length;c++)a.j[h].qf(a.j[c]);return b=wb(this.marks,b)};Eb.prototype.b=function(a){var c="# missing Aseba implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{na:c,cb:"1 == 1"};case "a":return{ya:c};default:return{}}};Ea.aseba=new Eb;function Fb(){ub.call(this,"l2","&&","true")}Fb.prototype=Object.create(ub.prototype);Fb.prototype.constructor=Fb;
Fb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(b){return zb(this,b,a)},this),d={},e=[];b.forEach(function(a){a.da&&(d[a.da]={da:a.da,zb:a.zb,eb:a.eb,na:"",Va:""},0>e.indexOf(a.da)&&e.push(a.da));a.Vd&&a.Vd.forEach(function(b,c){d[b]={da:b,zb:a.Df[c],eb:a.Ef[c],na:"",Va:""};0>e.indexOf(b)&&e.push(b)})});var f=[],g=[],k=[],l=[],h=Cb(this);h&&(h.ub&&h.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)}),h.Cb&&h.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)}),h.tb&&h.tb.forEach(function(a){0>
k.indexOf(a)&&k.push(a)}));b.forEach(function(b,c){b.ub&&b.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)});b.Cb&&b.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)});b.tb&&b.tb.forEach(function(a){0>k.indexOf(a)&&k.push(a)});if(b.da&&(b.hb=l.indexOf(xb(b.cb||b.da)),0>b.hb)){b.hb=l.length;l.push(xb(b.cb||b.da));var e=d[b.da];b.na&&0>e.na.indexOf(b.na)&&(e.na+=b.na);e.Va+=b.cb?(b.Lf?"if":"when")+" ("+b.cb+") {\neventCache["+b.hb+"] = true;\n}\n":"eventCache["+b.hb+"] = true;\n"}b.da||(b.ya=yb(this,
b.ya||"",a.j[c]))},this);var q="";if(c){var p=new Ja;h=new B(Ia("init"),null,null);p.Yb(h,null,null,null);c.forEach(function(a){p.Yb(a,null,null,null)});q=zb(this,p,a).ya}var t=[],u="",w="",m=0;for(h=0;h<a.j.length;h++)0<=b[h].hb?(b[h].Ud&&b[h].Ud.forEach(function(a){0>t.indexOf(a)&&t.push(a)}),u+="if (eventCache["+b[h].hb+"]"+(b[h].cc?" && "+b[h].cc:"")+") {\ntodo["+m+"] = true;\n}\n",w+="if (todo["+m+"]) {\n"+b[h].ya+"}\n",m++):b[h].cc&&(u+="when ("+b[h].cc+") {\ntodo["+m+"] = true;\n}\n",w+="if (todo["+
m+"]) {\n"+b[h].ya+"}\n",m++);b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="bool eventCache["+l.length+"] = false;\n");c?b+="\n"+q:(h="",0<g.length&&(h+="\n"+g.join("\n")),h&&(b+=(0<b.length?"\n":"")+h.slice(1)),u&&(b+=(0<b.length?"\n":"")+"timer.period[1] = 50;\n"));for(h=0;h<e.length;h++)!/onevent/.test(d[e[h]].da)&&(d[e[h]].eb||d[e[h]].na||d[e[h]].Va)&&(b+="\n"+(d[e[h]].da||"")+(d[e[h]].eb||"")+(d[e[h]].na||"")+(d[e[h]].Va||"")+(d[e[h]].zb||""));b+=Db(this,a);0<k.length&&(b+="\n"+k.join("\n"));
for(h=0;h<e.length;h++)/onevent/.test(d[e[h]].da)&&(d[e[h]].eb||d[e[h]].na||d[e[h]].Va)&&(b+="\n"+(d[e[h]].da||"")+(d[e[h]].eb||"")+(d[e[h]].na||"")+(d[e[h]].Va||"")+(d[e[h]].zb||""));u&&(b+="\nonevent timer1 {\n",0<m&&(b+="bool todo["+m+"] = false;\n"),b+=t.join("")+u+w+"eventCache = false;\n}\n");"\n"===b[0]&&(b=b.slice(1));var n=0;c=b.split("\n").map(function(a){return a.trim()}).map(function(a){var b=xb(a);if(0<b.length){var c="{"===b.slice(-1);"}"===b[0]&&(n=Math.max(n-1,0));a="\t\t\t\t\t".slice(0,
n)+a;c&&n++}return a});for(h=c.length-2;0<=h;h--)/^\s*#/.test(c[h])&&(b=c[h+1].replace(/^(\s*).*$/,"$1"),c[h]=b+c[h].replace(/^\s*/,""));b=c.join("\n");for(h=0;h<a.j.length;h++)for(c=h+1;c<a.j.length;c++)a.j[h].qf(a.j[c]);return b=wb(this.marks,b)};Fb.prototype.b=function(a){var c="// missing L2 implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{na:c,cb:"true"};case "a":return{ya:c};default:return{}}};Ea.l2=new Fb;function Gb(){ub.call(this,"js","&&","true")}Gb.prototype=Object.create(ub.prototype);Gb.prototype.constructor=Gb;
Gb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(b){return zb(this,b,a)},this),d={},e=[];b.forEach(function(a){a.da&&(d[a.da]={da:a.da,zb:a.zb,eb:a.eb,na:"",Va:""},0>e.indexOf(a.da)&&e.push(a.da));a.Vd&&a.Vd.forEach(function(b,c){d[b]={da:b,zb:a.Df[c],eb:a.Ef[c],na:"",Va:""};0>e.indexOf(b)&&e.push(b)})});var f=[],g=[],k=[],l=[],h=Cb(this);h&&(h.ub&&h.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)}),h.Cb&&h.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)}),h.tb&&h.tb.forEach(function(a){0>
k.indexOf(a)&&k.push(a)}));var q=[],p=0;b.forEach(function(b,c){b.ub&&b.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)});b.Cb&&b.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)});b.tb&&b.tb.forEach(function(a){0>k.indexOf(a)&&k.push(a)});var e=b.ya||"";b.cb&&(e="cond = "+b.cb+";\nif (cond && !cond0["+p+"]) {\n"+e+"}\ncond0["+p+"] = cond;\n",p++);if(b.da&&(b.hb=l.indexOf(xb(b.cb||b.da)),0>b.hb)){b.hb=l.length;l.push(xb(b.cb||b.da));var h=d[b.da];b.na&&0>h.na.indexOf(b.na)&&(h.na+=b.na);b.cb?(h.Va+=
"cond = "+b.cb+";\nif (cond && !cond0["+p+"]) {\neventCache["+b.hb+"] = true;\n}\ncond0["+p+"] = cond;\n",p++):h.Va+="eventCache["+b.hb+"] = true;\n"}b.da||(b.ya=yb(this,e,a.j[c]));Ka(a.j[c])&&q.push(c)},this);var t="";if(c){var u=new Ja;h=new B(Ia("init"),null,null);u.Yb(h,null,null,null);c.forEach(function(a){u.Yb(a,null,null,null)});t=zb(this,u,a).ya}var w=[],m="",n="",E=0;for(h=0;h<a.j.length;h++)0<=b[h].hb?(b[h].Ud&&b[h].Ud.forEach(function(a){0>w.indexOf(a)&&w.push(a)}),m+="if (eventCache["+
b[h].hb+"]"+(b[h].cc?" && "+b[h].cc:"")+") {\ntodo["+E+"] = true;\n}\n",n+="if (todo["+E+"]) {\n"+b[h].ya+"}\n",E++):b[h].cc&&(m+="cond = "+b[h].cc+";\nif (cond && !cond0["+p+"]) {\ntodo["+E+"] = true;\n}\ncond0["+p+"] = cond;\n",p++,n+="if (todo["+E+"]) {\n"+b[h].ya+"}\n",E++);0<p&&(f.unshift("var cond0;\nvar cond;\n"),g.unshift("cond0 = [];\n"));b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="var eventCache = [];\n");0<E&&(b+="var todo = [];\n");c?b+="\n"+t:(h="",0<g.length&&(h+="\n"+g.join("\n")),
m&&(h+="this.setTimer(1, 0.1, true);\n"),h&&(b+=(0<b.length?"\n":"")+'this.addEventListener("init", function (name, param) {\n'+h.slice(1)+"});\n"));if(0<k.length)throw"internal error, unsupported sub/onevent in js";for(h=0;h<e.length;h++)if(d[e[h]].eb||d[e[h]].na||d[e[h]].Va)b+="\n"+(d[e[h]].da||"")+(d[e[h]].eb||"")+(d[e[h]].na||"")+(d[e[h]].Va||"")+(d[e[h]].zb||"");if(m){b+='\nthis.addEventListener("timer1", function (name, param) {\n'+w.join("")+m+n;for(h=0;h<l.length;h++)b+="eventCache["+h+"] = false;\n";
for(h=0;h<E;h++)b+="todo["+h+"] = false;\n"}0<b.trim().length&&(b+="});");"\n"===b[0]&&(b=b.slice(1));var r=0;c=b.split("\n").map(function(a){return a.trim()}).map(function(a){var b=xb(a);if(0<b.length){var c="{"===b.slice(-1);"}"===b[0]&&(r=Math.max(r-1,0));a="\t\t\t\t\t".slice(0,r)+a;c&&r++}return a});for(h=c.length-2;0<=h;h--)/^\s*#/.test(c[h])&&(b=c[h+1].replace(/^(\s*).*$/,"$1"),c[h]=b+c[h].replace(/^\s*/,""));b=c.join("\n");for(h=0;h<a.j.length;h++)for(c=h+1;c<a.j.length;c++)a.j[h].qf(a.j[c]);
return b=wb(this.marks,b)};Gb.prototype.b=function(a){var c="// missing JavaScript implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{na:c,cb:"true"};case "a":return{ya:c};default:return{}}};Ea.js=new Gb;function Hb(){ub.call(this,"python","and","True")}Hb.prototype=Object.create(ub.prototype);Hb.prototype.constructor=Hb;
Hb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(b){return zb(this,b,a)},this),d={},e=[];b.forEach(function(a){a.da&&(d[a.da]={da:a.da,zb:a.zb,eb:a.eb,na:"",Va:""},0>e.indexOf(a.da)&&e.push(a.da));a.Vd&&a.Vd.forEach(function(b,c){d[b]={da:b,zb:a.Df[c],eb:a.Ef[c],na:"",Va:""};0>e.indexOf(b)&&e.push(b)})});var f=[],g=[],k=[],l=[],h=0,q=Cb(this);q&&(q.ub&&q.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)}),q.Cb&&q.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)}),q.tb&&q.tb.forEach(function(a){0>
k.indexOf(a)&&k.push(a)}));b.forEach(function(b,c){b.ub&&b.ub.forEach(function(a){0>f.indexOf(a)&&f.push(a)});b.Cb&&b.Cb.forEach(function(a){0>g.indexOf(a)&&g.push(a)});b.tb&&b.tb.forEach(function(a){0>k.indexOf(a)&&k.push(a)});if(b.da&&(b.hb=l.indexOf(xb(b.cb||b.da)),0>b.hb)){b.hb=l.length;l.push(xb(b.cb||b.da));var e=d[b.da];b.na&&0>e.na.indexOf(b.na)&&(e.na+=b.na);b.cb?(e.Va+="cond = "+b.cb+"\nif cond and not cond0["+h+"]:\neventCache["+b.hb+"] = True\n<\ncond0["+h+"] = cond\n",h++):e.Va+="eventCache["+
b.hb+"] = True\n"}b.da||(b.ya=yb(this,b.ya||"",a.j[c]))},this);if(c){var p=new Ja,t=new B(Ia("init"),null,null);p.Yb(t,null,null,null);c.forEach(function(a){p.Yb(a,null,null,null)});t=zb(this,p,a);t.ub.forEach(function(){});t.tb.forEach(function(){})}0<h&&g.unshift("cond0 = "+h+" * [False]\n");var u=[],w="",m="",n=0;for(q=0;q<a.j.length;q++)0<=b[q].hb?(b[q].Ud&&b[q].Ud.forEach(function(a){0>u.indexOf(a)&&u.push(a)}),w+="if eventCache["+b[q].hb+"]"+(b[q].cc?" and "+b[q].cc:"")+":\ntodo["+n+"] = True\n<\n",
m+="if todo["+n+"]:\n"+b[q].ya+"<\n",n++):b[q].cc&&(w+="cond = "+b[q].cc+"\nif cond and not cond0["+q+"]:\ntodo["+n+"] = 1\n<\ncond0["+q+"] = cond\n",m+="if todo["+n+"]:\n"+b[q].ya+"<\n",n++);b=0<f.length?f.join("\n"):"";0<l.length&&(b+="eventCache = "+l.length+" * [False]\n");0<n&&(b+="todo = "+n+" * [False]\n");c?b+="\n"+t:(0<g.length&&(b+="\n"+g.join("\n")),w&&(b+=(0<b.length?"\n":"")+"timer_period[1] = 50\n"));for(q=0;q<e.length;q++)!/onevent/.test(d[e[q]].da)&&(d[e[q]].eb||d[e[q]].na||d[e[q]].Va)&&
(b+="\n"+(d[e[q]].da||"")+(d[e[q]].eb||"")+(d[e[q]].na||"")+(d[e[q]].Va||"")+(d[e[q]].zb||""));b+=Db(this,a);0<k.length&&(b+="\n"+k.join("\n"));for(q=0;q<e.length;q++)/onevent/.test(d[e[q]].da)&&(d[e[q]].eb||d[e[q]].na||d[e[q]].Va)&&(b+="\n"+(d[e[q]].da||"")+(d[e[q]].eb||"")+(d[e[q]].na||"")+(d[e[q]].Va||"")+(d[e[q]].zb||""));if(w){b+="\n@onevent\ndef timer1():\n"+u.join("")+w+m;for(q=0;q<l.length;q++)b+="eventCache["+q+"] = False\n";for(q=0;q<n;q++)b+="todo["+q+"] = False\n";b+="<\n"}"\n"===b[0]&&
(b=b.slice(1));b=xb(b);b=b.replace(/\n[ \t]+/g,"\n").replace(/\n<\n\n<\n/g,"\n<\n<\n");var E=0,r="";b.split("\n").map(function(a){return a.trim()}).forEach(function(a){var b=xb(a);if(0<b.length){var c=":"===b.slice(-1);"<"===b&&(E=Math.max(E-1,0));"<"!==b&&(a="\t\t\t\t\t".slice(0,E)+a,c&&E++)}"<"!==b&&(r+=a+"\n")});b=r;for(q=0;q<a.j.length;q++)for(c=q+1;c<a.j.length;c++)a.j[q].qf(a.j[c]);return b=wb(this.marks,b)};
Hb.prototype.b=function(a){var c="# missing Python implementation for block "+a.T.name+"\npass\n";switch(a.T.type){case "e":case "s":return{na:c,cb:"True"};case "a":return{ya:c};default:return{}}};Ea.python=new Hb;function Ib(){Eb.call(this)}Ib.prototype=Object.create(ub.prototype);Ib.prototype.constructor=Ib;Ib.prototype.bd=function(a,c){a=Eb.prototype.bd.call(this,a,c);c=new Jb(Kb);a=new Lb(c,a);a.S=Mb;a=Nb(a);return Ob(a,!0)};Ea.asm=new Ib;function Pb(a){this.I=[];this.b=a||null}x=Pb.prototype;x.add=function(a,c){this.I.push(new Qb(a,c))};x.find=function(a){for(var c=0;c<this.I.length;c++)if(this.I[c].name===a)return this.I[c];return null};function Rb(a,c){a=a.find(c);return null!=a&&null!=a.b}function Sb(a,c){if(a.b){var b=a.find(c);c={cmd:c};b.w&&(c.selected=b.Pa());b.u&&(c.state=b.getState());a.b({type:"cmd",data:c})}}x.Dd=function(a,c){var b=this.find(a);b&&(b.Dd(c),Sb(this,a))};
x.pb=function(a,c){this.b&&this.b({type:"drop",data:{cmd:a}});(a=this.find(a))&&a.pb(c)};x.gb=function(a,c){a=this.find(a);return null!=a&&a.gb(c)};x.$=function(a){if(window.vplConfig&&window.vplConfig.ignoredCommands&&0<=window.vplConfig.ignoredCommands.indexOf(a))return!1;a=this.find(a);return null!=a&&a.$()};x.isEnabled=function(a){a=this.find(a);return null!=a&&a.isEnabled()};x.Pa=function(a){a=this.find(a);return null!=a&&a.Pa()};
x.getState=function(a){a=this.find(a);return null!=a?a.getState():null};function Qb(a,c){this.name=a;this.H=c.isEnabled||null;this.w=c.Pa||null;this.u=c.getState||null;this.b=c.action||null;this.i=c.pb||null;this.l=c.gb||null;this.ed=c.object||null;this.pd=c.pd||!1;this.S=c.$||null;this.lb=c.lb||null;this.xc=c.xc||null}x=Qb.prototype;x.Dd=function(a){this.isEnabled()&&this.b&&this.b(this.ed,a)};
function Tb(a,c){if(!a.u)return!1;var b=a.getState();if(c===b)return!0;for(var d=0;100>d;d++){a.Dd(void 0);var e=a.getState();if(e===c)return!0;if(e===b)break}return!1}x.pb=function(a){this.gb(a)&&this.i&&this.i(this.ed,a)};x.gb=function(a){return null!=this.l&&this.l(this.ed,a)};x.isEnabled=function(){return null==this.H||this.H(this.ed)};x.Pa=function(){return null!=this.w&&this.w(this.ed)};x.getState=function(){return null!=this.u?this.u(this.ed):null};x.$=function(){return null==this.S||this.S(this.ed)};function Ub(a){Vb||(fb(),Vb=!0);this.Jb=a;this.ia=new Wb;this.i=new Ta;this.W=new Ra;var c=this;this.I=new Pb(function(a){c.log(a)});this.kc=null;this.Jc="vpl:close !space vpl:about vpl:help vpl:statement !space vpl:new vpl:save vpl:load vpl:upload vpl:nextProgram vpl:filename vpl:exportToHTML !space vpl:advanced !stretch vpl:readonly !stretch vpl:add-comment !stretch vpl:undo vpl:redo !stretch vpl:connected !stretch vpl:run vpl:stop !space vpl:slowdown vpl:debug vpl:robot !space vpl:flash !stretch vpl:sim vpl:text !stretch vpl:teacher-reset vpl:teacher-save vpl:teacher-setasnew vpl:teacher".split(" ");
this.yc="!!stretch vpl:message-error vpl:message-warning !!stretch vpl:duplicate vpl:disable vpl:lock vpl:trashcan".split(" ");this.rb="src:close !space src:new src:save !space src:language src:disass !stretch src:run src:stop !stretch src:sim src:vpl !space src:locked !stretch src:teacher-reset src:teacher".split(" ");this.Za="sim:close !stretch sim:restart sim:pause !space sim:speedup sim:noise !stretch sim:pen sim:clear !space sim:map-kind sim:map sim:map-ground sim:map-obstacles sim:map-height !stretch sim:vpl sim:text !stretch sim:teacher-reset sim:teacher".split(" ");
this.Ka=["vpl"];this.Ad={vpl:1,src:1,sim:1};this.wd=["ground","height","obstacles"];this.De=this.hg=this.Yf=this.Te=this.He=this.ve=null;this.Uc=!1;this.ma={};this.username=null;this.j=new Ya(this.W);tb(this.j,function(a){c.log(a)});this.zd=!1;this.Eg=!0;this.Pb="";this.yd=!1;this.Ha=null;this.aa=new Xb(a,{ia:this.ia,dg:function(a){(c.Ha=a)&&H(c)}});this.aa.state={ni:new Yb};this.S="";this.M=this.b=null;this.Ga=[];this.la=-1;this.Sg=this.we=!1;this.u=null;this.aa.Za=function(){null!==c.u&&(c.u=null,
H(c))};this.aa.Ha=function(){H(c)};this.H=null;this.Wc=[];this.Bf=this.tc=null;this.l=new Zb;$b(this.l);this.Da=null;this.R=new ac(this);bc(this.aa,function(a,d){c.W.i||(a=c.R,a.i===cc&&a.Ra===cc)||(a.i=cc,a.Ra=cc,H(a.l));if(null!==c.Da){a=c.Da;var b=d.x;d=d.y;if(a.u&&b>=a.u.left&&b<a.u.right&&d>=a.u.top&&d<a.u.bottom){d=b-a.u.left;for(b=0;b<a.l.length&&d>a.l[b];b++);a=0===b?0===a.l.length||d<a.l[0]/2?0:1:b>=a.l.length?a.l.length:d<(a.l[b-1]+a.l[b])/2?b:b+1}else a=null;null==a?(c.Da.finish(!0),c.Da=
null):c.Da.b=c.Da.i=a}return!0})}var Vb=!1;function dc(a){ec(a.l,function(c){if(!a.W.l||0<=a.Ka.indexOf("src")||c.altKey||c.ctrlKey||c.metaKey)return!1;if(0<=a.Ka.indexOf("vpl")){a:{var b=a.I;for(var d=c.key,e=a.Jc.concat(a.yc),f=0;f<b.I.length;f++)if((!e||0<=e.indexOf(b.I[f].name))&&b.I[f].xc&&b.I[f].xc===d&&b.I[f].$()){b=b.I[f];break a}b=null}if(b)return b.Dd(c.altKey),!0}return!1});a.W.u&&fc(a.R)}
function gc(a,c){if(null!==a.Da){if(void 0!=c.Rc&&c.Rc===a.Da.Rc)return;a.Da.finish(!0)}a.Da=window.vplTextFieldInputEvents?new hc(a,c):new ic(a,c)}Ub.prototype.translate=function(a,c){return this.i.translate(a,c)};function jc(a,c){ib(a.j,c);c=a.R;c.i=cc;c.Ra=cc;a.W.i&&(a.R.Ra=I,a.R.Ab=0)}function kc(a,c){a.He=c?new lc(c,a.W.l?{sd:function(){mc(a.l,function(){a.He.vc()})},rd:function(){nc(a.l)}}:null):null}
function oc(a,c,b){var d=new pc;d.width=d.height=64;var e=qc(16,16),f=rc(function(b){(a.j.he||sc)(a,"vpl:save",b,e,a.ia,["vpl","top","detached"],d,a.i,!0,!1,!1,null)},d.width,d.height,d,e,1);f='<img src="'+f.url+'" width='+f.width+" height="+f.height+">";f=c?new lc(c,{th:[{title:"\u21d3",di:f,Fa:function(){tc(c,"doc.html","text/html")}}],scroll:!0,sd:a.W.l?function(){mc(a.l,function(){a.Yf.vc()})}:null,rd:a.W.l?function(){nc(a.l)}:null}):null;b?a.hg=f:a.Yf=f}
function uc(a){if(a.w){var c=a.Jc.concat(a.yc).filter(function(a){return"!"!==a[0]&&this.I.$(a)},a),b="b"===a.j.mode?a.j.ec:a.j.jc;b.sort(function(a,b){a=G.indexOf(Ia(a));b=G.indexOf(Ia(b));return a<b?-1:a>b?1:0});Wa(a.w);var d=qc(100,100),e=vc(a,a.ia),f=wc(a,a.Jc,["vpl","top"]),g=wc(a,a.yc,["vpl","bottom"]);a.kc={disabled:!1,$:!0,nh:!1,isEnabled:!0,Pa:!1,state:null};var k=xc(a,a.Jc,["vpl","top"],e.Gc,e.Og,f),l=xc(a,a.yc,["vpl","bottom"],e.Od,e.Ng,g),h=50/f["vpl:new"].width;a.Jc.forEach(function(a){var b=
yc(k,a,f[a],d,h);b&&(a="vpl:cmd:"+a.replace(/:/g,"-"),this.w.ff[a]=b.url)},a);a.yc.forEach(function(a){var b=yc(l,a,g[a],d,h);b&&(a="vpl:cmd:"+a.replace(/:/g,"-"),this.w.ff[a]=b.url)},a);a.kc=null;G.forEach(function(a){try{var b=new B(a,null,null);b.h=a.fb?a.fb():b.h;var c="vpl:block:"+a.name.replace(/ /g,"-"),e=b.toDataURL(this.ia,d,1);this.w.ff[c]=e}catch(w){}},a);c=a.w.bd(a.i.language,c,b,a.ma);oc(a,c)}}
Ub.prototype.qb=function(a,c){function b(){0<=a.indexOf("vpl")&&J(d.aa);0<=a.indexOf("src")&&J(d.O.Ua);0<=a.indexOf("sim")&&J(d.b)}var d=this;c&&(c.ta||c.Qg)&&(this.j.ta=!0,this.O.ta=!0,zc(this.O,!1));if(1===a.length&&c&&c.ue&&1<this.Ka.length){if(0<=this.Ka.indexOf(a[0]))return;var e=this.Ka.slice();e[this.Ka[0]===c.ue?1:0]=a[0];a=e}else c&&c.ye?0>this.Ka.indexOf(a[0])&&(a=this.Ka.concat(a)):1===a.length&&c&&c.Nf&&1<this.Ka.length&&0<=this.Ka.indexOf(a[0])?(this.Ka.splice(this.Ka.indexOf(a[0]),1),
a=this.Ka):1===a.length&&c&&c.toggle&&(0<=this.Ka.indexOf(a[0])?(this.Ka.splice(this.Ka.indexOf(a[0]),1),a=this.Ka):a=this.Ka.concat(a));this.Ka=a;null!=this.M&&this.b.vc();this.aa.vc();null!=this.O&&(document.getElementById("src-editor").style.display=0<=a.indexOf("src")?"block":"none",this.O.Ua.vc());0<=a.indexOf("vpl")&&this.aa.show();0<=a.indexOf("src")&&this.O.Ua.show();null!=this.M&&0<=a.indexOf("sim")&&this.b.show();Ac(this,window.innerWidth<window.innerHeight);for(e=0;e<a.length;e++)switch(a[e]){case "vpl":this.aa.qa=
function(){if(!d.j.ta){d.j.code={};jb(d.j);if(d.O){var a=d.O,b=d.j.Bc(d.j.Bb);if(a.Md){var c=a.Oe(a.language,b);null!==c&&(Bc(a,c,!0),a.Fc.Ob.readOnly=!0,a.Md=b)}else Bc(a,b)}d.log()}H(d)};break;case "src":zc(this.O,!(c&&(c.ta||c.Qg)));this.O.focus();this.O.resize(window.innerWidth,window.innerHeight);break;case "sim":this.b.qa=function(){Cc(d)}}c&&(c.Nf||c.ye)&&Dc(d);this.aa&&(this.aa.Db=b);this.O&&this.O.Ua&&(this.O.Ua.Db=b);this.b&&(this.b.Db=b);0<=a.indexOf("vpl")&&(this.aa.qa(),this.aa.Db?this.aa.Db():
J(this.aa));0<=a.indexOf("src")&&(Ec(this),this.O.Ua.Db?this.O.Ua.Db():J(this.O.Ua));0<=a.indexOf("sim")&&(this.start(!1),this.b.qa(),this.b.Db?this.b.Db():J(this.b))};Ub.prototype.setView=Ub.prototype.qb;
function Ac(a,c){for(var b=a.Ka.map(function(a){return this.Ad[a]},a),d=b.reduce(function(a,b){return a+b},0),e=0,f=0;f<a.Ka.length;f++){var g=c?{Y:0,oa:1,ba:e,pa:e+b[f]/d}:{Y:e,oa:e+b[f]/d,ba:0,pa:1};e+=b[f]/d;switch(a.Ka[f]){case "vpl":Fc(a.aa,g);break;case "src":Fc(a.O.Ua,g);break;case "sim":Fc(a.b,g)}}}
function Dc(a){var c=a.aa.b.parentElement.getBoundingClientRect(),b=c.width;c=window.innerHeight-c.top;Ac(a,b<c);window.vplDisableResize&&(c=a.aa.b.getBoundingClientRect(),b=c.width,c=c.height);a.aa.resize(b,c);a.O&&a.O.resize(b,c);a.M&&a.b.resize(b,c);a.Ka.forEach(function(a){switch(a){case "vpl":H(this);break;case "src":J(this.O.Ua);break;case "sim":this.M&&Cc(this)}},a);a.He&&Gc(a.He)}
function Hc(a,c){if(0<=a.la){var b=null;c&&(b=Ia("!stop and blink"));b||(b=Ia("!stop"));c=a.j.Bb;(b=b&&b.Mb[c])&&a.Ga[a.la].Ma.nc(b(null).ya,c)}}function Ic(a){return!a.j.ta&&a.Ga[a.la].Ma.isEnabled(a.j.Bb)}function Jc(a,c){a.Wc.push(c)}
Ub.prototype.log=function(a){if(null==a){Kc(this);a={type:"vpl-changed",data:{filename:this.j.filename,nrules:this.j.j.reduce(function(a,c){return 0<c.X.length+c.actions.length?a+1:a},0),nblocks:this.j.j.reduce(function(a,c){return a+c.X.length+c.actions.length},0),uploadedToServer:this.j.qc,error:this.Pb&&!this.yd?this.Pb:null,warning:this.Pb&&this.yd?this.Pb:null,"error-tr":this.Pb&&!this.yd?this.i.translate(this.Pb):null,"warning-tr":this.Pb&&this.yd?this.i.translate(this.Pb):null,robot:0<=this.la?
this.Ga[this.la].Ma.isConnected()&&this.Ga[this.la].Ma.getName():null}};var c=JSON.stringify(a);if(c===this.tc)return;this.tc=c}this.Wc.forEach(function(b){try{b(a)}catch(d){}})};function Lc(a){function c(c){function d(b){for(var c=0;c<E.length;c++)if(E[c].uri){var d=Mc(E[c].uri);if(a.Ib[d.ad].yg(b,d.id))return!0}return!1}var e=c.name;if("!"===e[0])return 0;var k=0;/^\w/.test(e)||(b+='Bad block name "'+e+'"\n',k++);var l=c.defaultParameters,h=c.typicalParameters,q=c.buttons,p=c.radiobuttons,t=c.sliders,u=c.rotating,w=c.diffwheelmotion,m=c.score,n=c.otherParameters?parseInt(c.otherParameters,10):0,E=c.draw;if(E){c=null;for(var r=0;r<E.length;r++)if(E[r].uri)if(null==c){c=Mc(E[r].uri).ad;
var v=a.Ib[c]}else{var C=Mc(E[r].uri);C.ad!==c?(b+='In block "'+e+'", multiple svg\n',k++):v.Oc(C.id)||(b+='In block "'+e+'", uri "'+E[r].uri+'" not found\n',k++)}}q&&q.forEach(function(a){v.Oc(a.id)?d(a.id)||(b+='In block "'+e+'", button id "'+a.id+'" not displayed\n',k++):(b+='In block "'+e+'", button id "'+a.id+'" not found\n',k++);void 0==a.val?(b+='In block "'+e+'", missing property "val"\n',k++):void 0==a.st?(b+='In block "'+e+'", missing property "st"\n',k++):a.val.length!==a.st.length&&(b+=
'In block "'+e+'", properties "val" and "st" have different lengths\n',k++)});p&&p.forEach(function(a){v.Oc(a.id)?d(a.id)?void 0==a.val?(b+='In block "'+e+'", missing property "val"\n',k++):a.val instanceof Array?(b+='In block "'+e+'", illegal array in property "val"\n',k++):void 0==a.st?(b+='In block "'+e+'", missing property "st"\n',k++):2!==a.st.length&&(b+='In block "'+e+'", property "st" must have length 2\n',k++):(b+='In block "'+e+'", radiobutton id "'+a.id+'" not displayed\n',k++):(b+='In block "'+
e+'", radiobutton id "'+a.id+'" not found\n',k++)});t&&t.forEach(function(a){v.Oc(a.id)?d(a.id)||(b+='In block "'+e+'", slider id "'+a.id+'" not displayed\n',k++):(b+='In block "'+e+'", slider id "'+a.id+'" not found\n',k++);v.Oc(a.thumbId)?d(a.thumbId)||(b+='In block "'+e+'", slider thumbId "'+a.thumbId+'" not displayed\n',k++):(b+='In block "'+e+'", slider thumbId "'+a.thumbId+'" not found\n',k++);void 0==a.min&&(b+='In block "'+e+'", slider min undefined\n',k++);void 0==a.max&&(b+='In block "'+
e+'", slider max undefined\n',k++);a.lowerPartId&&!v.Oc(a.lowerPartId)&&(b+='In block "'+e+'", slider lowerPartId "'+a.lowerPartId+'" not found\n',k++);if(a.snap&&(a=a.snap,a instanceof Array))for(var c=0;c<a.length;c++)"string"===typeof a[c]?/^`.+`$/.test(a[c])||(b+='In block "'+e+'", invalid slider snap expression\n',k++):"number"!==typeof a[c]&&(b+='In block "'+e+'", slider snap must be a number or a string\n',k++)});u&&u.forEach(function(a){var c=a.id,f=a.centerId;a=a.thumbId;v.Oc(c)?d(c)||(b+=
'In block "'+e+'", rotating id "'+c+'" not displayed\n',k++):(b+='In block "'+e+'", rotating id "'+c+'" not found\n',k++);v.Oc(f)||(b+='In block "'+e+'", rotating centerId "'+f+'" not found\n',k++);v.Oc(a)?d(a)||(b+='In block "'+e+'", rotating thumbId "'+a+'" not displayed\n',k++):(b+='In block "'+e+'", rotating thumbId "'+a+'" not found\n',k++);v.yg(a,c)||(b+='In block "'+e+'", rotating thumbId "'+a+'" not a descendent of id "'+c+'"\n',k++)});w&&(v.Oc(w.id)?d(w.id)||(b+='In block "'+e+'", diffwheelmotion id "'+
w.id+'" not displayed\n',k++):(b+='In block "'+e+'", diffwheelmotion id "'+w.id+'" not found\n',k++));m&&(v.Oc(m.id)?d(m.id)||(b+='In block "'+e+'", score id "'+m.id+'" not displayed\n',k++):(b+='In block "'+e+'", score id "'+m.id+'" not found\n',k++),"number"!==typeof m.numHeights||m.numHeights!==Math.round(m.numHeights)||0>=m.numHeights)&&(b+='In block "'+e+'", score numHeights must be a strictly positive integer\n',k++);(q||p||t||u||m||0<n)&&!l&&(b+='In block "'+e+'", missing defaultParameters\n',
k++);l&&(w=0,q&&(w+=q.length),p&&(w+=1),t&&(w+=t.length),u&&(w+=u.length),m&&(w+=2*Math.floor((l.length-w)/2)),w+=n,w!==l.length?(b+='In block "'+e+'", defaultParameters.length='+l.length+", needs "+w+" parameters\n",k++):h&&h.length!=w&&(b+='In block "'+e+'", typicalParameters.length='+h.length+", needs "+w+" parameters\n",k++));return k}var b="",d=0;a.blocks&&a.blocks.forEach(function(a){d+=c(a)});0<d&&(b+=d+" error"+(1<d?"s":"")+"\n");return b||null};function Nc(a){function c(a){a=a.j.filename||"program.vpl3";return".vpl3"===a.slice(-5)?a.slice(0,-5):a}a.I.add("vpl:close",{action:function(a){a.qb(["vpl"],{Nf:!0})},object:a,$:function(a){return 1<a.Ka.length&&0<=a.Ka.indexOf("vpl")},xc:"w"});a.I.add("vpl:about",{action:function(a){a.He.show()},object:a,$:function(a){return null!=a.He},xc:"i"});a.I.add("vpl:help",{action:function(a){a.Yf.show()},object:a,$:function(a){return null!=a.Yf},xc:"?"});a.I.add("vpl:statement",{action:function(a){a.hg.show()},
object:a,$:function(a){return null!=a.hg}});a.I.add("vpl:readonly",{isEnabled:function(){return!1},object:a,$:function(a){return a.j.readOnly||a.j.ta}});a.I.add("vpl:suspend",{action:function(a){a.Uc=!a.Uc;a.Uc?(Ic(a)&&(Hc(a,!0),a.j.Vb=!1),a.De.show()):a.De.vc()},Pa:function(a){return a.Uc},object:a,$:function(a){return a.j.Zb===Za&&null!=a.De}});a.I.add("vpl:new",{action:function(a){jc(a);a.ve&&Oc(a,a.ve);mb(a.j);H(a)},isEnabled:function(a){return!a.j.ta&&!a.j.readOnly&&(null!=a.j.filename||!a.j.Tb())},
object:a,$:function(a){return!a.j.readOnly},xc:"n"});a.I.add("vpl:save",{action:function(a,d){d?(d=Pc(a,a.ia),tc(d,c(a)+".html","text/html")):(d=pb(a.j,{qd:!0,td:!0}),tc(d,a.j.filename||"program.vpl3","application/x-vpl3"))},isEnabled:function(a){return!a.j.ta&&!a.j.Tb()},object:a,$:function(a){return!a.j.readOnly},xc:"s"});a.I.add("vpl:load",{action:function(a){a.Te.show("Open program file",".aesl,.json,.vpl3,.vpl3ui,.zip",function(b){Qc(a,b);mb(a.j)})},isEnabled:function(a){return!a.j.ta&&!a.j.readOnly},
object:a,$:function(a){return!a.j.readOnly},xc:"o"});a.I.add("vpl:upload",{action:function(a){var b=pb(a.j,{qd:!1,td:!0});window.vplUpload(a.j.filename,b);a.j.qc=!0;a.Eg=!1},isEnabled:function(a){return!a.j.ta&&!a.j.readOnly&&!a.j.Tb()},Pa:function(a){return a.j.qc},getState:function(a){return a.j.Tb()?"empty":a.j.qc?"uploaded":a.Eg?"canUpload":"canUploadAgain"},object:a,$:function(a){return null!=window.vplUpload&&!a.j.readOnly}});a.I.add("vpl:nextProgram",{action:function(a){var b=pb(a.j,{qd:!1,
td:!0});b=window.vplNextProgram(a.j.filename,b);Oc(a,b);b=JSON.parse(b);a.j.filename=b.filename||"program.vpl3"},isEnabled:function(a){return null!=window.vplNextProgram(a.j.filename,null)},object:a,$:function(){return null!=window.vplNextProgram}});a.I.add("vpl:exportToHTML",{action:function(a,d){d?(d=Rc(a,a.ia),tc(d,"vpl-ui.html","text/html")):(d=Pc(a,a.ia),tc(d,c(a)+".html","text/html"))},isEnabled:function(a){return!a.j.ta&&!a.j.Tb()},object:a,xc:"h"});a.I.add("vpl:text",{action:function(a){a.we?
a.qb(["src"],{ye:!0}):a.qb(["src"],{ue:"vpl"})},isEnabled:function(a){return!a.j.ta},pb:function(a,c){if(c.data instanceof B&&c.data.Gb){if(c=rb(a.j.Bb,c.data))a.qb(["src"]),a.O.eg(c.je,c.end)}else c.data instanceof Ja&&(c=rb(a.j.Bb,c.data))&&(a.qb(["src"]),a.O.eg(c.je,c.end))},gb:function(a,c){return c.data instanceof B&&null!=c.data.Gb||c.data instanceof Ja},object:a,$:function(a){return a.O&&0>a.Ka.indexOf("src")}});a.I.add("vpl:text-toggle",{action:function(a){a.qb(["src"],{toggle:!0})},isEnabled:function(a){return!a.j.ta},
Pa:function(a){return 0<=a.Ka.indexOf("src")},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:advanced",{action:function(a){ob(a.j,"b"===a.j.mode?"a":"b");uc(a)},isEnabled:function(a){return!a.j.ta&&!a.j.readOnly},Pa:function(a){return"a"===a.j.mode},object:a,$:function(a){return eb&&!a.j.readOnly},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:undo",{action:function(a){a.j.ig(function(){H(a);mb(a.j)})},isEnabled:function(a){return!a.j.ta&&0<a.j.xd.Hc.length},object:a,$:function(a){return!a.j.readOnly},
xc:"z"});a.I.add("vpl:redo",{action:function(a){a.j.Fg(function(){H(a);mb(a.j)})},isEnabled:function(a){return!a.j.ta&&0<a.j.xd.Id.length},object:a,$:function(a){return!a.j.readOnly},xc:"y"});a.I.add("vpl:add-comment",{action:function(a){a.j.yb();var b=a.R.Ra===I?a.R.Ab:null,c=a.j,f=new Qa("");null!=b&&b<c.j.length?c.j.splice(b,0,f):0!==c.j.length&&c.j[c.j.length-1].Tb()?(b=c.j.length-1,c.j.splice(b,0,f)):(b=c.j.length,c.j.push(f));jb(c);mb(a.j);Sc(a,b);H(a)},isEnabled:function(a){return!a.j.ta},
object:a,$:function(a){return!a.j.readOnly}});a.I.add("vpl:run",{action:function(a){var b=a.j.Bc(a.j.Bb);a.Ga[a.la].Ma.nc(b,a.j.Bb);a.j.Vb=!0;a.j.Bg=!1},isEnabled:function(a){if(a.j.ta||!a.Ga[a.la].Ma.isEnabled(a.j.Bb))return!1;a=a.j.getError();return null==a||a.Wb},Pa:function(a){return a.j.Vb},getState:function(a){if(a.j.Tb())return"empty";if(a.j.Vb)return"running";var b=a.j.getError();return b&&!b.Wb?"error":a.j.Bg?"canLoad":"canReload"},pb:function(a,c){c.data instanceof B?c.data.Gb?(c=Ea[a.j.Bb].bd(a.j,
[c.data]),a.Ga[a.la].Ma.nc(c,a.j.Bb)):a.aa.Qb=Tc(a.aa,c):c.data instanceof Ja&&(c=Ea[a.j.Bb].bd(a.j,c.data.actions),a.Ga[a.la].Ma.nc(c,a.j.Bb))},gb:function(a,c){if(a=0<=a.la&&a.Ga[a.la].Ma.isEnabled(a.j.Bb)&&c.data instanceof Ja)a:{a=c.data;for(var b=0;b<a.X.length;b++)if("a"===a.X[b].T.type){a=!0;break a}for(b=0;b<a.actions.length;b++)if("a"===a.actions[b].T.type){a=!0;break a}a=!1}return a||c.data instanceof B&&null!=c.data.Gb&&"a"===c.data.T.type},object:a,$:function(a){return 0<=a.la},lb:[{selected:!1},
{selected:!0},{state:"empty"},{state:"running"},{state:"error"},{state:"canLoad"},{state:"canReload"}],xc:"r"});a.I.add("vpl:stop",{action:function(a){Hc(a);a.j.Vb=!1},isEnabled:function(a){return Ic(a)},object:a,$:function(a){return 0<=a.la},xc:"."});a.I.add("vpl:stop-abnormally",{action:function(a){Hc(a,!0);a.j.Vb=!1},isEnabled:function(a){return Ic(a)},object:a,$:function(a){return 0<=a.la}});a.I.add("vpl:slowdown",{action:function(a){var b=[.1,.2,.5,1];a.j.Af=b[(b.indexOf(a.j.Af)+1)%b.length]},
Pa:function(a){return 1!==a.j.Af},getState:function(a){return a.j.Af},object:a,lb:[{selected:!0,state:.1},{selected:!0,state:.2},{selected:!0,state:.5},{selected:!1,state:1}],$:function(a){return 0<=a.la}});a.I.add("vpl:debug",{action:function(){},Pa:function(){return!1},object:a,$:function(){return!1},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:flash",{action:function(a){var b=a.j.Bc(a.j.Bb);a.Ga[a.la].Ma.Tf(b,a.j.Bb);a.j.Ac=!0},isEnabled:function(a){if(a.j.ta||!a.Ga[a.la].Ma.pf(a.j.Bb))return!1;
a=a.j.getError();return null==a||a.Wb},Pa:function(a){return a.j.Ac},object:a,$:function(a){return 0<=a.la&&null!=a.Ga[a.la].Ma.ug}});a.I.add("vpl:connected",{Pa:function(a){return!a.j.ta&&a.Ga[a.la].Ma.isConnected()},getState:function(a){return a.Bf?"monitored":!1===a.Bf?"nonmonitored":""},object:a,$:function(a){return 0<=a.la},lb:[{selected:!1},{selected:!0},{selected:!1,state:"monitored"},{selected:!0,state:"monitored"},{selected:!1,state:"nonmonitored"},{selected:!0,state:"nonmonitored"}]});a.I.add("vpl:robot",
{action:function(a){a.la=(a.la+1)%a.Ga.length},getState:function(a){return a.Ga[a.la].name},object:a,$:function(a){return 1<a.Ga.length}});a.I.add("vpl:volume",{action:function(a){var b=[null,8,7,6,5,4,3,2,1,0];a.j.volume=b[(b.indexOf(a.j.volume)+1)%b.length]},Pa:function(a){return null!==a.j.volume},getState:function(a){return null===a.j.volume?"":a.j.volume.toString(10)},object:a,lb:[{selected:!1,state:""},{selected:!0,state:"8"},{selected:!0,state:"7"},{selected:!0,state:"6"},{selected:!0,state:"5"},
{selected:!0,state:"4"},{selected:!0,state:"3"},{selected:!0,state:"2"},{selected:!0,state:"1"},{selected:!0,state:"0"}]});a.I.add("vpl:sim",{action:function(a){a.we?a.qb(["sim"],{ye:!0}):a.qb(["sim"],{ue:"vpl"})},isEnabled:function(a){return!a.j.ta},object:a,$:function(a){return 0<=a.la&&null!=a.M&&0>a.Ka.indexOf("sim")}});a.I.add("vpl:duplicate",{isEnabled:function(a){return!a.j.ta},pb:function(a,c){var b=a.j.j.indexOf(c.data);0<=b&&(a.j.yb(),a.j.j.splice(b+1,0,c.data.sb()),mb(a.j),a.aa.qa&&a.aa.qa(),
a.log())},gb:function(a,c){return c.data instanceof Ja&&!c.data.Tb()},object:a,$:function(a){return!a.j.readOnly}});a.I.add("vpl:disable",{isEnabled:function(a){return!a.j.ta},pb:function(a,c){c.data instanceof B?(a.j.yb(),c.data.disabled=!c.data.disabled,mb(a.j),a.aa.qa&&a.aa.qa(),a.log()):c.data instanceof Ja&&(a.j.yb(),c=c.data,c.disabled=!c.disabled,c.disabled&&(c.error=null),a.aa.qa&&a.aa.qa(),a.log())},gb:function(a,c){return c.data instanceof Ja?!c.data.Tb():c.data instanceof B&&null!==c.data.Gb},
object:a,$:function(a){return!a.j.readOnly}});a.I.add("vpl:lock",{isEnabled:function(a){return!a.j.ta},pb:function(a,c){c.data instanceof B?(a.j.yb(),c.data.locked=!c.data.locked,mb(a.j),a.aa.qa&&a.aa.qa(),a.log()):c.data instanceof Ja&&(a.j.yb(),c.data.locked=!c.data.locked,a.aa.qa&&a.aa.qa(),a.log())},gb:function(a,c){return c.data instanceof Ja?!c.data.Tb():c.data instanceof B&&null!==c.data.Gb},object:a,$:function(a){return a.j.kh&&"t"===a.j.Zb&&!a.j.readOnly}});a.I.add("vpl:trashcan",{isEnabled:function(a){return!a.j.ta},
pb:function(a,c){c.data instanceof B?null!==c.data.Gb&&(a.j.yb(),c.data.Gb.Gg(c.data.Ve),mb(a.j),a.aa.qa&&a.aa.qa(),a.log()):c.data instanceof Ja&&(c=a.j.j.indexOf(c.data),0<=c&&(a.j.yb(),a.j.j.splice(c,1),mb(a.j),a.aa.qa&&a.aa.qa(),a.log()))},gb:function(a,c){return c.data instanceof B?null!==c.data.Gb&&!c.data.locked:c.data instanceof Ja&&(!c.data.Tb()||a.j.j.indexOf(c.data)+1<a.j.j.length)&&!c.data.locked},object:a,$:function(a){return!a.j.readOnly}});a.I.add("vpl:message-error",{isEnabled:function(){return!1},
getState:function(a){return a.Pb},object:a,$:function(a){return a.Pb&&!a.yd}});a.I.add("vpl:message-warning",{isEnabled:function(){return!1},getState:function(a){return a.Pb},object:a,$:function(a){return a.Pb&&a.yd}});a.I.add("vpl:message-empty",{isEnabled:function(){return!1},object:a,$:function(a){return!a.Pb}});a.I.add("vpl:filename",{action:function(a){a.j.Pe||gc(a,{mh:a.j.filename||"program.vpl3",Ec:".vpl3",display:function(){a.aa.qa&&a.aa.qa()},finish:function(b){null!==b&&(a.j.yb(),a.j.filename=
b);a.Da=null;a.aa.qa&&a.aa.qa()},Rc:a.j})},isEnabled:function(a){return!a.j.Pe},getState:function(a){return a.j.Pe?(a.j.filename||"program.vpl3")+(a.username?"\n"+a.username:""):a.j.filename||"program.vpl3"},object:a,$:function(a){return a.j.filename||a.username||!a.j.Pe?!0:!1}});a.I.add("vpl:teacher",{action:function(a){a.j.W.wb=!a.j.W.wb;"t"===a.j.Zb?a.j.W.hc=a.j.W.wb:a.j.W.Ee=a.j.W.wb;a.j.W.wb||(uc(a),0>a.Jc.indexOf("vpl:teacher-setasnew")&&0>a.yc.indexOf("vpl:setasnew")&&a.I.Dd("vpl:teacher-setasnew"))},
isEnabled:function(a){return!a.j.ta&&!a.j.readOnly},Pa:function(a){return a.j.W.wb},object:a,pd:!0,$:function(a){return a.j.Zb!==Za&&!a.j.readOnly},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:teacher-reset",{action:function(a,c){c?(hb(a.j.mode),a.j.ec=ab,a.j.jc=cb):(fb(),ib(a.j),a.j.We())},isEnabled:function(a){return!a.j.ta},object:a,pd:!0,$:function(a){return a.j.Zb!==Za&&a.j.W.wb&&!a.j.readOnly}});a.I.add("vpl:teacher-save",{action:function(a){a=pb(a.j,{qd:!0,td:!1});tc(a,"ui.vpl3ui","application/x-vpl3-ui")},
isEnabled:function(a){return!a.j.ta},object:a,pd:!0,$:function(a){return a.j.Zb!==Za&&a.j.W.wb&&!a.j.readOnly}});a.I.add("vpl:teacher-setasnew",{action:function(a){var b=pb(a.j,{qd:!0,td:!1});a.ve=a.ve===b?null:b},Pa:function(a){return a.ve===pb(a.j,{qd:!0,td:!1})},object:a,pd:!0,$:function(a){return a.j.Zb!==Za&&a.j.W.wb&&!a.j.readOnly},lb:[{selected:!1},{selected:!0}]})};function Uc(a){this.i=a;this.controls=[];this.b="";this.y=this.x=0}function Vc(a,c,b,d,e){a.controls.push({J:c,Ea:d||null,id:e||"",hd:b,x:0,y:0});a.b+="X"}
function Wc(a,c,b,d){a.x=c.x;a.y=c.y;for(var e=a.b.replace(/^[s ]+/,"").replace(/[s ]+$/,"").replace(/ +/g," ").replace(/s +/g,"s").replace(/ +s/g,"s").replace(/s+/g,"s"),f=0,g=0,k=0,l=0,h=0;h<e.length;h++)switch(e[h]){case "X":f+=L(b[a.controls[l].id]);l++;break;case " ":case "_":g++;break;case "s":case "S":k++}d=d?L(d):0;var q=0;if(f>=c.width)d=0;else for(;;){q=(c.width-(f+d*g))/k;if(q>=d||!(0<d))break;d/=2}l=0;f=c.x;for(h=0;h<e.length;h++)switch(e[h]){case "X":g=a.controls[l];g.x=f+b[g.id].offsetLeft();
f+=L(b[g.id]);g.y=c.y+b[g.id].offsetTop();l++;break;case " ":case "_":f+=d;break;case "s":case "S":f+=q}}
function Xc(a,c,b,d){Yc(a.i,function(b){Zc(c,b,a.x,a.y)});a.controls.forEach(function(c){$c(this.i,c.x,c.y,b[c.id],function(b,d,e){var f=Math.min(d.width/(c.hd.oa-c.hd.Y),d.height/(c.hd.pa-c.hd.ba));b.save();b.translate(-c.hd.Y,-c.hd.ba);1!==f&&(b.scale(f,f),d=d.sb(),d.width/=f,d.height/=f);c.J(b,d,e)&&ad(a.i,0,0,d.width,d.height,["button"],["button"]);b.restore()},{action:c.Ea.action||null,pb:c.Ea.pb||null,gb:c.Ea.gb||null,zc:d?function(){d(c.id)}:null},c.id)},a)};function sc(a,c,b,d,e,f,g,k,l,h,q,p){function t(a,c,e){b.save();e&&(b.scale(-1,1),b.translate(-2*a-d.g,0));b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(a,c,d.g,d.g);b.fillStyle=l?m.U:m.ea;b.beginPath();b.moveTo(a+.1*d.g,c+.6*d.g);b.lineTo(a+.4*d.g,c+.6*d.g);b.lineTo(a+.25*d.g,c+.34*d.g);b.closePath();b.fill();b.beginPath();b.arc(a+.5*d.g,c+.83*d.g,.4*d.g,4.2,5.6);b.strokeStyle=b.fillStyle;b.lineWidth=.08*d.g;b.stroke();b.restore()}function u(a,c,e){var f=d.g;b.save();b.fillStyle=q?m.Ba:m.xa;b.fillRect(a,
c,f,f);b.translate(a+f/2,c+f/2);b.rotate(-e*Math.PI/2);b.translate(-a-f/2,-c-f/2);b.beginPath();b.moveTo(a+.3557*f,c+.25*f);b.lineTo(a+.3557*f,c+.75*f);b.lineTo(a+.7887*f,c+.5*f);b.closePath();b.strokeStyle=m.U;b.lineWidth=2*d.Ca;b.stroke();b.restore()}function w(){b.beginPath();b.moveTo(0,.5*d.g);b.lineTo(.5*d.g,.5*d.g);b.lineTo(.5*d.g,-.25*d.g);b.bezierCurveTo(.3*d.g,-.5*d.g,.02*d.g,-.5*d.g,0,-.5*d.g);b.lineTo(0,-.5*d.g);b.bezierCurveTo(-.02*d.g,-.5*d.g,-.3*d.g,-.5*d.g,-.5*d.g,-.25*d.g);b.lineTo(-.5*
d.g,.5*d.g);b.closePath();b.fillStyle=l?m.U:m.ea;b.fill()}var m={xa:"navy",Ba:"#37f",Cd:"#06f",U:"white",ea:"#777",Nc:"#44a",rg:"#ddf",se:"#99a",hf:"#a00",lg:"#d10",jf:"#d00",mg:"#f50",te:"#c66",sg:"#800"};m={xa:"white",Ba:"#ddd",Cd:"white",U:"#333",ea:"#999",Nc:"#ddd",rg:"#555",se:"#666",hf:"#fcc",lg:"#fcc",jf:"#faa",mg:"#faa",te:"#866",sg:"#faa"};var n={"vpl:close":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,.5*d.g,d.g);b.beginPath();b.moveTo(.1*d.g,.1*d.g);b.lineTo(.4*d.g,.4*d.g);b.moveTo(.1*
d.g,.4*d.g);b.lineTo(.4*d.g,.1*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:about":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.7*d.g).toString(10)+"px times";b.fillStyle=l?m.U:m.ea;b.fillText("i",.5*d.g,.5*d.g)},"vpl:help":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.7*d.g).toString(10)+"px times";b.fillStyle=
l?m.U:m.ea;b.fillText("?",.5*d.g,.5*d.g)},"vpl:statement":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.fillStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.25*d.g,.2*d.g,.5*d.g,.6*d.g);b.beginPath();b.arc(.33*d.g,.4*d.g,.03*d.g,0,2*Math.PI);b.arc(.33*d.g,.6*d.g,.03*d.g,0,2*Math.PI);b.fill();for(var a=0;5>a;a++)b.beginPath(),b.moveTo(.4*d.g,d.g*(.32+.1*a)),b.lineTo(.7*d.g,d.g*(.32+.1*a)),b.stroke(),b.lineWidth=.01*d.g,b.setLineDash([.02*d.g,.02*d.g])},"vpl:readonly":function(){var a=
d.g;b.save();b.fillStyle=m.se;b.strokeStyle=m.se;b.lineWidth=d.Ca;b.translate(.5*a,.7*a);b.save();b.rotate(.6);b.beginPath();b.moveTo(-.015/.22*a,.07*a);b.lineTo(0,.22*a);b.lineTo(.015/.22*a,.07*a);b.fill();b.beginPath();b.moveTo(-.1*a,-.4*a);b.lineTo(-.1*a,0);b.lineTo(0,.22*a);b.lineTo(.1*a,0);b.lineTo(.1*a,-.4*a);b.restore();b.moveTo(-.2*a,-.4*a);b.lineTo(.4*a,.2*a);b.stroke();b.restore()},"vpl:new":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*
d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:save":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*
d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.8*d.g,.8*d.g);b.moveTo(.7*d.g,.7*d.g);b.lineTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.stroke()},"vpl:exportToHTML":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.2*d.g);b.lineTo(.8*d.g,.5*d.g);b.moveTo(.7*d.g,.4*d.g);b.lineTo(.8*d.g,.5*d.g);b.lineTo(.9*
d.g,.4*d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.3*d.g).toString(10)+"px sans-serif";b.fillStyle=l?m.U:m.ea;b.fillText("HTML",.5*d.g,.7*d.g);b.stroke()},"vpl:load":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.strokeStyle=
l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.55*d.g);b.lineTo(.8*d.g,.85*d.g);b.moveTo(.7*d.g,.65*d.g);b.lineTo(.8*d.g,.55*d.g);b.lineTo(.9*d.g,.65*d.g);b.stroke()},"vpl:upload":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.25*d.g);b.lineTo(.25*d.g,.75*d.g);b.lineTo(.67*d.g,.75*d.g);b.lineTo(.67*d.g,.32*d.g);b.lineTo(.6*d.g,.25*d.g);b.closePath();b.moveTo(.6*d.g,.25*d.g);b.lineTo(.6*d.g,.32*d.g);b.lineTo(.67*
d.g,.32*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();var a=.15;if("uploaded"===p||"canUploadAgain"===p)b.beginPath(),b.moveTo(.7*d.g,.1*d.g),b.lineTo(.7*d.g,.35*d.g),b.lineTo(.9*d.g,.35*d.g),b.lineTo(.9*d.g,.16*d.g),b.lineTo(.84*d.g,.1*d.g),b.closePath(),b.fillStyle=m.se,b.fill(),a=.4;b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,d.g*(a/1.5+.35));b.lineTo(.8*d.g,d.g*a);b.moveTo(.7*d.g,d.g*(a+.1));b.lineTo(.8*d.g,d.g*a);b.lineTo(.9*d.g,d.g*(a+.1));b.stroke();b.fillStyle=l?h||q?m.U:
m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:nextProgram":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.fillStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.25*d.g,.2*d.g,.5*d.g,.6*d.g);b.beginPath();b.arc(.33*d.g,.4*d.g,.03*d.g,0,2*Math.PI);b.arc(.33*d.g,.6*d.g,.03*d.g,0,2*Math.PI);b.fill();for(var a=0;5>a;a++)b.beginPath(),b.moveTo(.4*d.g,d.g*(.32+.1*a)),b.lineTo(.7*d.g,d.g*(.32+.1*a)),b.stroke(),b.lineWidth=.01*d.g,b.setLineDash([.02*d.g,.02*
d.g]);b.moveTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.lineTo(.8*d.g,.6*d.g)},"vpl:text":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);for(var a=.2;.6>a;a+=.1)b.moveTo(.3*d.g,d.g*(.2+a)),b.lineTo(.7*d.g,d.g*(.2+a));b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;
b.stroke()},"vpl:text-toggle":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.28*d.g,.2*d.g);b.lineTo(.28*d.g,.7*d.g);b.lineTo(.7*d.g,.7*d.g);b.lineTo(.7*d.g,.27*d.g);b.lineTo(.63*d.g,.2*d.g);b.closePath();b.moveTo(.63*d.g,.2*d.g);b.lineTo(.63*d.g,.27*d.g);b.lineTo(.7*d.g,.27*d.g);for(var a=.1;.5>a;a+=.1)b.moveTo(.33*d.g,d.g*(.2+a)),b.lineTo(.63*d.g,d.g*(.2+a));b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*
d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:advanced":function(){b.fillStyle=q&&l?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?m.U:m.ea;for(var a=0;4>a;a++)for(var c=0;5>c;c++)b.fillRect(.1*d.g*(1+a)+(2>a?0:.43*d.g),.1*d.g*(2+c),.07*d.g,.07*d.g);b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:undo":function(){t(0,0,!1)},"vpl:redo":function(){t(0,0,!0)},"vpl:add-comment":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.2*d.g,.6*d.g);
b.lineTo(.8*d.g,.6*d.g);b.moveTo(.7*d.g,.35*d.g);b.lineTo(.9*d.g,.35*d.g);b.moveTo(.8*d.g,.25*d.g);b.lineTo(.8*d.g,.45*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.strokeRect(.1*d.g,.5*d.g,.8*d.g,.2*d.g)},"vpl:run":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.3*d.g,.25*d.g);b.lineTo(.3*d.g,.75*d.g);b.lineTo(.8*d.g,.5*d.g);b.closePath();b.fillStyle=l?m.U:m.ea;b.fill();b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:stop":function(){b.fillStyle=
q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?m.U:m.ea;b.fillRect(.28*d.g,.28*d.g,.44*d.g,.44*d.g)},"vpl:debug":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.save();b.translate(.5*d.g,.42*d.g);b.scale(.0085*d.g,.012*d.g);b.beginPath();b.arc(0,0,20,0,2*Math.PI);b.moveTo(-13,-10);b.bezierCurveTo(0,-5,0,-5,13,-10);b.moveTo(0,-5);b.lineTo(0,20);b.moveTo(-18,-5);b.lineTo(-30,-10);b.moveTo(-18,2);b.lineTo(-32,6);b.moveTo(-15,10);b.lineTo(-26,
18);b.moveTo(18,-5);b.lineTo(30,-10);b.moveTo(18,2);b.lineTo(32,6);b.moveTo(15,10);b.lineTo(26,18);b.restore();b.stroke();b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:flash":function(){var a=d.g;b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,a,a);b.save();b.translate(.6*a,.4*a);b.scale(.4,.4);w();b.restore();b.save();b.textAlign="center";b.textBaseline="middle";b.translate(.25*a,.4*a);b.rotate(-Math.PI/2);b.font="bold "+Math.round(a/4).toString(10)+"px sans-serif";b.fillStyle=
l?m.U:m.ea;b.fillText("flash",0,0);b.restore();b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:connected":function(){function a(a,c){var e=.08*d.g;b.save();b.fillStyle=l?m.Ba:m.xa;b.fillRect(a-e,c-e,2*e,2*e);b.beginPath();b.moveTo(a-e,c-e);b.lineTo(a+e,c+e);b.moveTo(a+e,c-e);b.lineTo(a-e,c+e);b.stroke();b.restore()}l=!1;b.translate(0,.1*d.g);b.save();b.translate(.8*d.g,.2*d.g);b.scale(.35,.35);w();b.restore();b.fillStyle=l?m.U:m.ea;b.strokeStyle=l?m.U:m.ea;b.lineWidth=
1.5*d.Ca;p&&b.strokeRect(0,.05*d.g,.3*d.g,.3*d.g);b.strokeRect(.3*d.g,.55*d.g,.4*d.g,.3*d.g);b.lineWidth=d.Ca;b.beginPath();b.moveTo(.7*d.g,.7*d.g);b.bezierCurveTo(.9*d.g,.7*d.g,.9*d.g,.7*d.g,.85*d.g,.35*d.g);p&&(b.moveTo(.3*d.g,.7*d.g),b.bezierCurveTo(.1*d.g,.7*d.g,.1*d.g,.7*d.g,.15*d.g,.35*d.g));b.stroke();h||a(.86*d.g,.55*d.g);"nonmonitored"===p&&a(.14*d.g,.55*d.g)},"vpl:robot":function(){b.fillStyle=q?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);switch(p){case "thymio":b.save();b.translate(d.g/2,.35*d.g);
b.scale(.3,.3);b.rotate(.2);w();b.restore();break;case "thymio-tdm":b.save();b.translate(d.g/2,.35*d.g);b.scale(.3,.3);b.rotate(.2);w();b.restore();b.fillStyle=m.U;b.fillRect(.4*d.g,.65*d.g,.2*d.g,.2*d.g);break;case "sim":b.save(),b.translate(d.g/2,.35*d.g),b.scale(.3,.3),b.rotate(.2),w(),b.beginPath(),b.strokeStyle=m.U,b.lineWidth=d.Ca/.3,b.strokeRect(-d.g,-.8*d.g,2*d.g,1.6*d.g),b.restore()}b.beginPath();b.moveTo(.2*d.g,.75*d.g);b.lineTo(.5*d.g,.75*d.g);b.lineTo(.5*d.g,d.g*("sim"===p?.6:.3));b.strokeStyle=
m.U;b.lineWidth=d.Ca;b.stroke()},"vpl:sim":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.save();b.translate(d.g/2,.35*d.g);b.scale(.4,.4);b.rotate(.2);w();b.beginPath();b.arc(d.g,.5*d.g,1.4*d.g,-3.2,-3.8,!0);b.strokeStyle=q&&l?m.rg:m.se;b.lineWidth=.2*d.g;b.stroke();b.beginPath();b.arc(d.g,.5*d.g,.6*d.g,-3.3,-3.8,!0);b.stroke();b.restore()},"vpl:message-empty":function(){},"vpl:message-error":function(){if(p){b.fillStyle=g.color;b.font=bd(g);b.textAlign="center";b.textBaseline="middle";
var a=k.translate(p);b.fillText(a,g.width/2,g.height/2)}},"vpl:filename":function(){if(a.j.Pe){if(p){b.beginPath();var c=3*d.g;b.rect(0,0,c,d.g);b.clip();b.fillStyle=g.color;b.font=bd(g);b.textAlign="center";b.textBaseline="middle";var e=p.trim();e=e.split("\n").slice(0,2).map(function(a){a=a.slice(0,80);if(1<a.length&&b.measureText(a).width>c){for(;1<a.length&&b.measureText(a+"\u2026").width>c;)a=a.slice(0,-1);a+="\u2026"}return a});1<e.length?(b.fillText(e[0],g.width/2,.25*g.height),b.fillText(e[1],
g.width/2,.75*g.height)):b.fillText(e[0],g.width/2,g.height/2)}}else if(b.beginPath(),c=3*d.g,e=p,b.rect(0,0,g.width,g.height),b.clip(),b.fillStyle=g.color,b.font=bd(g),b.textBaseline="middle",null!=a.Da&&a.Da.Rc===a.j){e=b.measureText(a.Da.v.slice(0,a.Da.b));var f=e.fontBoundingBoxAscent||0,k=e.fontBoundingBoxDescent||0;if(0===f||0===k)k=f=g.fontSize/2;var h={top:g.height/2-f,bottom:g.height/2+k,left:2,right:2+b.measureText(a.Da.v).width},l=a.Da.v.split("").map(function(c,d){return b.measureText(a.Da.v.slice(0,
d+1)).width});cd(a.Da,h,l);l=Math.min(0,g.width-b.measureText("0").width/4-h.right);if(a.Da.i===a.Da.b)b.strokeStyle="black",b.beginPath(),b.moveTo(l+h.left+e.width,h.top),b.lineTo(l+h.left+e.width,h.bottom),b.stroke();else{l=0;var m=b.measureText(a.Da.v.slice(a.Da.b,a.Da.i));b.save();b.fillStyle="silver";b.fillRect(h.left+e.width-1,h.top,m.width,f+k);b.restore()}b.textAlign="left";b.fillText(a.Da.v,l,g.height/2)}else b.textAlign="center",b.fillText(e,g.width/2,g.height/2)},"vpl:duplicate":function(){b.fillStyle=
q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.15*d.g);b.strokeRect(.3*d.g,.55*d.g,.4*d.g,.15*d.g)},"vpl:disable":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.4*d.g);b.beginPath();b.moveTo(.2*d.g,.6*d.g);b.lineTo(.8*d.g,.4*d.g);b.stroke()},"vpl:lock":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;
b.fillStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.4*d.g);dd(b,.5*d.g,.52*d.g,.04*d.g,m.U)},"vpl:trashcan":function(){b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.32*d.g,.8*d.g);b.lineTo(.68*d.g,.8*d.g);b.lineTo(.75*d.g,.2*d.g);b.closePath();b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:teacher-reset":function(){b.fillStyle=q&&l?m.jf:m.hf;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*
d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=l?m.U:m.te;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?m.U:m.te;ed(b,.63*d.g,.7*d.g,.2*d.g)},"vpl:teacher-save":function(){b.fillStyle=q&&l?m.jf:m.hf;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.te;b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);
b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.8*d.g,.8*d.g);b.moveTo(.7*d.g,.7*d.g);b.lineTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.stroke();b.fillStyle=l?m.U:m.te;ed(b,.46*d.g,.45*d.g,.2*d.g)},"vpl:teacher-setasnew":function(){b.fillStyle=q&&l?h?m.mg:m.jf:h&&l?m.lg:m.hf;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.te;b.beginPath();
b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.5*d.g,.5*d.g);b.moveTo(.6*d.g,.4*d.g);b.lineTo(.5*d.g,.5*d.g);b.lineTo(.6*d.g,.6*d.g);b.stroke();b.fillStyle=l?h||q?m.U:m.sg:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:teacher":function(){b.fillStyle=
q&&l?h?m.mg:m.jf:h&&l?m.lg:m.hf;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?m.U:m.te;ed(b,.5*d.g,.4*d.g,.27*d.g);b.fillStyle=l?h||q?m.U:m.sg:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"src:vpl":function(){b.save();b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=
l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=q&&l?m.U:m.se;for(var a=.15;.6>a;a+=.15)b.fillRect(.3*d.g,d.g*(.2+a),.4*d.g,.1*d.g);b.restore()},"src:locked":function(){b.save();b.fillStyle=l?q?m.Ba:h?m.Cd:m.xa:m.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.fillStyle=l?h?m.rg:m.se:m.ea;for(var a=.15;.6>a;a+=.15)b.fillRect(.15*d.g,d.g*a,.4*d.g,.1*d.g);dd(b,.77*d.g,.36*d.g,.06*d.g,l?m.U:m.ea,!h);b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},
"src:language":function(){var a=d.g;b.save();b.fillStyle=l?q?m.Ba:m.xa:m.xa;b.fillRect(0,0,a,a);b.beginPath();for(var c=0;3>c;c++)b.moveTo(.2*a,a*(.2+.1*c)),b.lineTo(.5*a,a*(.2+.1*c));b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();for(c=0;3>c;c++){var e=2*(c+.25)/3*Math.PI;fd(b,.75*a,.3*a,.15*a,e-.3*Math.PI,e+.3*Math.PI,{Bd:!1,Xc:3*d.Ca,style:l?m.U:m.ea})}b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(a/3).toString(10)+"px sans-serif";b.fillStyle=l?m.U:m.ea;b.fillText({aseba:"Aa",
l2:"l2",asm:"asm",js:"js",python:"Py"}[p],.5*a,.7*a);b.restore()},"src:disass":function(){var a=d.g;b.save();b.fillStyle=l&&q?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,a,a);b.beginPath();b.moveTo(.2*a,.2*a);b.lineTo(.3*a,.2*a);for(var c=0;5>c;c++)b.moveTo(.4*a,a*(.2+.1*c)),b.lineTo(.45*a,a*(.2+.1*c)),b.moveTo(.55*a,a*(.2+.1*c)),b.lineTo(.65*a,a*(.2+.1*c));b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l&&(h||q)?m.U:m.Nc;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},"src:run":function(){b.fillStyle=
q&&l?m.Ba:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.3*d.g,.25*d.g);b.lineTo(.3*d.g,.75*d.g);b.lineTo(.8*d.g,.5*d.g);b.closePath();b.fillStyle=l?m.U:m.ea;b.fill()},"sim:restart":function(){b.save();b.fillStyle=q?m.Ba:m.xa;b.fillRect(0,0,g.width,g.height);var a=d.g;b.lineWidth=.05*a;fd(b,.5*a,.5*a,.25*a,1.56,0,{Bd:!1,Xc:.2*a,style:m.U});b.restore()},"sim:pause":function(){b.save();b.fillStyle=q?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?m.U:m.ea;b.fillRect(.28*d.g,.28*d.g,.15*
d.g,.44*d.g);h?(b.beginPath(),b.moveTo(.54*d.g,.28*d.g),b.lineTo(.62*d.g,.28*d.g),b.lineTo(.75*d.g,.5*d.g),b.lineTo(.62*d.g,.72*d.g),b.lineTo(.54*d.g,.72*d.g),b.fill()):b.fillRect(.57*d.g,.28*d.g,.15*d.g,.44*d.g);b.restore()},"sim:speedup":function(){b.save();b.fillStyle=q&&l?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?m.U:m.ea;b.beginPath();for(var a=0;2>a;a++)b.moveTo(d.g*(.3+.22*a),.25*d.g/2),b.lineTo(d.g*(.3+.22*a),.75*d.g/2),b.lineTo(d.g*(.5+.22*a),.5*d.g/2),b.closePath();b.fill();
b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(d.g/3).toString(10)+"px sans-serif";b.fillText(1<=p?"\u00d7"+p.toString(10):"\u00f7"+Math.round(1/p).toString(10),.5*d.g,.7*d.g);b.restore()},"sim:noise":function(){b.save();b.fillStyle=q&&l?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();var a=[.58,1.48,.96,.39,1.36,.09,-.75,-1.58,-.32,-1.36,-1.39,-.94,-1.1,-1.04,-.1,.93,1.22,.6,.89,.61];b.moveTo(.1*d.g,(.4+.1*a[0])*d.g);for(var c=1;c<a.length;c++)b.lineTo((.1+.8/(a.length-
1)*c)*d.g,(.4+.1*a[c])*d.g);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},"sim:pen":function(){var a=d.g;b.save();b.fillStyle=q&&l?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,a,a);b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*a,.8*a,.8*a,.1*a);b.translate(.5*a,a*(.4+(h?.13:0)));b.beginPath();b.moveTo(-.015/.22*a,.07*a);b.lineTo(0,.22*a);b.lineTo(.015/.22*a,.07*a);b.fillStyle=l?m.U:m.ea;b.fill();b.beginPath();b.moveTo(-.1*
a,-.22*a);b.lineTo(-.1*a,0);b.lineTo(0,.22*a);b.lineTo(.1*a,0);b.lineTo(.1*a,-.22*a);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.stroke();b.restore()},"sim:clear":function(){var a=d.g;b.save();b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,0,a,a);b.strokeStyle=l?m.U:m.ea;b.lineWidth=d.Ca;b.strokeRect(.15*a,.25*a,.7*a,.5*a);b.translate(.5*a,.4*a);b.rotate(.4);b.fillStyle=l?m.U:m.ea;b.fillRect(0,0,.3*a,.2*a);b.restore()},"sim:map-kind":function(){var a=d.g,c=d.Ca;b.save();b.fillStyle=q&&l?m.Ba:m.xa;b.fillRect(0,
0,d.g,d.g);b.lineWidth=c;b.strokeStyle=l?m.U:m.ea;b.fillStyle=l?m.U:m.ea;for(var e=["ground","height","obstacles"].indexOf(p),f=0;3>f;f++){var g=2*(f+.25)/3*Math.PI;f===e?b.fillRect(a*(.35+.25*Math.cos(g)),a*(.39+.25*Math.sin(g)),.3*a,.22*a):b.strokeRect(a*(.35+.25*Math.cos(g)),a*(.39+.25*Math.sin(g)),.3*a,.22*a);fd(b,.5*a,.5*a,.36*a,g-.42*Math.PI,g-.22*Math.PI,{Bd:!1,Xc:3*c,style:m.U})}b.restore()},"sim:map":function(){var a=d.g;b.save();b.fillStyle=q&&l?m.Ba:h?m.Cd:m.xa;b.fillRect(0,0,d.g,d.g);
b.fillStyle=l?h||q?m.U:m.Nc:m.ea;b.fillRect(.1*a,.8*a,.8*a,.1*a);b.lineWidth=d.Ca;b.strokeStyle=l?m.U:m.ea;b.strokeRect(.15*a,.15*a,.7*a,.5*a);switch(p){case "ground":b.lineWidth=.08*a;b.beginPath();b.arc(.6*a,.4*a,.15*a,-.5*Math.PI,.5*Math.PI);b.lineTo(.4*a,.55*a);b.arc(.4*a,.4*a,.15*a,.5*Math.PI,1.5*Math.PI);b.closePath();b.stroke();break;case "height":b.beginPath();for(var c=0;.75>=c;c+=.25)for(var e=0;1>=e;e+=.1){var f=a*(.2+.5*e+.15*c),g=a*(.5-.3*c-.2*(.2*Math.cos(5*e+2*c-3)-(c-.9)*(c-.9)/3));
0===e?b.moveTo(f,g):b.lineTo(f,g)}b.stroke();break;case "obstacles":b.strokeRect(.2*a,.2*a,.6*a,.4*a),b.beginPath(),b.moveTo(.4*a,.2*a),b.lineTo(.4*a,.43*a),b.moveTo(.6*a,.6*a),b.lineTo(.6*a,.37*a),b.stroke()}b.restore()},"sim:map-ground":function(){p="ground";n["sim:map"]()},"sim:map-height":function(){p="height";n["sim:map"]()},"sim:map-obstacles":function(){p="obstacles";n["sim:map"]()},"sim-event:forward":function(){u(0,0,1)},"sim-event:backward":function(){u(0,0,3)},"sim-event:left":function(){u(0,
0,2)},"sim-event:right":function(){u(0,0,0)},"sim-event:center":function(){var a=d.g;b.save();b.fillStyle=q?m.Ba:m.xa;b.fillRect(0,0,a,a);b.beginPath();b.arc(.5*a,.5*a,.25*a,0,2*Math.PI);b.strokeStyle=m.U;b.lineWidth=2*d.Ca;b.stroke();b.restore()},"sim-event:clap":function(){var a=d.g;b.save();b.fillStyle=q?m.Ba:m.xa;b.fillRect(0,0,a,a);b.beginPath();b.strokeStyle=m.U;b.lineWidth=2*d.Ca;b.translate(.5*a,.5*a);b.rotate(.1);for(var c=0;9>c;c++)b.beginPath(),b.moveTo(.12*a,0),b.lineTo(.24*a,0),b.moveTo(.28*
a,0),b.lineTo(.36*a,0),b.stroke(),b.rotate(Math.PI/4.5);b.restore()},"sim-event:tap":function(){var a=d.g;b.save();b.fillStyle=q?m.Ba:m.xa;b.fillRect(0,0,a,a);b.beginPath();b.strokeStyle=m.U;b.lineWidth=2*d.Ca;b.translate(.6*a,.6*a);for(var c=1;3>=c;c++)b.beginPath(),b.arc(0,0,.15*a*c,.9*Math.PI,1.7*Math.PI),b.stroke();b.moveTo(.3*a,0);b.lineTo(0,0);b.lineTo(0,.3*a);b.stroke();b.restore()}};n["vpl:message-warning"]=n["vpl:message-error"];n["vpl:slowdown"]=n["sim:speedup"];n["src:close"]=n["vpl:close"];
n["src:new"]=n["vpl:new"];n["src:save"]=n["vpl:save"];n["src:load"]=n["vpl:load"];n["src:stop"]=n["vpl:stop"];n["src:connected"]=n["vpl:connected"];n["src:sim"]=n["vpl:sim"];n["src:teacher"]=n["vpl:teacher"];n["src:teacher-reset"]=n["vpl:teacher-reset"];n["sim:close"]=n["vpl:close"];n["sim:vpl"]=n["src:vpl"];n["sim:text"]=n["vpl:text"];n["sim:teacher"]=n["vpl:teacher"];n["sim:teacher-reset"]=n["vpl:teacher-reset"];(c=n[c])&&c();return!1}
function gd(a,c){switch(a){case "vpl:close":case "src:close":case "sim:close":return{Y:0,oa:c.g/2,ba:0,pa:c.g};case "vpl:message-error":case "vpl:message-warning":case "vpl:message-empty":return{Y:0,oa:5*c.g,ba:0,pa:c.g};case "vpl:filename":return{Y:0,oa:3*c.g,ba:0,pa:c.g}}return{Y:0,oa:c.g,ba:0,pa:c.g}};function hd(a,c){var b=0<=a.W.b.indexOf(c);return(a.kc?a.kc.$:a.I.$(c))&&(a.W.hc||!b)}
function id(a,c,b,d,e,f){var g=0<=c.W.b.indexOf(b);if(hd(c,b)){var k=a.i,l=c.I.find(b),h=l.pd;Vc(a,function(a,f,l){if(c.kc)e(c,b,a,k.A,k.ia,d,f,c.i,c.kc.isEnabled&&(h||!c.W.Ee),c.kc.Pa,c.kc.nh,c.kc.state);else{var q=c.I.isEnabled(b)&&(h||!c.W.Ee);!q&&c.W.i&&(q=c.I.gb(b,{data:jd(c.R)}));e(c,b,a,k.A,k.ia,d,f,c.i,q,c.I.Pa(b),l,c.I.getState(b))}return c.kc?c.kc.disabled:g},f,{action:c.W.hc&&!h?function(){c.W.toggle(b);return 1}:!Rb(c.I,b)||!h&&c.W.Ee?!c.W.i||c.W.hc&&!h&&c.W.Ee?null:function(){kd(c.R,
l)}:function(a){c.I.Dd(b,a.ei)},pb:c.W.hc&&!h&&c.W.Ee?null:function(a,d){c.I.pb(b,d)},gb:c.W.hc&&!h&&c.W.Ee?null:function(a,d){return c.I.gb(b,d)}},b)}}function ld(a,c,b,d,e,f){a.controls=[];a.b="";for(var g=0;g<b.length;g++)switch(b[g]){case "!space":a.b+=" ";break;case "!!space":a.b+="_";break;case "!stretch":a.b+="s";break;case "!!stretch":a.b+="S";break;default:id(a,c,b[g],d,e,f(b[g],a.i.A,c.I.find(b[g]).ed))}}
function md(a,c){for(var b=0;b<c.length;b++)if("!"!==c[b][0]&&a.I.$(c[b]))return!0;return!1}function wc(a,c,b,d,e){for(var f={},g=0;g<c.length;g++)if("!"!==c[g][0]){var k=a.Ha&&a.I.gb(c[g],a.Ha)?["possible-drop-target"]:[];k=N(a.ia,{tag:"button",id:c[g].replace(/:/g,"-"),ga:d?b.concat(d(c[g])):b,mb:e?k.concat(e(c[g])):k});f[c[g]]=k}return f}function nd(a){var c=0,b;for(b in a)a.hasOwnProperty(b)&&(c=Math.max(c,a[b].ra()));return c};var od={"vpl:then":function(a,c,b,d){c=Math.min(d.width,d.height);a.strokeStyle=b.Ig;a.lineWidth=.2*c;a.beginPath();a.moveTo(-.25*c,-.5*c);a.lineTo(.25*c,0);a.lineTo(-.25*c,.5*c);a.stroke()},"vpl:error":function(a,c,b,d){c=Math.min(d.width,d.height);a.fillStyle="white";a.strokeStyle=b.qg;a.lineWidth=.07*c;a.beginPath();a.arc(0,0,.5*c,0,2*Math.PI);a.fill();a.stroke();a.fillStyle=b.qg;a.font="bold "+Math.round(.75*c).toString()+"px sans-serif";a.textAlign="center";a.textBaseline="middle";a.fillText("?",
0,.05*c)},"vpl:warning":function(a,c,b,d){c=Math.min(d.width,d.height);a.fillStyle="white";a.strokeStyle=b.Ug;a.lineWidth=.07*c;a.beginPath();a.arc(0,0,.5*c,0,2*Math.PI);a.fill();a.stroke();a.fillStyle=b.Ug;a.font="bold "+Math.round(.75*c).toString()+"px sans-serif";a.textAlign="center";a.textBaseline="middle";a.fillText("!",0,.05*c)},"vpl:moreHigh":function(a,c,b,d){c=Math.min(d.width,d.height);a.beginPath();a.moveTo(-.2*c,.1*c);a.lineTo(0,-.1*c);a.lineTo(.2*c,.1*c);a.lineWidth=.1*c;a.strokeStyle=
"black";a.shadowColor="white";a.shadowBlur=.2*c;a.stroke()},"vpl:moreLow":function(a,c,b,d){c=Math.min(d.width,d.height);a.beginPath();a.moveTo(-.2*c,-.1*c);a.lineTo(0,.1*c);a.lineTo(.2*c,-.1*c);a.lineWidth=.1*c;a.strokeStyle="black";a.shadowColor="white";a.shadowBlur=.2*c;a.stroke()},"vpl:customize":function(a,c,b,d){c=Math.min(d.width,d.height)/2;a.fillStyle=b.Ig;ed(a,0,0,c)}};function Yb(){this.b=new pd;this.i=new pd;this.i.S=!0;this.l=new pd}function qd(a,c){return function(){a.u!==c&&(a.u=c,H(a))}}function rd(a){return function(c){a.u!==c&&(a.u=c,H(a))}}var sd={e:"event",s:"state",a:"action",c:"comment"};
function td(a,c,b,d,e,f,g,k){function l(a){return"a"===a||"c"===a}var h=a.j,q=Math.min(d.width,d.height),p=0!=c.A.m?q/c.A.m:1,t=sd[b.T.type];t&&0>e.indexOf(t)&&e.push(t);var u=new ud(b,d.width,d.height,f,g,function(a,c,f,g,h){var l=a.N;l.save();var m=a.A;a.A=qc(q,a.A.g*p);Zc(d,l,c.x+f,c.y+g);var n=b.T,r=c.data,w=c.x+f,t=c.y+g;a.N.save();a.N.translate(w,t);n.J(a,r,d,h);a.N.restore();b.locked&&vd(a,c.x+f,c.y+g,q,q,!0);(b.disabled||k.disabled)&&ad(a,c.x+f,c.y+g,q,q,e,e,!b.disabled&&!k.$h);b.marks.uf&&
wd(a,c.x+f,c.y+g,d.width,d.height,e.concat("kbd-target"));b.marks.tf&&wd(a,c.x+f,c.y+g,d.width,d.height,e.concat("kbd-selected"));null!=b.marks.Se&&null!==b.T.ha&&(h=b.T.ha.controls[b.marks.Se],wd(a,c.x+f+d.width*h.left,c.y+g+d.height*h.top,d.width*(h.right-h.left),d.height*(h.bottom-h.top),e.concat("kbd-selected","param")));a.A=m;l.restore()},k&&k.bg||b.disabled||b.locked||b.Gb&&b.Gb.locked||!b.T.fa?k&&k.fa?{fa:k.fa}:null:{fa:b.T.fa,Qa:b.T.Qa},k&&k.ag?null:function(a,b){a.data.Gb&&(h.yb(),a.data.Gb.Yb(b.data,
a.data.Ve,function(){h.yb()},function(){mb(h)}),mb(h));c.qa&&c.qa()},k&&k.ag?null:function(a,c){return c.data instanceof B&&(l(a.data.T.type)===l(c.data.T.type)||"c"===c.data.T.type)&&a.data!==c.data});if(!(k&&k.bg||!b.T.fa)){if(h.ma||b.T.Ie)u.S=function(a){return Tc(c,a)};if(h.S||b.T.Ie)u.ca=function(a){return Tc(c,a)}}u.Za=!(k&&k.$f);u.l=!(k&&k.xf);u.zc=qd(a,b.T.name);f=xd(c,b);a.W.i&&k&&k.ac&&(u.l=!1,u.b=k.ac.type!==cc?{fa:function(c,b,d,e,f,g,h){a.R.Ra!==k.ac.type||a.R.Ab!==k.ac.Ed||a.R.w!==k.ac.Fd?
(a.R.Ra=k.ac.type,a.R.Ab=k.ac.Ed,a.R.w=k.ac.Fd):yd(a.R,(h.x-f)/d,(h.y-g)/e);J(c);return 0},Qa:function(c,b,d,e,f,g,h,l){d=c.b.getBoundingClientRect();b=l.x-d.left;l=l.y-d.top;l=b>=u.x&&b<u.x+u.width&&l>=u.y&&l<u.y+u.height;a.R.Ra!==(l?k.ac.type:zd)&&(a.R.Ra=l?k.ac.type:zd,J(c))}}:{dd:function(){k.ac.click&&k.ac.click()}});Ad(c,u,f);return u}
function Bd(a,c,b,d,e,f,g,k){var l=new B(b,null,null);b.fb&&(l.h=b.fb());l.marks={tf:g||!1,Se:null,uf:!1};var h=a.j;g=0>("b"===h.mode?h.ec:h.jc).indexOf(b.name);a=td(a,c,l,d,["block","library"],e,f,{bg:!0,ag:!0,xf:h.ta||h.readOnly,disabled:g||h.readOnly,$h:g,fa:!a.W.wb||h.ta||h.readOnly?null:function(){var a="b"===h.mode?h.ec:h.jc;0<=a.indexOf(b.name)?a.splice(a.indexOf(b.name),1):a.push(b.name);return 1},ac:a.W.wb?null:k});b.fb&&(a.Ha=function(a){a=a.clone();a.data=new B(b,null,null);return a})}
function Cd(a,c,b){var d=[],e=0;d=a.X.map(function(c,f){var g=a.error&&a.error.i&&(0===a.error.l.length||0<=a.error.l.indexOf(f))?a.error.Wb?b.Xd:b.Wd:b.Oa;g.width=null==c?L(1===d.length?b.If:b.Hf):L(Dd(c,0===f,b));e+=L(g);return b.Oa.width});if(0===a.X.length||!c&&null!==a.X[a.X.length-1])b.Oa.width=L(0===a.X.length?b.If:b.Hf),d.push(b.Oa.width),e+=L(b.Oa);c=L(b.Xb);var f=[],g=0;f=a.actions.map(function(c,d){var e=a.error&&!a.error.i&&(0===a.error.b.length||0<=a.error.b.indexOf(d))?a.error.Wb?b.Xd:
b.Wd:b.Oa;e.width=null==c?L(1===f.length?b.Gf:b.Ff):L(Dd(c,0===d,b));g+=L(e);return L(e)});if(0===a.actions.length||null!==a.actions[a.actions.length-1])b.Oa.width=L(0===a.actions.length?b.Gf:b.Ff),f.push(b.Oa.width),g+=L(b.Oa);return{total:e+c+g,X:d,Pg:e,Ji:c,actions:f,li:g}}function Dd(a,c,b){switch(a.T.type){case "e":return c?b.Yc:b.Lc;case "a":return b.gd;case "s":return b.Xh;case "c":return b.Uh;default:throw"internal";}}
function Ed(a,c){switch(a.verticalAlign){case "middle":return(c.height-a.ra())/2;case "bottom":return c.height-a.ra();case "top":return 0;default:return c.height-a.ra()-a.verticalAlign}}function Sc(a,c){var b=a.aa,d=a.j.j[c];gc(a,{mh:d.ke,display:function(){b.qa&&b.qa()},finish:function(c){null!==c&&(d.ke=c);a.Da=null;b.qa&&b.qa()},Rc:d})}
function Fd(a,c,b,d,e,f,g,k,l,h){var q=b instanceof Qa,p=g,t=Cd(b,e,h),u=a.j,w=q?a.Da&&a.Da.Rc===b?h.Hg:h.Xe:h.xb,m=0<b.X.length&&"e"===b.X[0].T.type?h.Yc:h.Lc,n=new ud(b,w.width+w.paddingLeft+w.paddingRight,Gd(w),p-w.paddingLeft-h.Oa.offsetLeft()-m.offsetLeft(),l-w.paddingTop-h.Oa.offsetTop()-m.offsetTop(),function(c,e,l,m){var p=c.N;Zc(w,p,e.x+l,e.y+m,!0);if(q){p.save();p.fillStyle=w.color;p.font=bd(w);p.textAlign="left";p.textBaseline="middle";if(a.Da&&a.Da.Rc===b){var n=p.measureText(a.Da.v.slice(0,
a.Da.b)),R=n.fontBoundingBoxAscent||0,S=n.fontBoundingBoxDescent||0;if(0===R||0===S)S=R=w.fontSize/2;var u={top:e.y+m+w.paddingTop+w.height/2-R,bottom:e.y+m+w.paddingTop+w.height/2+S,left:e.x+l+w.paddingLeft,right:e.x+l+w.paddingLeft+p.measureText(a.Da.v).width},E=a.Da.v.split("").map(function(c,b){return p.measureText(a.Da.v.slice(0,b+1)).width});cd(a.Da,u,E);a.Da.i===a.Da.b?(p.strokeStyle="black",p.beginPath(),p.moveTo(u.left+n.width,u.top),p.lineTo(u.left+n.width,u.bottom),p.stroke()):(E=p.measureText(a.Da.v.slice(a.Da.b,
a.Da.i)),p.save(),p.fillStyle="silver",p.fillRect(u.left+n.width-1,u.top,E.width,R+S),p.restore());p.fillText(a.Da.v,u.left,e.y+m+w.paddingTop+w.height/2)}else p.fillText(b.ke,e.x+l+w.paddingLeft,e.y+m+w.paddingTop+w.height/2);p.restore();a.R.i===I&&a.R.b===d&&wd(c,e.x+l,e.y+m,e.width,e.height,["rule","comment","kbd-selected"]);a.R.Ra===I&&a.R.Ab===d&&wd(c,e.x+l,e.y+m,e.width,e.height,["rule","comment","kbd-target"])}else{Zc(h.Xb,p,k-h.Xb.width-h.Xb.marginRight-h.Xb.paddingRight-h.Oa.offsetLeft()-
h.gd.offsetLeft()+l,e.y+(Gd(w)-h.Xb.height)/2+m);Hd(c,"vpl:then",k-L(h.Xb)/2-h.Oa.offsetLeft()-h.gd.offsetLeft()+l,e.y+Gd(w)/2+m,h.Xb);b.locked&&vd(c,e.x,e.y,e.width,e.height,!1,b.disabled?"#ddd":"");a.ca===d?wd(c,e.x+l,e.y+m,e.width,e.height,["rule","executing"]):a.R.i===I&&a.R.b===d&&wd(c,e.x+l,e.y+m,e.width,e.height,["rule","kbd-selected"]);a.R.Ra===I&&a.R.Ab===d&&wd(c,e.x+l,e.y+m,e.width,e.height,["rule","kbd-target"]);var C=e.x+l+w.paddingLeft;0<f&&(C+=f-t.Pg);r.forEach(function(a,c){var d=b.error&&
b.error.i&&(0===b.error.l.length||0<=b.error.l.indexOf(c))?b.error.Wb?h.Xd:h.Wd:h.Oa;d.width=null==a?L(1===r.length?h.If:h.Hf):L(Dd(a,0===c,h));Zc(d,p,C+d.marginLeft,e.y+m+w.paddingTop+h.Oa.marginTop,!0);C+=L(d)});C=e.x+l+w.paddingLeft+k-g;v.forEach(function(a,c){var d=b.error&&!b.error.i&&(0===b.error.b.length||0<=b.error.b.indexOf(c))?b.error.Wb?h.Xd:h.Wd:h.Oa;d.width=null==a?L(1===v.length?h.Gf:h.Ff):L(Dd(a,0===c,h));Zc(d,p,C+d.marginLeft,e.y+m+w.paddingTop+h.Oa.marginTop,!0);C+=L(d)})}},q?{dd:function(){Sc(a,
d)}}:null,function(a,b){if(b.data instanceof Ja){a=u.j.indexOf(a.data);var d=u.j.indexOf(b.data);0<=a&&0<=d&&(u.yb(),u.j.splice(d,1),u.j.splice(a,0,b.data),mb(u))}else b.data instanceof B&&(u.yb(),a.data.Yb(b.data,null,function(){u.yb()},function(){mb(u)}),mb(u));c.qa&&c.qa()},function(a,c){return c.data instanceof Ja?c.data!==a.data:!q&&c.data.Gb!==a.data&&("a"===u.mode||0===a.data.X.length||c.data instanceof B&&"a"===c.data.T.type)});b.disabled&&(n.u=function(a,b,d,e){ad(c,b.x+d,b.y+e,b.width,b.height,
["rule"],["rule"])});if(a.j.ta||a.j.readOnly)n.l=!1;a.W.i&&(n.l=!1,n.b={fa:function(c){a.R.Ra=I;a.R.Ab=d;J(c);return 0},Qa:function(c,b,d,e,f,g,k,h){d=c.b.getBoundingClientRect();b=h.x-d.left;h=h.y-d.top;h=b>=n.x&&b<n.x+n.width&&h>=n.y&&h<n.y+n.height;a.R.Ra!==(h?I:zd)&&(a.R.Ra=h?I:zd,J(c))}});Ad(c,n);if(!q){var E,r=b.X;if(0===r.length||!e&&null!==r[r.length-1])r=r.concat(null);p=g;0<f&&(p+=f-t.Pg);r.forEach(function(a,e){var f=a?Dd(a,0===e,h):1===r.length?h.If:h.Hf,g=b.error&&b.error.i&&(0===b.error.l.length||
0<=b.error.l.indexOf(e))?b.error.Wb?h.Xd:h.Wd:h.Oa,k=Ed(f,g);a?(a.marks={tf:this.R.i===Id&&this.R.b===d&&this.R.u===e,Se:this.R.i===Jd&&this.R.b===d&&this.R.u===e?this.R.H:null,uf:this.R.Ra===Id&&this.R.Ab===d&&this.R.w===e},g.width=L(f),E=td(this,c,a,f,["block"],p,l+k,{bg:b.disabled||this.j.ta||this.j.readOnly,$f:b.disabled||this.j.ta||this.j.readOnly,xf:this.j.ta||this.j.readOnly,ac:{type:Id,Ed:d,Fd:e}})):(a=new Fa("e",b,{kd:!0,index:e}),a.marks={tf:this.R.i===Id&&this.R.b===d&&this.R.u===e,Se:null,
uf:this.R.Ra===Id&&this.R.Ab===d&&this.R.w===e},g.width=L(f),E=td(this,c,a,f,["block"],p,l+k,{ag:b.disabled||this.j.readOnly,$f:!0,xf:!0,ac:{type:Id,Ed:d,Fd:e}}));n.ma.push(E);p+=L(g)},a);var v=b.actions;if(0===v.length||null!==v[v.length-1])v=v.concat(null);p=k;v.forEach(function(a,e){var f=a?Dd(a,0==e,h):1===v.length?h.Gf:h.Ff,g=b.error&&!b.error.i&&(0===b.error.b.length||0<=b.error.b.indexOf(e))?b.error.Wb?h.Xd:h.Wd:h.Oa,k=Ed(f,g);a?(a.marks={tf:this.R.i===Kd&&this.R.b===d&&this.R.u===e,Se:this.R.i===
Ld&&this.R.b===d&&this.R.u===e?this.R.H:null,uf:this.R.Ra===Kd&&this.R.Ab===d&&this.R.w===e},g.width=L(f),E=td(this,c,a,Dd(a,0===e,h),["block"],p,l+k,{bg:b.disabled||this.j.ta||this.j.readOnly,$f:b.disabled||this.j.ta||this.j.readOnly,xf:this.j.ta||this.j.readOnly,ac:{type:Kd,Ed:d,Fd:e}})):(a=new Fa("a",b,{kd:!1,index:e}),a.marks={tf:this.R.i===Kd&&this.R.b===d&&this.R.u===e,Se:null,uf:this.R.Ra===Kd&&this.R.Ab===d&&this.R.w===e},g.width=L(f),E=td(this,c,a,f,["block"],p,l,{ag:u.readOnly,$f:!0,xf:!0,
ac:{type:Kd,Ed:d,Fd:e}}));n.ma.push(E);p+=L(g)},a);Yc(c,function(){if(null!==b.error){var a=b.error.Wb?h.Oh:h.Rf;Hd(c,b.error.Wb?"vpl:warning":"vpl:error",g-w.paddingLeft-w.marginLeft-h.Oa.offsetLeft()-m.offsetLeft()-a.width/2-a.marginRight-a.paddingRight,l+.5*m.height,a)}})}}
function Md(a,c,b,d,e,f){var g=f?e.Oh:e.Rf;Yc(a,function(k){var l=Nd(a.ia,{tag:"conflict-line",ga:[f?"warning":"error"]}),h=c-e.xb.paddingLeft-e.xb.marginLeft-e.Oa.offsetLeft()-e.Yc.offsetLeft()-g.width/2-g.marginRight-g.paddingRight,q=b+(e.Oa.height+g.height)/2,p=d+(e.Oa.height-g.height)/2;k.beginPath();k.moveTo(h,q);k.lineTo(h,p);l.stroke(k);k.beginPath();k.arc(h,q,l.lineWidth,0,Math.PI);l.stroke(k);k.beginPath();k.arc(h,p,l.lineWidth,-Math.PI,0);l.stroke(k)})}
function vc(a,c){var b={};a=window.matchMedia&&window.matchMedia("(pointer: coarse)").matches?a.j.S:a.j.ma;b.D=N(c,{tag:"view",ga:["vpl"]});b.Og=N(c,{tag:"separator",ga:["vpl","top"]});b.Ng=N(c,{tag:"separator",ga:["vpl","bottom"]});b.Gc=N(c,{tag:"toolbar",ga:["vpl","top"]});b.Od=N(c,{tag:"toolbar",ga:["vpl","bottom"]});b.wa=N(c,{tag:"vpl",id:"scrolling-vpl"});b.Yc=N(c,{tag:"block",ga:["event","event-main"],mb:a?["small"]:[]});b.Lc=N(c,{tag:"block",ga:["event","event-aux"],mb:a?["small"]:[]});b.gd=
N(c,{tag:"block",ga:["action"],mb:a?["small"]:[]});b.Xh=N(c,{tag:"block",ga:["state"],mb:a?["small"]:[]});b.Uh=N(c,{tag:"block",ga:["comment"],mb:a?["small"]:[]});b.oi=N(c,{tag:"block",ga:["event","empty"],mb:a?["small"]:[]});b.Ff=N(c,{tag:"block",ga:["action","empty"],mb:a?["small"]:[]});b.If=N(c,{tag:"block",ga:["event","empty"],mb:a?["only-child","small"]:["only-child"]});b.Hf=N(c,{tag:"block",ga:["event","event-aux","empty"],mb:a?["small"]:[]});b.Gf=N(c,{tag:"block",ga:["action","empty"],mb:a?
["only-child","small"]:["only-child"]});b.Oa=N(c,{tag:"block-container"});b.Wd=N(c,{tag:"block-container",ga:["error"]});b.Xd=N(c,{tag:"block-container",ga:["warning"]});b.xb=N(c,{tag:"rule",mb:a?["small"]:[]});b.Xb=N(c,{tag:"widget",id:"widget-then",mb:a?["small"]:[]});b.Xe=N(c,{tag:"rule",ga:["comment"],mb:a?["small"]:[]});b.Hg=N(c,{tag:"rule",ga:["comment"],mb:a?["small","edited"]:["edited"]});b.kf=N(c,{tag:"block",ga:["library","event"]});b.Je=N(c,{tag:"block",ga:["library","action"]});b.Yh=N(c,
{tag:"block",ga:["library","state"]});b.Vh=N(c,{tag:"block",ga:["library","comment"]});b.$a=N(c,{tag:"block-library",ga:["event"]});b.bb=N(c,{tag:"block-library",ga:["action"]});b.Rf=N(c,{tag:"widget",id:"widget-error",mb:a?["small"]:[]});b.Oh=N(c,{tag:"widget",id:"widget-warning",mb:a?["small"]:[]});return b}
function Kc(a){var c=a.W,b=a.j,d=b.Bc(b.Bb);a.Pb="";a.yd=!1;if(!c.wb)for(c=0;c<b.j.length;c++)if(b.j[c].error)if(b.j[c].error.Wb)a.Pb||(a.Pb=b.j[c].error.w,a.yd=!0);else{a.Pb=b.j[c].error.w;a.yd=!1;break}b=""!==a.Pb&&!a.yd;if(!b)try{var e=a.Ga[a.la].Ma.check(d,a.j.Bb,function(){H(a)});e&&(a.Pb=e,b=!0)}catch(f){}}function xc(a,c,b,d,e,f){var g=new Uc(a.aa);ld(g,a,c,b,a.j.he||sc,a.j.bf||gd);Wc(g,d,f,e);return g}
function Od(a,c,b){for(var d=0;d<G.length;d++){var e=G[d];if((c?"a"===e.type||"c"===e.type:"e"===e.type||"s"===e.type)&&0<=("b"===a.j.mode?a.j.ec:a.j.jc).indexOf(e.name)){if(0===b)return e;b--}}return null}
function H(a){function c(a,c){switch(c.type){case "e":return a.kf;case "a":return a.Je;case "s":return a.Yh;case "c":return a.Vh;default:throw"internal";}}var b=a.W,d=a.aa,e=a.j,f=vc(a,d.ia);Pd(d);Kc(a);e.ma=d.A.m<d.A.ph;e.S=d.A.m<d.A.qh;var g=Qd(d),k=d.state.ni,l=md(a,a.yc),h=kb(e),q=0,p=0,t=0,u=0;e.j.forEach(function(a){a instanceof Qa?u++:t++;a=Cd(a,h,f);q=Math.max(q,a.Pg);p=Math.max(p,a.li)});var w=0,m=0;G.forEach(function(a){if(b.wb||0<=("b"===e.mode?e.ec:e.jc).indexOf(a.name))switch(a.type){case "e":case "s":w++;
break;case "a":case "c":m++}},a);a.R.ma=w;a.R.Ha=m;Rd(d,function(c,b,d){if(a.I.gb("vpl:trashcan",b)){c=S-f.xb.offsetLeft()-f.Oa.offsetLeft()-f.Yc.offsetLeft();var e=L(f.xb);if(d<c||d>c+e)return a.I.pb("vpl:trashcan",b),!0}return!1});var n=wc(a,a.Jc,["vpl","top"],null,function(c){switch(c){case "vpl:filename":if(null!=a.Da&&a.Da.Rc===a.j)return["edited"]}return[]}),E=nd(n),r=wc(a,a.yc,["vpl","bottom"]),v=nd(r);f.D.Tc(g.width);f.D.Dc(g.height);f.D.setPosition(0,0);f.Gc.Tc(f.D.width);f.Gc.height=E;f.Gc.setPosition(f.D.x,
f.D.y);f.$a.Dc(f.D.height-f.Gc.ra());var C=Math.max(Math.floor(f.$a.height/f.kf.ra()),1);E=f.$a.scroll?1:Math.ceil(w/C);f.$a.width=E*L(f.kf);f.$a.setPosition(f.D.x,f.D.y+f.Gc.ra());f.bb.Dc(f.D.height-f.Gc.ra());var R=f.bb.scroll?1:Math.ceil(m/C);f.bb.width=R*L(f.Je);f.bb.setPosition(f.D.x+f.D.width-L(f.bb),f.D.y+f.Gc.ra());f.Od.Tc(f.D.width-L(f.$a)-L(f.bb));f.Od.height=v;f.Od.setPosition(f.D.x+L(f.$a),f.D.y+f.D.height-f.Od.ra());f.wa.Tc(f.D.width-L(f.$a)-L(f.bb));f.wa.Dc(f.D.height-f.Gc.ra()-(l?f.Od.ra():
0));f.wa.setPosition(f.D.x+L(f.$a),f.D.y+f.Gc.ra());f.Oa.width=f.Wd.width=f.Xd.width=L(f.Yc);f.Oa.height=f.Wd.height=f.Xd.height=f.Yc.ra();v=L(f.Xb);C=q+p+v;var S=f.D.x+(f.D.width-C+L(f.Rf))/2,Ga=S+q+v;f.xb.width=C;f.xb.height=f.Oa.ra();f.Xe.width=C;f.Xe.height=f.Xe.fontSize;f.Hg.width=C;f.Hg.height=f.Xe.fontSize;var qa=[];e.j.forEach(function(a,c){a=a instanceof Qa?f.Xe.ra():f.xb.ra();qa.push(0===c?a:qa[c-1]+a)});d.ob=[];Yc(d,function(a){f.D.J(a)});var za=xc(a,a.Jc,["vpl","top"],f.Gc,f.Og,n);Xc(za,
f.Gc,n,rd(a));if(a.R.i===Sd&&!a.W.wb){v=Td(a.R);var ma=null;for(C=0;C<za.controls.length;C++)if(za.controls[C].id===v.name){ma=za.controls[C];break}var P=n[ma.id];Yc(d,function(){wd(d,ma.x,ma.y,P.width,P.height,["button","top","kbd-selected"])})}if(0<l&&(l=xc(a,a.yc,["vpl","bottom"],f.Od,f.Ng,r),Xc(l,f.Od,r,rd(a)),a.R.i===Ud&&!a.W.wb)){v=Td(a.R);ma=null;for(C=0;C<l.controls.length;C++)if(l.controls[C].id===v.name){ma=l.controls[C];break}P=r[ma.id];Yc(d,function(){wd(d,ma.x,ma.y,P.width,P.height,["button",
"bottom","kbd-selected"])})}var Q=f.kf.ra(),Aa=f.Je.ra(),Oa=0,z=0;if(f.$a.scroll){a.R.S=1;Oa=L(f.kf);k.i.Dc(w*Q);f.$a.width=Oa;f.$a.height=f.$a.height;k.i.resize(f.$a.x,f.$a.y,f.$a.width,f.$a.height);Yc(d,function(a){f.$a.J(a)});k.i.je(d);var T=0;G.forEach(function(g){if(("e"===g.type||"s"===g.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.jc).indexOf(g.name))){var k=c(f,g),h=f.$a.x+k.offsetLeft(),l=f.$a.y+k.offsetTop()+T*Q;Bd(this,d,g,k,h,l,a.R.i===Vd&&a.R.b===T,{type:cc,Ed:0,Fd:0,click:function(){Wd(a.R,
g)}});T++}},a);k.i.end();Yc(d,function(){var a=N(d.ia,{tag:"widget",id:"widget-moreHigh"}),c=N(d.ia,{tag:"widget",id:"widget-moreLow"});Xd(k.i)||Hd(d,"vpl:moreHigh",f.$a.x+f.$a.width/2,f.$a.y+a.ra()/2,a);Yd(k.i)||Hd(d,"vpl:moreLow",f.$a.x+f.$a.width/2,f.$a.y+f.$a.height-c.ra()/2,c)})}else{Yc(d,function(a){f.$a.J(a)});Oa=E*Q+Zd(f.$a);var M=Math.ceil(w/E);a.R.S=M;T=0;G.forEach(function(g){if(("e"===g.type||"s"===g.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.jc).indexOf(g.name))){var k=c(f,g),h=f.$a.x+k.offsetLeft()+
Math.floor(T/M)*Q,l=f.$a.y+k.offsetTop()+T%M*Q;Bd(a,d,g,k,h,l,a.R.i===Vd&&a.R.b===T%M&&a.R.u===Math.floor(T/M),{type:cc,Ed:0,Fd:0,click:function(){Wd(a.R,g)}});T++}},a)}f.bb.scroll?(a.R.ca=1,z=L(f.Je),k.l.Dc(m*Aa),f.bb.width=z,f.bb.height=f.bb.height,k.l.resize(f.bb.x,f.bb.y,f.bb.width,f.bb.height),Yc(d,function(a){f.bb.J(a)}),k.l.je(d),T=0,G.forEach(function(g){if(("a"===g.type||"c"===g.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.jc).indexOf(g.name))){var k=c(f,g);Bd(this,d,g,k,f.bb.x+f.Je.offsetLeft(),
f.bb.y+f.Je.offsetTop()+T*Aa,a.R.i===$d&&a.R.b===T,{type:cc,Ed:0,Fd:0,click:function(){Wd(a.R,g)}});T++}},a),k.l.end(),Yc(d,function(){var a=N(d.ia,{tag:"widget",id:"widget-moreHigh"}),c=N(d.ia,{tag:"widget",id:"widget-moreLow"});Xd(k.l)||Hd(d,"vpl:moreHigh",f.bb.x+f.bb.width/2,f.bb.y+a.ra()/2,a);Yd(k.l)||Hd(d,"vpl:moreLow",f.bb.x+f.bb.width/2,f.bb.y+f.bb.height-c.ra()/2,c)})):(Yc(d,function(a){f.bb.J(a)}),z=R*Aa+Zd(f.bb),M=Math.ceil(m/R),a.R.ca=M,T=0,G.forEach(function(g){if(("a"===g.type||"c"===
g.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.jc).indexOf(g.name))){var k=c(f,g),h=f.bb.x+k.offsetLeft()+f.bb.width-(R-Math.floor(T/M))*Aa,l=f.bb.y+k.offsetTop()+T%M*Aa;Bd(a,d,g,k,h,l,a.R.i===$d&&a.R.b===T%M&&a.R.u===Math.floor(T/M),{type:cc,Ed:0,Fd:0,click:function(){Wd(a.R,g)}});T++}},a));if(b.wb){(function(){var c=f.Oa.sb();c.width=L(f.Yc);var b=f.Oa.sb();b.width=L(f.Lc);var e=f.Oa.sb();e.width=L(f.gd);var g=L(c)+L(b)+L(f.Xb)+L(e),k=f.xb.sb();k.width=g;var h=f.D.x+(f.D.width-g)/2+(Oa-z)/2-d.A.vd/2,l=
h+g-L(e);g=f.wa.y+k.offsetTop()+c.offsetTop();var m=!1;g=new ud(a,k.width+k.paddingLeft+k.paddingRight,Gd(k),h-k.paddingLeft-c.offsetLeft(),g-k.paddingTop-c.offsetTop(),function(d,g,q,p){var n=d.N;Zc(k,n,g.x+q,g.y+p,!0);Zc(f.Xb,n,l-f.Xb.width-f.Xb.marginRight-f.Xb.paddingRight-f.Oa.offsetLeft()-f.gd.offsetLeft()+q,g.y+(Gd(f.xb)-f.Xb.height)/2+p);Hd(d,"vpl:then",l-L(f.Xb)/2-f.Oa.offsetLeft()-f.gd.offsetLeft()+q,g.y+Gd(f.xb)/2+p,f.Xb);var r=g.x+q+k.paddingLeft;Zc(c,n,r+c.marginLeft,g.y+p+k.paddingTop+
c.marginTop,!0);Zc(f.Yc,n,r+c.offsetLeft()+f.Yc.marginLeft,g.y+p+k.paddingTop+c.offsetTop()+f.Yc.marginTop+Ed(f.Yc,c),!0);r+=L(c);Zc(b,n,r+b.marginLeft,g.y+p+k.paddingTop+b.marginTop,!0);Zc(f.Lc,n,r+c.offsetLeft()+f.Lc.marginLeft,g.y+p+k.paddingTop+b.offsetTop()+f.Lc.marginTop+Ed(f.Lc,b),!0);!("a"===a.j.mode?a.j.i:a.j.b)^m&&ad(d,r+c.offsetLeft()+f.Lc.marginLeft,g.y+p+k.paddingTop+b.offsetTop()+f.Lc.marginTop+Ed(f.Lc,b),f.Lc.width,f.Lc.height,["block"],["block"],!1);r=g.x+q+f.xb.paddingLeft+l-h;Zc(e,
n,r+e.marginLeft,g.y+p+k.paddingTop+e.marginTop,!0);Zc(f.gd,n,r+e.offsetLeft()+f.gd.marginLeft,g.y+p+k.paddingTop+e.offsetTop()+f.gd.marginTop+Ed(f.gd,e),!0)},{fa:function(a){m=!0;J(a);return 0},Qa:function(a,c,b,d,e,f,g,k){b=a.b.getBoundingClientRect();c=k.x-b.left;k=k.y-b.top;m=c>=f&&c<f+d&&k>=g&&k<g+e;J(a)},dd:function(c){m&&("a"===a.j.mode?a.j.i=!a.j.i:a.j.b=!a.j.b);J(c)}},null,null);g.l=!1;Ad(d,g)})();var K=N(d.ia,{tag:"widget",id:"vpl-customize"});K.width=f.wa.width/2;K.height=(f.wa.height-
f.xb.ra())/2;Yc(d,function(){Hd(d,"vpl:customize",f.wa.x+f.wa.width/2,f.wa.y+(f.wa.height+f.xb.ra())/2,K)})}else if(e.message)Yc(d,function(a){var c=e.message.split("\n"),b=Math.min(14,g.height/c.length);a.font=b+"px sans-serif";a.textAlign="start";a.textBaseline="top";var d=f.wa.x+b,k=f.wa.y+b;c.forEach(function(c,e){a.fillText(c,d,k+1.2*b*e)})});else{r=L(f.xb)+f.wa.paddingLeft+f.wa.paddingRight+L(f.Rf);k.b.Tc(r);k.b.Dc(qa[qa.length-1]);switch(a.R.i){case I:case Id:case Kd:case Jd:case Ld:ae(k.b,
0<a.R.b?qa[a.R.b-1]:0,qa[a.R.b])}k.b.resize(f.wa.x,f.wa.y,f.wa.width,f.wa.height);Yc(d,function(a){f.wa.J(a)});k.b.je(d);S+=(Oa-z)/2-d.A.vd/2;Ga+=(Oa-z)/2-d.A.vd/2;r>f.wa.width&&(S+=(r-f.wa.width)/2+f.wa.paddingLeft+f.wa.marginLeft,Ga+=(r-f.wa.width)/2+f.wa.paddingLeft+f.wa.marginLeft);var Ma="";e.j.forEach(function(a,c){(0<c?qa[c-1]:0)<f.wa.height+k.b.b&&qa[c]>k.b.b&&Fd(this,d,a,c,h,d.A.jh?q:0,S,Ga,f.wa.y+(0<c?qa[c-1]:0)+f.xb.offsetTop()+f.Oa.offsetTop(),f);if(null!==a.error&&""===Ma&&(Ma=a.error.w,
null!==a.error.u))for(var b=c+1;b<e.j.length;b++)if(e.j[b]===a.error.u){Md(d,S,f.wa.y+f.xb.ra()*c+f.xb.offsetTop()+f.Oa.offsetTop(),f.wa.y+f.xb.ra()*b+f.xb.offsetTop()+f.Oa.offsetTop(),f,a.error.Wb);break}},a);k.b.end();if(!Xd(k.b)){var ta=N(d.ia,{tag:"widget",id:"widget-moreHigh"});r=new ud(null,L(ta),ta.ra(),f.wa.x+f.wa.width-L(ta),f.wa.y+ta.ra()-ta.ra(),function(a){Hd(a,"vpl:moreHigh",f.wa.x+f.wa.width-L(ta)/2,f.wa.y+ta.ra()/2,ta)},{dd:function(){var a=k.b,c=-f.xb.ra();a.u+=0;a.b+=c;J(d)}},null,
null,"scrollUp");Ad(d,r)}if(!Yd(k.b)){var oa=N(d.ia,{tag:"widget",id:"widget-moreLow"});r=new ud(null,L(oa),oa.ra(),f.wa.x+f.wa.width-L(oa),f.wa.y+f.wa.height-oa.ra(),function(a){Hd(a,"vpl:moreLow",f.wa.x+f.wa.width-L(oa)/2,f.wa.y+f.wa.height-oa.ra()/2,oa)},{dd:function(){var a=k.b,c=f.xb.ra();a.u+=0;a.b+=c;J(d)}},null,null,"scrollDown");Ad(d,r)}e.ta&&Yc(d,function(){ad(d,f.wa.x,f.wa.y,f.wa.width,f.wa.height,["vpl"],["vpl"])})}a.u&&Yc(d,function(c){var b=N(d.ia,{tag:"hint"});c.fillStyle=b.color;c.font=
bd(b);c.textAlign="start";c.textBaseline="middle";var e=a.i.translate(a.u);if(a.W.i){var f=a.i.translate(a.u+";nodrag");";nodrag"!==f.slice(-7)&&(e=f)}b.width=c.measureText(e).width;b.height=1.2*b.fontSize;Zc(b,c,b.marginLeft,g.height-b.ra()+b.marginTop,!0);c.fillText(e,b.offsetLeft(),g.height-b.ra()+b.offsetTop()+b.height/2)});e.qa&&e.qa();J(d)}function be(a,c){a.ca=c;H(a);window.setTimeout(function(){a.ca===c&&(a.ca=-1,H(a))},500)};function ce(){this.S={};this.i=[];this.Ha={px:1,cm:96/2.54,mm:96/25.4,"in":96,pc:16,pt:96/72};this.ca={rad:1,deg:Math.PI/180,grad:Math.PI/200,turn:2*Math.PI};this.b=null}ce.prototype.H=function(){this.S={};this.i=[]};
function de(a,c,b){function d(){return c+" line "+q+" col "+p}function e(){for(;h<b.length;)if(" "===b[h]||"\t"===b[h])h++,p++;else if("\n"===b[h])h++,p=1,q++;else if("\r"===b[h])h++;else if("/*"===b.slice(h,h+2))for(h+=2,p+=2;h<b.length;)if("*/"===b.slice(h,h+2)){h+=2;p+=2;break}else h++,p++;else break}function f(){"\n"===b[h]?(p=1,q++):"\r"!==b[h]&&p++;h++}function g(){for(var a=0;h+a<b.length&&/[-_a-z0-9]/i.test(b[h+a]);)a++;h+=a;p+=a;return b.slice(h-a,h)}function k(){var a=new ee;if(!/[a-z_.#*:]/i.test(b[h]))throw"Syntax error "+
d();for(/[a-z_]/i.test(b[h])?a.tag=g():"*"===b[h]&&f();;)if("#"===b[h]){if(a.id)throw"Multiple ids in selector "+d();f();a.id=g()}else if("."===b[h])f(),a.ga.push(g());else if(":"===b[h])f(),a.mb.push(g());else break;return a}function l(){for(var a=0,c=!1;h+a<b.length&&(c||";"!==b[h+a]&&"}"!==b[h+a]);)"\n"===b[h]?(q++,p=1):"\r"!==b[h]?p++:'"'===b[h]&&(c=!c),a++;h+=a;return b.slice(h-a,h).trim()}a.S[c]=b;for(var h=0,q=1,p=1;h<b.length;){e();if(h>=b.length)break;for(var t=[];;){t.push(k());e();if(","!==
b[h])break;h++;p++;e()}if("{"!==b[h])throw"Syntax error "+d();h++;p++;for(var u={};;){for(;;){e();if(";"!==b[h])break;h++}if(h>=b.length)throw"Unclosed block "+d();if("}"===b[h]){h++;p++;break}else if(!/[-a-z_]/i.test(b[h]))throw"Syntax error "+d();var w=g();e();if(":"!==b[h])throw"Missing colon "+d();h++;p++;var m=l();u[w]=a.Za(w,m)}for(w=0;w<t.length;w++)a.i.push({fg:t[w],ud:u})}}ce.prototype.Za=function(a,c){return c};
function fe(a,c){if(/^(max|min)\(.*\)$/.test(c))return a=c.slice(4,-1).split(",").map(function(a){return fe(this,a)},a),new ge(c.slice(0,3),a);c=/^(-?([0-9]+\.?|[0-9]*\.[0-9]+))([a-z]*|%)$/.exec(c);var b=1,d=he;if(null==c)throw"Illegal length";if("%"===c[3])d=ie;else if(a.Ha.hasOwnProperty(c[3]))b=a.Ha[c[3]];else if("vw"===c[3])d=je;else if("vh"===c[3])d=ke;else if("vmin"===c[3])d=le;else if("vmax"===c[3])d=me;else if("ww"===c[3])d=ne;else if("wh"===c[3])d=oe;else if("wmin"===c[3])d=pe;else if("wmax"===
c[3])d=qe;else if(0==parseFloat(c[1]))b=0;else throw"Unknown length unit";return new re(parseFloat(c[1])*b,d)}
var se={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",
darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",
ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",
lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",
moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",
seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32",transparent:"rgba(0,0,0,0)"};function re(a,c){this.Z=a;this.type=c?c:he}
var he="abs",ie="%",je="vw",ke="vh",le="vmin",me="vmax",ne="ww",oe="wh",pe="wmin",qe="wmax";
re.prototype.V=function(a){switch(this.type){case he:return this.Z;case ie:return this.Z*(a?a.w/100:1);case je:return this.Z*(a?a.i:1);case ke:return this.Z*(a?a.b:1);case le:return this.Z*(a?Math.min(a.i,a.b):1);case me:return this.Z*(a?Math.max(a.i,a.b):1);case ne:return this.Z*(a?a.u:1);case oe:return this.Z*(a?a.l:1);case pe:return this.Z*(a?Math.min(a.u,a.l):1);case qe:return this.Z*(a?Math.max(a.u,a.l):1);default:throw"internal";}};function ge(a,c){re.call(this,0);this.Fa=a;this.values=c}
ge.prototype=Object.create(re.prototype);ge.prototype.constructor=ge;ge.prototype.V=function(a){switch(this.Fa){case "max":return this.values.reduce(function(c,b){return Math.max(c,b.V(a))},-Infinity);case "min":return this.values.reduce(function(c,b){return Math.min(c,b.V(a))},Infinity);default:throw"internal";}};function te(a,c,b,d,e){this.w=a;this.i=c;this.b=b;this.u=d;this.l=e}function ee(){this.id=this.tag=null;this.ga=[];this.mb=[]}
function ue(a,c){a=(a.id?"#"+a.id:a.tag||"")+(a.ga&&0<a.ga.length?"."+a.ga.join("."):"")+(a.mb&&0<a.mb.length?":"+a.mb.join("."):"")||"*";c&&(a+="/"+Math.round(c.w).toString(10)+","+Math.round(c.i).toString(10)+","+Math.round(c.b).toString(10)+","+Math.round(c.u).toString(10)+","+Math.round(c.l).toString(10));return a}
ee.prototype.match=function(a){if(a.tag&&this.tag&&a.tag!==this.tag||this.id&&this.id!==a.id)return!1;for(var c=0;c<this.ga.length;c++)if(void 0==a.ga||0>a.ga.indexOf(this.ga[c]))return!1;for(c=0;c<this.mb.length;c++)if(void 0==a.mb||0>a.mb.indexOf(this.mb[c]))return!1;return!0};function Wb(){ce.call(this);this.l=[];this.u={};this.w={};this.ma="none hidden dotted dashed solid double".split(" ");this.rb=["normal","italic","oblique"];this.Jb=["normal","bold"]}Wb.prototype=Object.create(ce.prototype);Wb.prototype.constructor=Wb;Wb.prototype.H=function(){ce.prototype.H.call(this);this.u={};this.w={}};
Wb.prototype.defineProperties=function(){for(var a=0;a<this.i.length;a++){var c=new ve,b=this.i[a].fg;we(c,this.i[a].ud,(null!=b.id?100:0)+10*(b.ga.length+b.mb.length)+(null!=b.tag?1:0));this.l.push({fg:this.i[a].fg,Eh:c})}};
Wb.prototype.Za=function(a,c){function b(a){try{fe(e,a)}catch(u){return!1}return!0}function d(a){return se.hasOwnProperty(a)||/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(a)||/^rgba\([^()]*\)$/.test(a)}var e=this;c=c.replace(/\s+(?=[^()]*\))/g,"");switch(a){case "margin-left":case "margin-right":case "margin-top":case "margin-bottom":case "padding-left":case "padding-right":case "padding-top":case "padding-bottom":case "border-left-width":case "border-right-width":case "border-top-width":case "border-bottom-width":case "border-corner-length":case "line-width":case "width":case "height":case "min-width":case "min-height":case "max-width":case "max-height":case "font-size":return fe(this,c);
case "margin":case "padding":case "border-width":switch(a=c.replace(/ +/g," ").split(" ").map(function(a){return fe(e,a)}),a.length){case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];case 4:return a;default:throw"Wrong number of lengths";}case "border-style":case "border-left-style":case "border-right-style":case "border-top-style":case "border-bottom-style":case "line-style":if(!(0<=e.ma.indexOf(c)))throw"Unknown border style";return c;case "line-cap":if(!(0<=
["butt","round","square"].indexOf(c)))throw"Unknown line cap";return c;case "border-color":case "border-left-color":case "border-right-color":case "border-top-color":case "border-bottom-color":case "color":case "background-color":case "background":case "border-cut-background":if(!d(c))throw"Unknown border color";return c;case "border-left":case "border-right":case "border-top":case "border-bottom":case "border":case "line":var f=null,g=null,k=null;c.replace(/ +/g," ").split(" ").forEach(function(a){if(d(a))f=
a;else if(0<=e.ma.indexOf(a))g=a;else if(b(a))k=fe(e,a);else throw"Illegal border property";});return{color:f,style:null===g&&(f||k)?"solid":g,width:null===k&&(f||g)?new re(1):k};case "border-top-left-radius":case "border-top-right-radius":case "border-bottom-right-radius":case "border-bottom-left-radius":case "border-top-left-cut":case "border-top-right-cut":case "border-bottom-left-cut":case "border-bottom-right-cut":switch(a=c.replace(/ +/g," ").split(" ").map(function(a){return fe(e,a)}),a.length){case 1:return[a[0],
a[0]];case 2:return a;default:throw"Wrong number of radii";}case "border-radius":case "border-cut":switch(a=c.split("/").map(function(a){a=a.replace(/ +/g," ").split(" ").map(function(a){return"/"===a?"/":fe(e,a)});switch(a.length){case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];case 4:return a;default:throw"Wrong number of radii";}}),a.length){case 1:return a[0].concat(a[0]);case 2:return a[0].concat(a[1]);default:throw"Wrong number of radius dimensions";
}case "font":var l="",h="",q=null,p="";c.replace(/ +/g," ").split(" ").forEach(function(a){if(null===q)if(b(a))q=fe(e,a);else if(0<=e.rb.indexOf(a))l=a;else if(0<=e.Jb.indexOf(a))h=a;else throw"Unknown font style "+a;else{if(""!==p)throw"Unexpected font style after font-family";p=a}});return{fontFamily:p,fontSize:q,fontStyle:l,fontWeight:h};case "box-shadow":case "line-shadow":return c=c.split(",")[0],a=c.replace(/ +/g," ").split(" "),"inset"===a[0]&&(a=a.slice(1)),3<=a.length&&5>=a.length?{offset:[fe(this,
a[0]),fe(this,a[1])],color:a[a.length-1],Jf:4<=a.length?fe(this,a[2]):null,gg:5<=a.length?fe(this,a[3]):null}:{};case "overflow":if(0>["wrap","scroll"].indexOf(c))throw"Unknown overflow mode";return c;case "vertical-align":return 0<=["top","middle","bottom"].indexOf(c)?c:fe(this,c);default:return c}};
function xe(a,c){for(var b=null,d=0;d<a.l.length;d++)if(a.l[d].fg.match(c)){if(b){var e=void 0;var f=a.l[d].Eh;b=b.sb();for(e in f.ud)f.ud.hasOwnProperty(e)&&(!b.hasOwnProperty(e)||f.b[e]>=b.b[e])&&(b.ud[e]=f.ud[e]);e=b}else e=a.l[d].Eh.sb();b=e}for(var g in b)b.hasOwnProperty(g)&&b[g]instanceof re&&(b[g]=b[g].V(a.b));return b}function N(a,c){var b=ue(c,a.b);if(a.u[b])return a.u[b];c=xe(a,c);c=new pc(c,a.b);return a.u[b]=c}
function Nd(a,c){var b=ue(c,a.b);if(a.w[b])return a.w[b];c=xe(a,c);c=new ye(c,a.b);return a.w[b]=c}function ve(){this.ud={};this.b={}}function we(a,c,b,d){for(var e in c)c.hasOwnProperty(e)&&(a.ud[e]=c[e],a.b[e]=d&&d[e]||b)}ve.prototype.sb=function(){var a=new ve;we(a,this.ud,0,this.b);return a};
function pc(a,c){this.marginBottom=this.marginTop=this.marginRight=this.marginLeft=this.y=this.x=this.height=this.width=0;this.Hb=!0;this.Cc=!1;this.borderBottomWidth=this.borderTopWidth=this.borderRightWidth=this.borderLeftWidth=0;this.borderBottomStyle=this.borderTopStyle=this.borderRightStyle=this.borderLeftStyle="none";this.borderBottomColor=this.borderTopColor=this.borderRightColor=this.borderLeftColor="black";this.borderTopLeftRadius=[0,0];this.borderTopRightRadius=[0,0];this.borderBottomRightRadius=
[0,0];this.borderBottomLeftRadius=[0,0];this.lf=this.Le=this.nf=this.mf=!1;this.paddingBottom=this.paddingTop=this.paddingRight=this.paddingLeft=this.Eb=0;this.backgroundColor=this.gf="transparent";this.color="black";this.fontFamily="sans-serif";this.fontSize=10;this.fontWeight=this.fontStyle="";this.scroll=!1;this.verticalAlign="middle";this.gc=null;this.Ce=this.Jd=0;this.shadowColor=null;this.ze={};a&&ze(this,a.ud,c)}pc.prototype=Object.create(ve.prototype);x=pc.prototype;x.constructor=pc;
function ze(a,c,b){var d=-1,e=-1,f=-1,g=-1,k=1E9,l=1E9,h;for(h in c)switch(h){case "margin-left":a.marginLeft=c[h].V(b);break;case "margin-right":a.marginRight=c[h].V(b);break;case "margin-top":a.marginTop=c[h].V(b);break;case "margin-bottom":a.marginBottom=c[h].V(b);break;case "border-left-width":a.borderLeftWidth=c[h].V(b);a.Hb=!1;break;case "border-right-width":a.borderRightWidth=c[h].V(b);a.Hb=!1;break;case "border-top-width":a.borderTopWidth=c[h].V(b);a.Hb=!1;break;case "border-bottom-width":a.borderBottomWidth=
c[h].V(b);a.Hb=!1;break;case "border-corner-length":a.Eb=c[h].V(b);break;case "padding-left":a.paddingLeft=c[h].V(b);break;case "padding-right":a.paddingRight=c[h].V(b);break;case "padding-top":a.paddingTop=c[h].V(b);break;case "padding-bottom":a.paddingBottom=c[h].V(b);break;case "margin":a.marginTop=c[h][0].V(b);a.marginRight=c[h][1].V(b);a.marginBottom=c[h][2].V(b);a.marginLeft=c[h][3].V(b);break;case "border-width":a.borderTopWidth=c[h][0].V(b);"none"===a.borderTopStyle&&0<a.borderTopWidth&&(a.borderTopStyle=
null);a.borderRightWidth=c[h][1].V(b);"none"===a.borderRightStyle&&0<a.borderRightWidth&&(a.borderRightStyle=null);a.borderBottomWidth=c[h][2].V(b);"none"===a.borderBottomStyle&&0<a.borderBottomWidth&&(a.borderBottomStyle=null);a.borderLeftWidth=c[h][3].V(b);"none"===a.borderLeftStyle&&0<a.borderLeftWidth&&(a.borderLeftStyle=null);break;case "padding":a.paddingTop=c[h][0].V(b);a.paddingRight=c[h][1].V(b);a.paddingBottom=c[h][2].V(b);a.paddingLeft=c[h][3].V(b);break;case "border-style":a.borderLeftStyle=
c[h];a.borderRightStyle=c[h];a.borderTopStyle=c[h];a.borderBottomStyle=c[h];break;case "border-left-style":a.borderLeftStyle=c[h];a.Hb=!1;break;case "border-right-style":a.borderRightStyle=c[h];a.Hb=!1;break;case "border-top-style":a.borderTopStyle=c[h];a.Hb=!1;break;case "border-bottom-style":a.borderBottomStyle=c[h];a.Hb=!1;break;case "border-color":a.borderLeftColor=c[h];a.borderRightColor=c[h];a.borderTopColor=c[h];a.borderBottomColor=c[h];break;case "border-left-color":a.borderLeftColor=c[h];
a.Hb=!1;break;case "border-right-color":a.borderRightColor=c[h];a.Hb=!1;break;case "border-top-color":a.borderTopColor=c[h];a.Hb=!1;break;case "border-bottom-color":a.borderBottomColor=c[h];a.Hb=!1;break;case "border-left":null!==c[h].color&&(a.borderLeftColor=c[h].color);null!==c[h].style&&(a.borderLeftStyle=c[h].style);null!==c[h].width&&(a.borderLeftWidth=c[h].width.V(b));a.Hb=!1;break;case "border-right":null!==c[h].color&&(a.borderRightColor=c[h].color);null!==c[h].style&&(a.borderRightStyle=
c[h].style);null!==c[h].width&&(a.borderRightWidth=c[h].width.V(b));a.Hb=!1;break;case "border-top":null!==c[h].color&&(a.borderTopColor=c[h].color);null!==c[h].style&&(a.borderTopStyle=c[h].style);null!==c[h].width&&(a.borderTopWidth=c[h].width.V(b));a.Hb=!1;break;case "border-bottom":null!==c[h].color&&(a.borderBottomColor=c[h].color);null!==c[h].style&&(a.borderBottomStyle=c[h].style);null!==c[h].width&&(a.borderBottomWidth=c[h].width.V(b));a.Hb=!1;break;case "border":null!==c[h].color&&(a.borderLeftColor=
a.borderRightColor=a.borderTopColor=a.borderBottomColor=c[h].color);null!==c[h].style&&(a.borderLeftStyle=a.borderRightStyle=a.borderTopStyle=a.borderBottomStyle=c[h].style);null!==c[h].width&&(a.borderLeftWidth=a.borderRightWidth=a.borderTopWidth=a.borderBottomWidth=c[h].width.V(b));a.Hb=!0;break;case "border-top-left-radius":a.borderTopLeftRadius=c[h].map(function(a){return a.V(b)});a.Cc=!0;break;case "border-top-right-radius":a.borderTopRightRadius=c[h].map(function(a){return a.V(b)});a.Cc=!0;
break;case "border-bottom-right-radius":a.borderBottomRightRadius=c[h].map(function(a){return a.V(b)});a.Cc=!0;break;case "border-bottom-left-radius":a.borderBottomLeftRadius=c[h].map(function(a){return a.V(b)});a.Cc=!0;break;case "border-radius":a.borderTopLeftRadius=[c[h][0].V(b),c[h][4].V(b)];a.borderTopRightRadius=[c[h][1].V(b),c[h][5].V(b)];a.borderBottomRightRadius=[c[h][2].V(b),c[h][6].V(b)];a.borderBottomLeftRadius=[c[h][3].V(b),c[h][7].V(b)];a.Cc=!0;break;case "border-top-left-cut":a.borderTopLeftRadius=
c[h].map(function(a){return a.V(b)});a.mf=!0;a.Cc=!0;break;case "border-top-right-cut":a.borderTopRightRadius=c[h].map(function(a){return a.V(b)});a.nf=!0;a.Cc=!0;break;case "border-bottom-left-cut":a.Le=c[h].map(function(a){return a.V(b)});a.Le=!0;a.Cc=!0;break;case "border-bottom-right-cut":a.borderBottomRightRadius=c[h].map(function(a){return a.V(b)});a.lf=!0;a.Cc=!0;break;case "border-cut":a.borderTopLeftRadius=[c[h][0].V(b),c[h][4].V(b)];a.borderTopRightRadius=[c[h][1].V(b),c[h][5].V(b)];a.borderBottomRightRadius=
[c[h][2].V(b),c[h][6].V(b)];a.borderBottomLeftRadius=[c[h][3].V(b),c[h][7].V(b)];a.mf=!0;a.nf=!0;a.Le=!0;a.lf=!0;a.Cc=!0;break;case "backdrop-color":a.gf=c[h];break;case "background-color":case "background":a.backgroundColor=c[h];break;case "color":a.color=c[h];break;case "font":a.fontFamily=c[h].fontFamily;a.fontSize=c[h].fontSize.V(b);a.fontStyle=c[h].fontStyle;a.fontWeight=c[h].fontWeight;break;case "font-family":a.fontFamily=c[h];break;case "font-size":a.fontSize=c[h].V(b);break;case "font-style":a.fontStyle=
c[h];break;case "font-weight":a.fontWeight=c[h];break;case "overflow":a.scroll="scroll"===c[h];break;case "vertical-align":a.verticalAlign=c[h]instanceof re?c[h].V(b):c[h];break;case "box-shadow":null!==c[h].gc&&(a.gc=c[h].offset.map(function(a){return a?a.V(b):0}),a.Jd=c[h].Jf?c[h].Jf.V(b):0,a.Ce=c[h].gg?c[h].gg.V(b):0,a.shadowColor=c[h].color);break;case "width":d=c[h].V(b);break;case "min-width":f=c[h].V(b);break;case "max-width":k=c[h].V(b);break;case "height":e=c[h].V(b);break;case "min-height":g=
c[h].V(b);break;case "max-height":l=c[h].V(b);break;default:c.hasOwnProperty(h)&&(a.ze[h]=c[h])}d=Math.max(Math.min(d,k),f);e=Math.max(Math.min(e,l),g);0<=d&&(a.width=d);0<=e&&(a.height=e)}x.setPosition=function(a,c){this.x=a+this.offsetLeft();this.y=c+this.offsetTop()};function L(a){return a.width+Zd(a)}x.ra=function(){return this.height+(this.marginTop+this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth+this.marginBottom)};
x.Tc=function(a){this.width=a-(this.marginLeft+this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth+this.marginRight)};x.Dc=function(a){this.height=a-(this.marginTop+this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth+this.marginBottom)};
x.sb=function(){var a=new pc;a.width=this.width;a.height=this.height;a.x=this.x;a.y=this.y;a.marginLeft=this.marginLeft;a.marginRight=this.marginRight;a.marginTop=this.marginTop;a.marginBottom=this.marginBottom;a.Hb=this.Hb;a.Cc=this.Cc;a.borderLeftWidth=this.borderLeftWidth;a.borderRightWidth=this.borderRightWidth;a.borderTopWidth=this.borderTopWidth;a.borderBottomWidth=this.borderBottomWidth;a.borderLeftStyle=this.borderLeftStyle;a.borderRightStyle=this.borderRightStyle;a.borderTopStyle=this.borderTopStyle;
a.borderBottomStyle=this.borderBottomStyle;a.borderLeftColor=this.borderLeftColor;a.borderRightColor=this.borderRightColor;a.borderTopColor=this.borderTopColor;a.borderBottomColor=this.borderBottomColor;a.borderTopLeftRadius=this.borderTopLeftRadius;a.borderTopRightRadius=this.borderTopRightRadius;a.borderBottomRightRadius=this.borderBottomRightRadius;a.borderBottomLeftRadius=this.borderBottomLeftRadius;a.mf=this.mf;a.nf=this.nf;a.Le=this.Le;a.lf=this.lf;a.Eb=this.Eb;a.paddingLeft=this.paddingLeft;
a.paddingRight=this.paddingRight;a.paddingTop=this.paddingTop;a.paddingBottom=this.paddingBottom;a.gf=this.gf;a.backgroundColor=this.backgroundColor;a.color=this.color;a.fontFamily=this.fontFamily;a.fontSize=this.fontSize;a.fontStyle=this.fontStyle;a.fontWeight=this.fontWeight;a.scroll=this.scroll;a.verticalAlign=this.verticalAlign;a.gc=this.gc;a.Jd=this.Jd;a.Ce=this.Ce;a.shadowColor=this.shadowColor;return a};x.offsetLeft=function(){return this.marginLeft+this.borderLeftWidth+this.paddingLeft};
function Zd(a){return a.marginLeft+a.borderLeftWidth+a.paddingLeft+a.paddingRight+a.borderRightWidth+a.marginRight}x.offsetTop=function(){return this.marginTop+this.borderTopWidth+this.paddingTop};function Gd(a){return a.height+a.paddingTop+a.paddingBottom}function bd(a){return(a.fontStyle?a.fontStyle+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+a.fontSize.toFixed(1)+"px "+a.fontFamily}
function ye(a,c){this.margin=0;this.Ne=this.style=this.width=null;this.color="black";this.gc=null;this.Ce=this.Jd=0;this.shadowColor=null;this.ze={};a&&Ae(this,a.ud,c);null===this.width&&(this.width=null!==this.style&&"none"!==this.style?1:0);null===this.style&&(this.style=0<this.width?"solid":"none");null===this.Ne&&(this.Ne="butt")}ye.prototype=Object.create(ve.prototype);ye.prototype.constructor=ye;
function Ae(a,c,b){for(var d in c)switch(d){case "margin":a.margin=c[d].V(b);break;case "line-width":a.width=c[d].V(b);break;case "line-style":a.style=c[d];break;case "line-cap":a.Ne=c[d];break;case "color":a.color=c[d];break;case "line":null!==c[d].color&&(a.color=c[d].color);null!==c[d].style&&(a.style=c[d].style);null!==c[d].width&&(a.width=c[d].width.V(b));break;case "line-shadow":null!==c[d].gc&&(a.gc=c[d].offset.map(function(a){return a?a.V(b):0}),a.Jd=c[d].Jf?c[d].Jf.V(b):0,a.Ce=c[d].gg?c[d].gg.V(b):
0,a.shadowColor=c[d].color);break;default:c.hasOwnProperty(d)&&(a.ze[d]=c[d])}}ye.prototype.sb=function(){var a=new ye;a.margin=this.margin;a.width=this.width;a.style=this.style;a.Ne=this.Ne;a.color=this.color;a.gc=this.gc;a.Jd=this.Jd;a.Ce=this.Ce;a.shadowColor=this.shadowColor;return a};var Be=!1;function Ce(a,c,b,d){a.strokeStyle=b||"black";switch(d){case "dotted":a.setLineDash([2*c,3*c]);a.lineDashOffset=0;break;case "dashed":a.setLineDash([3*c,3*c]),a.lineDashOffset=0}a.lineWidth=c||0}
function Zc(a,c,b,d,e){function f(){var a=Math.min(g.borderTopLeftRadius[0],k/2),e=Math.min(g.borderTopLeftRadius[1],l/2);c.moveTo(b,d+e);g.mf?c.lineTo(b+a,d):c.bezierCurveTo(b,d+e/2,b+a/2,d,b+a,d);a=Math.min(g.borderTopRightRadius[0],k/2);e=Math.min(g.borderTopRightRadius[1],l/2);c.lineTo(b+k-a,d);g.nf?c.lineTo(b+k,d+e):c.bezierCurveTo(b+k-a/2,d,b+k,d+e/2,b+k,d+e);a=Math.min(g.borderBottomRightRadius[0],k/2);e=Math.min(g.borderBottomRightRadius[1],l/2);c.lineTo(b+k,d+l-e);g.lf?c.lineTo(b+k-a,d+l):
c.bezierCurveTo(b+k,d+l-e/2,b+k-a/2,d+l,b+k-a,d+l);a=Math.min(g.borderBottomLeftRadius[0],k/2);e=Math.min(g.borderBottomLeftRadius[1],l/2);c.lineTo(b+a,d+l);g.Le?c.lineTo(b,d+l-e):c.bezierCurveTo(b+a/2,d+l,b,d+l-e/2,b,d+l-e);c.closePath()}e||(b-=a.paddingLeft,d-=a.paddingTop);var g=a,k=a.width+a.paddingLeft+a.paddingRight,l=a.height+a.paddingTop+a.paddingBottom;Be&&(c.save(),c.strokeStyle="black",c.lineWidth=1,c.strokeRect(b,d,k,l),c.strokeRect(b+a.paddingLeft,d+a.paddingTop,a.width,a.height),c.strokeRect(b-
a.marginLeft,d-a.marginTop,k+a.marginLeft+a.marginRight,l+a.marginTop+a.marginBottom),c.restore());c.save();0<a.Eb&&(c.beginPath(),c.rect(b-a.Eb,d-a.Eb,2*a.Eb,2*a.Eb),c.rect(b+k-a.Eb,d-a.Eb,2*a.Eb,2*a.Eb),c.rect(b-a.Eb,d+l-a.Eb,2*a.Eb,2*a.Eb),c.rect(b+k-a.Eb,d+l-a.Eb,2*a.Eb,2*a.Eb),c.clip());"transparent"!==a.gf&&(c.fillStyle=a.gf,c.fillRect(b,d,k,l));c.beginPath();a.Cc?(c.beginPath(),f()):c.rect(b,d,k,l);c.save();a.gc&&(c.shadowOffsetX=a.gc[0],c.shadowOffsetY=a.gc[1],c.shadowColor=a.shadowColor,
c.shadowBlur=a.Jd);a.backgroundColor?c.fillStyle=a.backgroundColor:a.gc&&(c.fillStyle="transparent");c.fill();c.restore();a.Hb?0<a.borderLeftWidth&&a.borderLeftColor&&"none"!==a.borderLeftStyle&&"hidden"!==a.borderLeftStyle&&(Ce(c,a.borderLeftWidth,a.borderLeftColor,a.borderLeftStyle),"double"===a.borderLeftStyle&&(c.save(),c.translate(b+k/2,d+l/2),c.scale((k-3*a.borderLeftWidth)/k,(l-3*a.borderLeftWidth)/l),c.translate(-b-k/2,-d-l/2),f(),c.restore()),c.stroke()):(0<a.borderLeftWidth&&a.borderLeftColor&&
"none"!==a.borderLeftStyle&&"hidden"!==a.borderLeftStyle&&(Ce(c,a.borderLeftWidth,a.borderLeftColor,a.borderLeftStyle),c.beginPath(),c.moveTo(b,d),c.lineTo(b,d+l),c.stroke()),0<a.borderRightWidth&&a.borderRightColor&&"none"!==a.borderRightStyle&&"hidden"!==a.borderRightStyle&&(Ce(c,a.borderRightWidth,a.borderRightColor,a.borderRightStyle),c.beginPath(),c.moveTo(b+k,d),c.lineTo(b+k,d+l),c.stroke()),0<a.borderTopWidth&&a.borderTopColor&&"none"!==a.borderTopStyle&&"hidden"!==a.borderTopStyle&&(Ce(c,
a.borderTopWidth,a.borderTopColor,a.borderTopStyle),c.beginPath(),c.moveTo(b,d),c.lineTo(b+k,d),c.stroke()),0<a.borderBottomWidth&&a.borderBottomColor&&"none"!==a.borderBottomStyle&&"hidden"!==a.borderBottomStyle&&(Ce(c,a.borderBottomWidth,a.borderBottomColor,a.borderBottomStyle),c.beginPath(),c.moveTo(b,d+l),c.lineTo(b+k,d+l),c.stroke()));c.restore();Be&&a.ze["-vpl-debug"]&&(c.save(),c.font="9px sans-serif",c.textAlign="start",c.textBaseline="top",c.fillStyle="black",c.fillText(a.ze["-vpl-debug"],
b,d),c.restore())}pc.prototype.J=function(a){Zc(this,a,this.x,this.y)};ye.prototype.stroke=function(a){a.save();this.gc&&(a.shadowOffsetX=this.gc[0],a.shadowOffsetY=this.gc[1],a.shadowColor=this.shadowColor,a.shadowBlur=this.Jd);0<this.width&&this.color&&"none"!==this.style&&"hidden"!==this.style&&(Ce(a,this.width,this.color,this.style),a.lineCap=this.Ne,a.stroke());a.restore()};function ud(a,c,b,d,e,f,g,k,l,h){this.data=a;this.width=c;this.height=b;this.x=d;this.y=e;this.i=null;this.ma=[];this.H=f;this.u=null;this.l=this.Za=!0;this.Ha=null;this.b=g||null;this.pb=k||null;this.gb=l||null;this.pg=this.rb=!1;this.zc=this.doScroll=null;this.id=h||"";this.w=this.qa=this.ca=this.S=null}ud.prototype.clone=function(){var a=new ud(this.data,this.width,this.height,this.x,this.y,this.H,this.b,this.pb,this.gb,this.id);a.u=this.u;return a};
ud.prototype.J=function(a,c,b,d,e){var f=a.N,g=this.i&&void 0===c;g&&(f.save(),f.beginPath(),f.rect(this.i.x,this.i.y,this.i.rc,this.i.ld),f.clip(),c=this.i.Vg,b=this.i.Wg);d?this.u&&this.u(a,this,c||0,b||0,e):this.H&&this.H(a,this,c||0,b||0,e);g&&f.restore()};ud.prototype.toDataURL=function(a,c,b){var d=document.createElement("canvas");c=c||1;d.width=c*this.width;d.height=c*this.height;c=new Xb(d,{xh:c});c.A=a;this.J(c);this.J(c,0,0,!0);return d.toDataURL(b||"image/png")};
function De(a){return a.i?{Kb:a.i.Vg,Lb:a.i.Wg}:{Kb:0,Lb:0}}
function Xb(a,c){function b(a){function c(a){var c=e.b.getBoundingClientRect(),d=De(a);a.w=a.b.fa?a.b.fa(e,a.data,a.width,a.height,c.left+a.x+d.Kb,c.top+a.y+d.Lb,b):0;return null!==a.w?(a.b.Qa&&a.b.Qa(e,a.data,a.w,a.width,a.height,c.left+a.x+d.Kb,c.top+a.y+d.Lb,b),e.qa&&e.qa(),e.Db?e.Db():J(e),Ee=a.b.Qa||a.b.dd?function(b,f){f?a.b.dd&&a.b.dd&&(a.b.dd(e,a.data,a.w,a.width,a.height,c.left+a.x+d.Kb,c.top+a.y+d.Lb,Fe(e,b)),e.qa&&e.qa(),e.Db?e.Db():J(e)):a.b.Qa&&(a.b.Qa(e,a.data,a.w,a.width,a.height,c.left+
a.x+d.Kb,c.top+a.y+d.Lb,Fe(e,b)),e.qa&&e.qa(),e.Db?e.Db():J(e))}:null,e.qa&&e.qa(),e.Db?e.Db():J(e),!a.l||null!=a.b&&null!=a.b.Qa):!1}if(e.S){for(var b=Fe(e,a),d=0;d<e.rb.length;d++)if(!e.rb[d](a,b))return;if(Ge(e,b)){var f=e.Qb;f.b&&c(f)}else if(e.Qb)e.w=-1,e.Qb=null,e.qa&&e.qa(),e.Db?e.Db():J(e);else{var q=He(e,b,!0);if(0<q.length){if(f=e.ob[q[0]],0<=e.w&&e.w!==q[0]&&(e.w=-1,e.Qb=null),e.tc=Date.now(),(!f.b||(a instanceof MouseEvent?f.S:f.ca)&&e.w!==q[0]||!c(f))&&f.l){var p=f.Ha?f.Ha(f):f,t=null,
u=De(p),w=b.x-u.Kb,m=b.y-u.Lb,n=Ee;Ee=function(a,c,b){var d=Fe(e,a);e.dg&&e.dg(c?null:f);if(c){if((b?f.ca:f.S)&&10>Math.abs(d.x-u.Kb-w)+Math.abs(d.y-u.Lb-m))e.w=q[0],e.Qb=(b?f.ca:f.S)(f,b);else{if(f.b&&f.b.dd&&10>Math.abs(d.x-u.Kb-w)+Math.abs(d.y-u.Lb-m)){n(a,c,b);return}if(t&&t.pb&&(!t.gb||t.gb(t,p)))t.pb(t,p);else if(null==t||null==t.pb||t.gb&&!t.gb(t,p)){for(c=0;c<e.ma.length&&!e.ma[c].pb(t,p,d.x,d.y);c++);c>=e.ma.length&&e.Ha&&e.Ha()}else e.Ha&&e.Ha()}J(e);e.b.style.cursor="default"}else{b=He(e,
d,!1);t=null;a=!1;for(c=0;!a&&c<b.length;c++)t=e.ob[b[c]],a=t.pb&&(!t.gb||t.gb(t,p));a&&null!=t?(t.pg=!0,J(e),t.pg=!1):J(e);c=e.N;a&&!t.rb&&(b=De(t),wd(e,t.x+b.Kb,t.y+b.Lb,t.width,t.height,["drop-target"]));c.save();Ie(e);e.transform&&(c.translate(e.width/2,e.height/2),CanvasRenderingContext2D.prototype.transform.apply(c,e.transform),c.translate(-e.width/2,-e.height/2));c.translate(e.l*e.Ja.Y,e.i*e.Ja.ba);c.globalAlpha=.5;p.J(e,d.x-w,d.y-m);p.ma.forEach(function(a){a.J(e,d.x-w,d.y-m);a.J(e,d.x-w,
d.y-m,!0)});p.J(e,d.x-w,d.y-m,!0);c.restore();e.b.style.cursor=a?"copy":"default"}}}}else 0<=e.w&&(e.w=-1,e.Qb=null,J(e))}}}var d=c&&c.xh||("devicePixelRatio"in window?window.devicePixelRatio:1);this.b=a;this.l=a.width/d;this.i=a.height/d;this.Ja=c&&c.Ja||{Y:0,oa:1,ba:0,pa:1};this.width=this.l*(this.Ja.oa-this.Ja.Y);this.height=this.i*(this.Ja.pa-this.Ja.ba);this.S=!0;this.rb=[];this.transform=this.Jb=null;this.N=this.b.getContext("2d");this.Za=this.state=null;this.dg=c&&c.dg||null;this.ma=[];this.Ha=
null;this.tc=0;this.w=-1;this.Qb=null;this.u={};this.clientData={};this.ia=c&&c.ia||new Wb;this.A=null;this.resize(this.width,this.height,c&&c.xh);this.ca={};var e=this;a.addEventListener("mousedown",b,!1);a.addEventListener("touchstart",function(a){var c=a.targetTouches;1===c.length&&(a.preventDefault(),b(c[0]),Je=c[0])},!1);a.addEventListener("wheel",function(a){function c(c){c.doScroll&&(a.preventDefault(),c.doScroll(0===a.deltaMode?a.deltaX:1===a.deltaMode?10*a.deltaX:30*a.deltaX,0===a.deltaMode?
a.deltaY:1===a.deltaMode?10*a.deltaY:30*a.deltaY))}if(e.S){var b=Fe(e,a);if(Ge(e,b))e.Qb&&c(e.Qb);else if(0>e.w){b=He(e,b,!0);for(var d=0;d<b.length;d++)if(null!=e.ob[b[d]].doScroll){c(e.ob[b[d]]);break}}}},!1);a.addEventListener("mousemove",function(a){if(e.S){for(var c=He(e,Fe(e,a),!0),b=0;b<c.length;b++)if(null!=e.ob[c[b]].zc){a.preventDefault();e.ob[c[b]].zc();return}e.Za&&e.Za()}},!1);this.ob=[];this.H=[];this.Db=this.qa=null}function bc(a,c){a.rb.push(c)}
function Fc(a,c){a.Ja=c||{Y:0,oa:1,ba:0,pa:1};a.width=a.l*(a.Ja.oa-a.Ja.Y);a.height=a.i*(a.Ja.pa-a.Ja.ba)}function Rd(a,c){for(var b=0;b<a.ma.length;b++)if("delete"===a.ma[b].tag){a.ma[b].pb=c;return}a.ma.push({tag:"delete",pb:c})}Xb.prototype.show=function(){this.S=!0};Xb.prototype.vc=function(){this.S=!1};function Ke(a,c){a.b.style.filter=c}function Le(a,c){a.Jb=c&&c.slice();a.transform=a.Jb}
function Fe(a,c){c={x:c.clientX,y:c.clientY,ei:c.altKey};var b=[c.x,c.y];b=[b[0]-a.l*a.Ja.Y,b[1]-a.i*a.Ja.ba];var d=a.transform;if(d){var e=a.width/2;a=a.height/2;d=d.slice(0,4).concat(d[4]-e*d[0]-a*d[2]+e,d[5]-e*d[1]-a*d[3]+a);a=d[0]*d[3]-d[1]*d[2];b=[(d[3]*b[0]-d[2]*b[1]+d[2]*d[5]-d[3]*d[4])/a,(-d[1]*b[0]+d[0]*b[1]+d[1]*d[4]-d[0]*d[5])/a]}c.x=b[0];c.y=b[1];return c}function Me(a){a.qa&&a.qa();a.Db?a.Db():J(a)}
function qc(a,c){return{m:a,ph:60,qh:120,jh:!1,ua:Math.max(1,Math.min(3,Math.round(a/40))),ng:Math.round(a/4).toString(10)+"px sans-serif",wi:"navy",xi:"#37f",vi:"#06f",g:c,Ca:Math.max(1,Math.min(3,c/30)),Zh:"bold 15px sans-serif",Kg:"navy",Jg:"#ccc",vd:5,qg:"#e44",Ug:"#f88",Ig:"#bbb"}}
function Pd(a,c){a.width=a.l*(a.Ja.oa-a.Ja.Y);a.height=a.i*(a.Ja.pa-a.Ja.ba);a.N=a.b.getContext("2d");c=c||("devicePixelRatio"in window?window.devicePixelRatio:1);1!=c&&(a.N.resetTransform(),a.N.scale(c,c));a.ia.b=new te(a.width,a.width/100,a.height/100,a.l/100,a.i/100);c=N(a.ia,{tag:"block"}).width;var b=N(a.ia,{tag:"button"}).width;a.A=qc(c,b)}
Xb.prototype.resize=function(a,c,b){var d=b||("devicePixelRatio"in window?window.devicePixelRatio:1);this.b.width=a*d;this.b.height=c*d;this.b.style.width=a+"px";this.b.style.height=c+"px";this.l=a;this.i=c;Pd(this,b)};function xd(a,c){for(var b=0;b<a.ob.length;b++)if(a.ob[b].data===c)return b;return-1}
function He(a,c,b){var d=a.b.getBoundingClientRect(),e=c.x-d.left;c=c.y-d.top;d=[];for(var f=a.ob.length-1;0<=f;f--){var g=De(a.ob[f]);if(g=(!b||a.ob[f].Za)&&e>=a.ob[f].x+g.Kb&&e<=a.ob[f].x+g.Kb+a.ob[f].width&&c>=a.ob[f].y+g.Lb&&c<=a.ob[f].y+g.Lb+a.ob[f].height)g=a.ob[f],g=!g.i||e>=g.i.x&&e<g.i.x+g.i.rc&&c>=g.i.y&&c<g.i.y+g.i.ld;g&&d.push(f)}return d}
function Tc(a,c){var b=c.clone();a=Qd(a);var d=Math.min(a.width,a.height)/1.5/b.width;b.width*=d;b.height*=d;b.x=(a.width-b.width)/2;b.y=(a.height-b.height)/2;b.S=null;b.ca=null;b.H=function(a,f){var e=a.N;e.save();e.translate(f.x,f.y);e.scale(d,d);e.translate(-f.x,-f.y);c.H(a,b,f.x-b.x,f.y-b.y,!0);e.restore()};c.u&&(b.u=function(a,f){var e=a.N;e.save();e.translate(f.x,f.y);e.scale(d,d);e.translate(-f.x,-f.y);c.u(a,b,f.x-b.x,f.y-b.y,!0);e.restore()});return b}
function Ge(a,c){if(null==a.Qb)return!1;var b=a.b.getBoundingClientRect(),d=c.x-b.left;c=c.y-b.top;return d>=a.Qb.x&&d<=a.Qb.x+a.Qb.width&&c>=a.Qb.y&&c<=a.Qb.y+a.Qb.height}function Qd(a){return{width:a.width,height:a.height}}function Ie(a){a.N.beginPath();a.N.rect(a.l*a.Ja.Y,a.i*a.Ja.ba,a.l*(a.Ja.oa-a.Ja.Y),a.i*(a.Ja.pa-a.Ja.ba));a.N.clip()}
function Ne(a,c,b,d,e,f,g){f=f||0;g=g||0;if(0<a.H.length){var k=a.H[a.H.length-1];k.x>c&&(d-=k.x-c,c=k.x);k.x+k.rc<c+d&&(d=k.x+k.rc-c);k.y>b&&(e-=k.y-b,b=k.y);k.y+k.ld<b+e&&(e=k.y+k.ld-b);f+=k.Vg;g+=k.Wg}a.H.push({x:c,y:b,rc:d,ld:e,Vg:f,Wg:g})}function Ad(a,c,b){0<a.H.length&&(c.i=a.H[a.H.length-1]);0<=b?a.ob[b]=c:a.ob.push(c)}function Yc(a,c){var b=new ud(null,-1,-1,0,0,function(a,b,f,g){a=a.N;a.save();a.translate(b.x+f,b.y+g);c(a);a.restore()});Ad(a,b);return b}
function $c(a,c,b,d,e,f,g){var k,l=new ud(null,d.width,d.height,c,b,function(c,b,f,k){c=c.N;c.save();Zc(d,c,b.x+f,b.y+k);c.translate(b.x+f,b.y+k);e(c,d,a.u.id===g&&a.u.$d||b.pg);c.restore()},f&&(f.action||f.oe||f.pe)?{fa:function(c,b,d,e,u,w,m){a.u={id:g,rect:{x:l.x,y:l.y,rc:d,ld:e},$d:!0};k=m;f.oe&&f.oe(k);J(a);return 0},Qa:function(c,b,d,e,f,g,k,l){d=c.b.getBoundingClientRect();b=l.x-d.left;l=l.y-d.top;a.u.$d=b>=a.u.rect.x&&b<a.u.rect.x+a.u.rect.rc&&l>=a.u.rect.y&&l<a.u.rect.y+a.u.rect.ld;J(c)},
dd:function(){f.action?a.u.$d&&f.action(k):f.pe&&f.pe(k);a.u={};J(a)}}:null,f&&f.pb,f&&f.gb,g);l.zc=f&&f.zc||null;l.l=!1;l.rb=!0;Ad(a,l);return l}function Hd(a,c,b,d,e){Zc(e,a.N,b-e.width/2,d-e.height/2);var f=a.ca[c];void 0!=f&&(a.N.save(),a.N.translate(b,d),f(a.N,c,a.A,e),a.N.restore())}
function J(a){a.S&&(a.N.clearRect(a.l*a.Ja.Y,a.i*a.Ja.ba,a.l*(a.Ja.oa-a.Ja.Y),a.i*(a.Ja.pa-a.Ja.ba)),a.N.save(),a.transform&&(a.N.translate(a.width/2,a.height/2),CanvasRenderingContext2D.prototype.transform.apply(a.N,a.transform),a.N.translate(-a.width/2,-a.height/2)),a.N.translate(a.l*a.Ja.Y,a.i*a.Ja.ba),a.ob.forEach(function(a){a.J(this)},a),a.ob.forEach(function(a){a.J(this,void 0,void 0,!0)},a),a.Qb&&(a.N.save(),a.N.globalAlpha=.5,a.N.fillStyle="black",a.N.fillRect(a.l*a.Ja.Y,a.i*a.Ja.ba,a.l*
(a.Ja.oa-a.Ja.Y),a.i*(a.Ja.pa-a.Ja.ba)),a.N.restore(),a.Qb.J(a),a.Qb.J(a,0,0,!0)),a.N.restore())};function pd(){this.w=this.H=1;this.i=this.l=this.y=this.x=0;this.S=!1;this.ma="";this.Ge=this.b=this.Fe=this.u=0;this.ca=null}x=pd.prototype;x.Tc=function(a){this.H=a;this.u=Math.max(0,Math.min(this.u,this.H-this.l))};x.Dc=function(a){this.w=a;this.b=Math.max(0,Math.min(this.b,this.w-this.i))};x.resize=function(a,c,b,d){this.x=a;this.y=c;this.l=b;this.i=d;this.u=Math.max(0,Math.min(this.u,this.H-this.l));this.b=Math.max(0,Math.min(this.b,this.w-this.i))};
x.je=function(a){this.ca=a;var c=this,b=new ud(null,this.l,this.i,this.x,this.y,null,this.H>this.l||this.w>this.i?{fa:function(a,b,f,g,k,l,h){c.Fe=h.x;c.Ge=h.y;return 0},Qa:function(a,b,f,g,k,l,h,q){a=Math.max(Math.min(q.x-c.Fe,c.u),c.u-c.H+c.l);c.u-=a;c.Fe+=a;q=Math.max(Math.min(q.y-c.Ge,c.b),c.b-c.w+c.i);c.b-=q;c.Ge+=q}}:null,null,null);b.l=!1;b.doScroll=function(b,e){c.u+=b;c.b+=e;a.qa()};Ad(a,b);this.ma&&Yc(a,function(a){a.save();a.fillStyle=c.ma;a.fillRect(c.x,c.y,c.l,c.i);a.restore()});(this.H>
this.l||this.w>this.i)&&Yc(a,function(b){b.save();if(c.H>c.l){var d=c.l/c.H;d=Math.max(d*c.l,Math.min(20,c.l));var f=c.l-d,g=c.u/(c.H-c.l);f*=g;b.fillStyle=a.A.Jg;b.fillRect(c.x,c.y+c.i+2,c.l,a.A.vd);b.fillStyle=a.A.Kg;b.fillRect(c.x+f,c.y+c.i+2,d,a.A.vd)}c.w>c.i&&(d=c.i/c.w,d=Math.max(d*c.i,Math.min(20,c.i)),f=c.i-d,g=c.b/(c.w-c.i),f*=g,b.save(),b.fillStyle=a.A.Jg,b.fillRect(c.S?c.x-2-a.A.vd:c.x+c.l+2,c.y,a.A.vd,c.i),b.fillStyle=a.A.Kg,b.fillRect(c.S?c.x-2-a.A.vd:c.x+c.l+2,c.y+f,a.A.vd,d));b.restore()});
Ne(a,this.x,this.y,this.l,this.i,-this.u,-this.b)};x.end=function(){this.ca.H.pop()};function ae(a,c,b){b-a.b>a.i&&(a.b=b-a.i);c<a.b&&(a.b=c)}function Xd(a){return a.b<=.001*a.i}function Yd(a){return a.b>=a.w-1.001*a.i};function wd(a,c,b,d,e,f){f=N(a.ia,{tag:"overlay-rectangle",ga:f||[]});f.x=c;f.y=b;f.width=d;f.height=e;f.J(a.N)}
function ad(a,c,b,d,e,f,g,k){wd(a,c,b,d,e,(f||[]).concat("disabled"));if(!k){a.N.save();f=Nd(a.ia,{tag:"crossout-line",ga:g||[]});a.N.beginPath();k=a.ia;g=/^(-?([0-9]+\.?|[0-9]*\.[0-9]+))([a-z]*)$/.exec(f.ze["line-angle"]||"0");if(null==g)throw"Illegal angle";if(k.ca.hasOwnProperty(g[3]))k=k.ca[g[3]];else if(0==parseFloat(g[1]))k=0;else throw"Unknown angle unit";g=parseFloat(g[1])*k;k=fe(a.ia,f.ze["line-overflow"]||"0").V(a.ia.b);if(Math.abs(g%Math.PI)<.25*Math.PI||Math.abs((Math.PI-g)%Math.PI)<.25*
Math.PI){k=(d/2+k)*Math.sign(Math.cos(g));var l=e/2*Math.sin(g)*Math.sqrt(2)}else l=(e/2+k)*Math.sign(Math.sin(g)),k=d/2*Math.cos(g)*Math.sqrt(2);a.N.moveTo(c+d/2-k,b+e/2-l);a.N.lineTo(c+d/2+k,b+e/2+l);f.stroke(a.N);a.N.restore()}}
function dd(a,c,b,d,e,f){a.save();a.strokeStyle=e;a.fillStyle=e;a.lineWidth=d;a.fillRect(c-2.5*d,b-d,5*d,4*d);a.beginPath();a.moveTo(c-1.7*d,b);a.lineTo(c-1.7*d,b);f?(a.arc(c-3.4*d,b-2*d,1.7*d,0,Math.PI,!0),a.lineTo(c-5.1*d,b)):(a.arc(c,b-2*d,1.7*d,-Math.PI,0),a.lineTo(c+1.7*d,b));a.stroke();a.restore()}function vd(a,c,b,d,e,f,g){var k=.03*a.A.m;dd(a.N,c+d+(f?-5:5)*k,b+.15*e,k,g||"#333")}
function fd(a,c,b,d,e,f,g){a.save();g&&(g.style&&(a.strokeStyle=g.style,a.fillStyle=g.style),void 0!==g.lineWidth&&(a.lineWidth=g.lineWidth),void 0!==g.alpha&&(a.globalAlpha=g.alpha));var k=g&&void 0!==g.Xc?g.Xc:5*a.lineWidth;a.beginPath();var l=e+(g&&g.Bd?k/d:0),h=f-(g&&g.Bd?0:k/d);a.arc(c,b,d,l,h);a.stroke();g&&g.Bd?(a.translate(c+d*Math.cos(e),b+d*Math.sin(e)),a.rotate((e+l)/2+Math.PI)):(a.translate(c+d*Math.cos(f),b+d*Math.sin(f)),a.rotate((f+h)/2));a.beginPath();a.moveTo(0,0);a.lineTo(k/2,1.2*
-k);a.lineTo(-k/2,1.2*-k);a.fill();a.restore()}Xb.prototype.text=function(a,c){var b=this.N,d=this.A;b.save();b.fillStyle=c&&c.fillStyle||"white";b.font=d.ng;b.textAlign="center";b.textBaseline="middle";b.translate(.5*d.m+(c&&c.x||0),.5*d.m-(c&&c.y||0));c&&c.hi&&b.rotate(-c.hi);b.translate(-.5*d.m,-.5*d.m);b.fillText(a,.5*d.m,.5*d.m);b.restore()};
function Oe(a,c){var b=a.N,d=a.A;b.save();b.beginPath();b.rect(0,0,a.A.m,a.A.m);b.clip();c&&(c.scale||c.rotation)&&(c.cf&&b.translate(-c.cf[0],-c.cf[1]),b.translate(.5*d.m,.5*d.m),c.scale&&b.scale(c.scale,c.scale),c.rotation&&b.rotate(-c.rotation),b.translate(-.5*d.m,-.5*d.m));b.beginPath();b.moveTo(.5*d.m,d.m-d.ua);c&&"left"===c.zf||(b.lineTo(d.m-d.ua,d.m-d.ua),b.lineTo(d.m-d.ua,.25*d.m),b.bezierCurveTo(.8*d.m,d.ua,.52*d.m,d.ua,.5*d.m,d.ua));c&&"right"===c.zf||(b.lineTo(.5*d.m,d.ua),b.bezierCurveTo(.48*
d.m,d.ua,.2*d.m,d.ua,d.ua,.25*d.m),b.lineTo(d.ua,d.m-d.ua));b.closePath();if(c&&c.mc){a=[c.mc[0],Math.max(.2+.8*c.mc[1],c.mc[2]/2),c.mc[2]];var e=Math.max(a[0],Math.max(a[1],a[2]));b.fillStyle="rgb("+a.map(function(a){return Math.round(225*(1-e)+(30+225*e)*a)}).join(",")+")"}else b.fillStyle="white";b.fill();c&&c.mc&&(b.strokeStyle="white",b.lineWidth=d.ua,b.stroke());c&&c.Kc&&(b.fillStyle="black",b.fillRect(0,.6*d.m,.1*d.m,.35*d.m),b.fillRect(.9*d.m,.6*d.m,.1*d.m,.35*d.m));b.restore()}
function Pe(a,c){var b=(c-a)/2,d=c===a?Infinity:(c+a)/(2*b);return{kb:b,kg:d,x:Math.abs(d)>1E3*Math.abs(a+c)?0:d*(.01>b?b*b/2:1-Math.cos(b)),y:Math.abs(d)>1E3*Math.abs(a+c)?(a+c)/2:d*Math.sin(b)}}
function Qe(a,c,b,d,e){var f=a.N;a=a.A;d*=a.m;var g=e&&e.r||[-1,0,1],k=e&&e.color||"black";e=e&&void 0!==e.vf?e.vf:1;var l=Pe(c,b);f.save();f.translate(.5*a.m,.5*a.m);f.strokeStyle=k;f.lineWidth=a.ua*e;20<Math.abs(l.kg)?(f.beginPath(),g.forEach(function(a){f.moveTo(a*d,0);f.lineTo((l.x+a)*d,-l.y*d)}),f.stroke()):g.forEach(function(a){f.beginPath();var c=-l.kg*d;a=(l.kg+a)*d;var b=l.kb;0<a?f.arc(c,0,a,0,-b,0<b):0>a&&f.arc(c,0,-a,Math.PI,Math.PI-b,0<b);f.stroke()});f.restore();return l}
function Re(a,c,b,d,e,f,g){a=a.A;e*=a.m;f*=a.m;a=.21*a.m;b=g.x-b-c/2;c=d+c/2-g.y;e=Pe(e,f);return(b-e.x)*(b-e.x)+(c-e.y)*(c-e.y)<a*a}
function Se(a){var c=a.N;a=a.A;c.save();c.translate(.5*a.m,.5*a.m);c.scale(.7,.7);c.translate(-.5*a.m,-.5*a.m);c.fillStyle="white";c.fillRect(a.ua,.45*a.m,a.m-2*a.ua,.35*a.m);c.fillStyle="black";c.beginPath();c.arc(.27*a.m,.72*a.m,.2*a.m,0,2*Math.PI);c.fill();c.fillStyle="white";c.beginPath();c.arc(.27*a.m,.72*a.m,.12*a.m,0,2*Math.PI);c.fill();c.beginPath();c.arc(.8*a.m,.8*a.m-a.ua,.1*a.m,0,2*Math.PI);c.fill();c.restore()}
function Te(a){var c=a.N;a=a.A;c.save();c.lineWidth=a.ua;c.strokeStyle="white";for(var b=1;3>=b;b++)c.beginPath(),c.arc(.185*a.m,.48*a.m,.05*a.m*b,.9*Math.PI,1.7*Math.PI),c.stroke();c.restore()}
Xb.prototype.buttons=function(a,c,b){var d=this.N,e=this.A;a.forEach(function(a,g){d.save();d.translate(e.m*(.5+a.x),e.m*(.5-a.y));d.rotate(a.r||0);d.fillStyle=a.fillStyle?a.fillStyle:b&&b.tg&&c?b.tg[c[g]]:c&&!0===c[g]?"red":c&&1===c[g]?"#f66":c&&-1===c[g]?"#333":"white";d.strokeStyle=a.strokeStyle?a.strokeStyle:b&&b.Lg&&c?b.Lg[c[g]]:!c||1!==c[g]&&!0!==c[g]?c&&0>c[g]?"black":"#aaa":"#700";d.lineWidth=e.ua;d.lineJoin="round";var f=a.size||1;switch(a.C){case "r":d.fillRect(.08*-e.m*f,.08*-e.m*f,.16*
e.m*f,.16*e.m*f);d.strokeRect(.08*-e.m*f,.08*-e.m*f,.16*e.m*f,.16*e.m*f);break;case "t":d.beginPath();d.moveTo(0,-.122*e.m*f);d.lineTo(.106*e.m*f,.062*e.m*f);d.lineTo(-.106*e.m*f,.062*e.m*f);d.closePath();d.fill();d.stroke();break;case "c":d.beginPath(),d.arc(0,0,.112*e.m*f,0,2*Math.PI),d.fill(),d.stroke()}c&&b&&void 0!==b.me&&b.me===c[g]&&(d.strokeStyle="white",d.beginPath(),d.moveTo(.06*-e.m*f,.06*-e.m*f),d.lineTo(.06*e.m*f,.06*e.m*f),d.moveTo(.06*-e.m*f,.06*e.m*f),d.lineTo(.06*e.m*f,.06*-e.m*f),
d.stroke());d.restore()})};function Ue(a,c,b,d,e,f,g,k,l){var h=a.N;a=a.A;h.save();h.strokeStyle="black";h.lineWidth=a.ua*l;l=c.length/2;for(var q=0;q<l;q++)0<c[2*q+1]&&(h.fillStyle=2===c[2*q+1]?"white":"black",h.beginPath(),h.arc(a.m*(b+(d-b)/l*(q+.5)),a.m*(e+(f-e)/g*(c[2*q]+.5)),a.m*k/2,0,2*Math.PI),h.fill(),h.stroke());h.restore()}
function Ve(a,c){var b=a.N,d=a.A,e=null===c?-.15*d.m:0;b.save();b.beginPath();b.moveTo(.4*d.m+e,.3*d.m);b.lineTo(.4*d.m+e,.7*d.m);b.lineTo(.7*d.m+e,.7*d.m);b.lineTo(.7*d.m+e,.37*d.m);b.lineTo(.63*d.m+e,.3*d.m);b.closePath();b.lineWidth=d.ua;b.strokeStyle="white";b.lineJoin="round";b.stroke();for(var f=.15;.31>f;f+=.06)b.beginPath(),b.arc(.65*d.m+e,.5*d.m,d.m*f,-.6,.6),b.stroke();null===c?(b.beginPath(),b.moveTo(.12*d.m,.6*d.m),b.lineTo(.88*d.m,.4*d.m),b.lineWidth=1.5*d.ua,b.stroke()):a.text(c.toString(10),
{x:-.3*d.m});b.restore()}function We(a){var c=a.N;a=a.A;c.beginPath();c.arc(0,0,.4*a.m,0,2*Math.PI,!0);c.moveTo(0,0);c.lineTo(0,.4*-a.m);c.strokeStyle="#666";c.lineWidth=a.ua;c.stroke();c.beginPath();c.arc(0,.4*-a.m,.1*a.m,0,2*Math.PI);c.fillStyle="white";c.fill();c.strokeStyle="black";c.stroke()}
function Xe(a,c,b){var d=a.N,e=a.A;b=b*Math.PI/12;d.save();d.translate(.5*e.m,.5*e.m);d.rotate(b);We(a);d.fillRect(-.28*e.m,-.1*e.m,.56*e.m,.2*e.m);d.fillStyle="black";c?(d.beginPath(),d.arc(-.15*e.m,.03*e.m,.11*e.m,0,2*Math.PI),d.fill(),d.fillStyle="white",d.beginPath(),d.arc(-.15*e.m,.03*e.m,.07*e.m,0,2*Math.PI),d.fill(),d.beginPath(),d.arc(.15*e.m,.07*e.m,.06*e.m,0,2*Math.PI)):(d.fillRect(-.28*e.m,.1*e.m,.08*e.m,.04*e.m),d.fillRect(.2*e.m,.1*e.m,.08*e.m,.04*e.m),d.fillStyle="white",d.beginPath(),
d.arc(0,.06*e.m,.06*e.m,0,2*Math.PI));d.fill();d.restore()}function Ye(a,c,b,d,e){c=d.x-c-a/2;b=b+a/2-d.y;a=(c*c+b*b)/(a*a/4);return 1>a&&.4<a&&(e||0<=b)}function Ze(a,c,b,d,e){a=Math.round(12*Math.atan2(d.x-c-a/2,b+a/2-d.y)/Math.PI);return e?12===a?-12:a:Math.max(-6,Math.min(6,a))}
function $e(a,c,b,d,e,f,g,k,l){var h=l?0>=g?0:Math.max(Math.log(10*g)/Math.log(100),0):g/4;a.save();!k&&f&&f(g);a.beginPath();a.arc(c,b,d,0,2*Math.PI);a.fillStyle="white";a.fill();f=.9*d;g=l?.8*d:.6*d;var q=2*Math.PI*(k?.2:h),p=k?"#ddd":"red";l=(g-(l?.5*d:.6*d))/4;a.save();a.beginPath();a.arc(c,b,f,-Math.PI/2,3*Math.PI/2-.05);a.arc(c,b,g-4*l,3*Math.PI/2-.05,Math.PI,!0);a.arc(c+l,b,g-3*l,Math.PI,Math.PI/2,!0);a.arc(c+l,b-l,g-2*l,Math.PI/2,0,!0);a.arc(c,b-l,g-l,0,-Math.PI/2,!0);a.clip();a.fillStyle=
p;a.beginPath();a.arc(c,b,f,-Math.PI/2,-Math.PI/2+q);a.lineTo(c,b);a.fill();a.restore();a.beginPath();a.arc(c,b,d/2,0,2*Math.PI);a.fill();a.beginPath();a.arc(c,b,d,0,2*Math.PI);a.strokeStyle="black";a.lineWidth=e;a.stroke();a.beginPath();a.moveTo(c-.1*d*Math.sin(2*h*Math.PI),b+.1*d*Math.cos(2*h*Math.PI));a.lineTo(c+.9*d*Math.sin(2*h*Math.PI),b-.9*d*Math.cos(2*h*Math.PI));a.lineWidth=2*e;a.stroke();k&&fd(a,c,b,1.25*d,.5*-Math.PI,.1*-Math.PI,{Bd:!0,Xc:5*e,style:"black"});a.restore()}
function af(a,c,b,d){var e=a.N,f=a.A.m;$e(e,f/2+(b?-.05*f:.05*f),f/2+(b?.07*f:.03*f),.4*f,a.A.ua,function(a){e.textAlign="start";e.textBaseline="top";e.font=Math.round(f/6).toString(10)+"px sans-serif";e.fillStyle="white";e.fillText(a.toFixed(1>a?2:1),f/20,f/40)},c,b,d)}
function bf(a,c,b,d,e,f,g){a.save();g&&(g.style&&(a.strokeStyle=g.style,a.fillStyle=g.style),void 0!==g.lineWidth&&(a.lineWidth=g.lineWidth),void 0!==g.alpha&&(a.globalAlpha=g.alpha));a.beginPath();e/=2;a.moveTo(c,d+e);for(g=0;g<f;g++){var k=c+(b-c)*(.5+g)/f;a.lineTo(k,d+e);e=-e;a.lineTo(k,d+e)}a.lineTo(b,d+e);a.stroke();a.restore()}
function cf(a,c,b,d,e,f,g,k,l,h){var q=(d+e)/2,p=(e-d)/2;a.save();a.beginPath();a.arc(c,b,d,-g,-f);a.arc(c+q*Math.cos(f),b-q*Math.sin(f),p,-f-Math.PI,-f,!0);a.arc(c,b,e,-f,-g,!0);a.arc(c+q*Math.cos(g),b-q*Math.sin(g),p,-g,-g+Math.PI,!0);a.fillStyle=k;a.strokeStyle=l;a.lineWidth=h;a.fill();a.stroke();a.restore()}function df(a,c,b,d){var e=a.A;cf(a.N,e.m/2,e.m/2,.3*e.m,.45*e.m,c,b,0>d?"white":2===d?"red":0<d?"#f70":"#ddd",0===d?"#bbb":"black",e.ua)}
function ef(a,c){var b=a.N;b.save();df(a,.65*Math.PI,.85*Math.PI,c[0]);df(a,.15*Math.PI,.35*Math.PI,c[1]);df(a,1.15*Math.PI,1.35*Math.PI,c[2]);df(a,1.65*Math.PI,1.85*Math.PI,c[3]);b.restore()}function ff(a,c){var b=a.N;b.save();for(var d=0;8>d;d++)df(a,Math.PI*(.46-.25*d),Math.PI*(.54-.25*d),d===c?1:-1);b.restore()}function gf(a,c,b,d,e,f){c=(f.x-d)/c-.5;b=.5-(f.y-e)/b;for(e=0;e<a.length;e++)if(Math.max(Math.abs(c-a[e].x),Math.abs(b-a[e].y))<.11*(a[e].size||1))return e;return null}
function hf(a,c,b,d,e,f){function g(a,c){k.beginPath();k.moveTo(l.m*(.1+.8*a),l.m*(.46-b));k.lineTo(l.m*(.1+.8*c),l.m*(.46-b));k.arc(l.m*(.1+.8*c),l.m*(.5-b),.04*l.m,-Math.PI/2,Math.PI/2);k.lineTo(l.m*(.1+.8*c),l.m*(.54-b));k.lineTo(l.m*(.1+.8*a),l.m*(.54-b));k.arc(l.m*(.1+.8*a),l.m*(.5-b),.04*l.m,Math.PI/2,-Math.PI/2)}var k=a.N,l=a.A;k.save();d&&(k.translate(.5*l.m,.5*l.m),k.rotate(-Math.PI/2),k.scale(1,-1),k.translate(-.5*l.m,-.5*l.m));k.lineWidth=l.ua;k.fillStyle="white";k.strokeStyle="black";
g(0,1);k.fill();k.stroke();k.fillStyle=e;switch(f||0){case 1:g(0,c);k.fill();k.stroke();break;case 2:g(c,1),k.fill(),k.stroke()}k.fillStyle=e;k.strokeStyle="black";k.lineWidth=l.ua;k.beginPath();k.arc(l.m*(.1+.8*c),l.m*(.5-b),.1*l.m,0,2*Math.PI);k.fill();k.stroke();k.restore()}function jf(a,c,b,d,e,f,g){b=(g.x-e)/b-.5;d=.5-(g.y-f)/d;return.1>Math.abs((c?b:d)-a)}function kf(a,c,b,d,e,f){c=(f.x-d)/c-.5;b=.5-(f.y-e)/b;return.5+(a?b:c)/.8}
function lf(a,c,b,d,e,f,g,k,l,h,q){a=Math.floor(((q.x-l)/g-a)/((c-a)/e));b=Math.floor((b-(q.y-h)/k)/((b-d)/f));return 0<=a&&a<e&&0<=b&&b<f?{index:a,tone:b}:null}function mf(a,c,b,d,e){var f=.4*a;a=e.x-b-.55*a;c=d+.53*c-e.y;return a*a+c*c<=f*f}function nf(a,c,b,d,e,f){a=(Math.PI-Math.atan2(f.x-b-.55*a,-(d+.53*c-f.y)))/(2*Math.PI);return e?Math.exp(a*Math.log(100))/10:4*a}function of(a,c,b,d,e){b=e.x-b-a/2;c=c/2-(e.y-d);return Math.abs(Math.sqrt(b*b+c*c)-.375*a)<=.15*a?0<=c?0>b?0:1:0>b?2:3:null}
function pf(a,c,b,d,e){b=e.x-b-a/2;c=c/2-(e.y-d);return Math.abs(Math.sqrt(b*b+c*c)-.375*a)<=.15*a?(a=Math.atan2(b,c)+Math.PI/8,Math.floor((0>a?a+2*Math.PI:a)/(Math.PI/4))):null}function ed(a,c,b,d){if(0<d){a.beginPath();a.moveTo(c+d*Math.cos(.1),b+d*Math.sin(.2));for(var e=1;6>e;e++)a.lineTo(c+d*Math.cos(e*Math.PI/3+.2),b+d*Math.sin(e*Math.PI/3+.2));a.closePath();a.arc(c,b,.5*d,0,2*Math.PI,!0);a.fill()}};function Ia(a){for(var c=0;c<G.length;c++)if(G[c].name===a)return G[c];return null}function gb(a){var c=[];(G||[]).forEach(function(b){"h"!==b.type&&0<=b.va.indexOf(a)&&c.push(b)});return c};function qf(a,c){var b=.1*(a.size||1);return new Da(.5-a.y-b,.5+a.x-b,.5-a.y+b,.5+a.x+b,c,null,null)}function rf(a,c){return c[(c.indexOf(a)+1)%c.length]}function sf(a,c){return a.map(function(a,d){return qf(a,function(a){a.h[d]=rf(a.h[d],c)})})}function tf(a){return a.map(function(a,b){return qf(a,function(a){a.h[0]=b})})}
function uf(a,c,b,d,e,f,g,k){var l=Math.pow(10,Math.round(Math.log10(Math.abs(g-f)/k/10)));return new Da(c,b,d,e,null,function(c){c.h[a]=l*Math.round(Math.min(g,c.h[a]+(g-f)/(k-1))/l)},function(c){c.h[a]=l*Math.round(Math.max(f,c.h[a]-(g-f)/(k-1))/l)})}
function vf(a,c,b,d,e){var f=.5+.37*Math.cos(Math.PI*(.5-2*(a-.3)/c)),g=.5-.37*Math.sin(Math.PI*(.5-2*(a-.3)/c)),k=.5+.37*Math.cos(Math.PI*(.5-2*(a+.3)/c));a=.5-.37*Math.sin(Math.PI*(.5-2*(a+.3)/c));return new Da(Math.min(g,a)-.1,Math.min(f,k)-.1,Math.max(g,a)+.1,Math.max(f,k)+.1,b,d,e)}function wf(a){for(var c=[],b=[1,3,2,0],d=0;4>d;d++)c.push(vf(d+.5,4,function(c){return function(d){d.h[b[c]]=rf(d.h[b[c]],a)}}(d),null,null));return c}
function xf(){for(var a=[],c=0;8>c;c++)a.push(vf(c,8,function(a){return function(c){c.h[0]=a}}(c),function(a){a.h[0]=(a.h[0]+1)%8},function(a){a.h[0]=(a.h[0]+7)%8}));return a}
var G=[new y({name:"!stop",type:"h"}),new y({name:"!stop and blink",type:"h"}),new y({name:"!init",type:"h"}),new y({name:"!volume",type:"h"}),new y({name:"!trace",type:"h"}),new y(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI},{C:"t",x:.3,y:0,r:Math.PI/2},{C:"t",x:-.3,y:0,r:-Math.PI/2}];return{name:"button 1",type:"e",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){Oe(c);b=b.h[0];c.buttons(a,[0==b,1==b,2==b,3==b,4==b])},fa:function(c,b,d,e,f,g,k){c=
gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[0]=c,F(b));return c}}}()),new y(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI},{C:"t",x:.3,y:0,r:Math.PI/2},{C:"t",x:-.3,y:0,r:-Math.PI/2}];return{name:"button",va:["c"],type:"e",sa:function(){return[!1,!1,!1,!1,!1]},fb:function(){return[!1,!1,!0,!1,!0]},ha:new A(sf(a,[!1,!0])),J:function(c,b){Oe(c);c.buttons(a,b.h)},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[c]=!b.h[c],F(b));return c},Vc:function(a){for(var c=
0;5>c;c++)if(a.h[c])return null;return new Na("No button specified",!0)}}}()),new y(function(){var a=[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},{C:"r",x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox",va:["b"],type:"e",sa:function(){return[0,0,0,0,0,0,0]},fb:function(){return[0,1,-1,1,-1,0,0]},ha:new A(sf(a,[0,1,-1])),J:function(c,b){Oe(c);c.buttons(a,b.h,{me:-1})},
fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[c]=(b.h[c]+2)%3-1,F(b));return c},Vc:function(a){for(var c=0;7>c;c++)if(a.h[c])return null;return new Na("No proximity sensor specified",!0)},jd:function(a,b){switch(b){case "a":return b=new B(Ia("horiz prox adv"),null,null),b.h=a.h.concat(b.h.slice(7)),b;default:return a}}}}()),new y(function(){var a=[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},{C:"r",
x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox adv",va:["c"],type:"e",sa:function(){return[0,0,0,0,0,0,0,.1,.4]},fb:function(){return[0,1,2,1,2,3,3,.1,.4]},ha:new A(sf(a,[0,1,2,3]).concat(uf(7,.6,-.05,.8,1.05,.25,.75,3),uf(8,.38,-.05,.58,1.05,.25,.75,3))),J:function(c,b){Oe(c);c.buttons(a,b.h,{tg:["white","red","#333","#888"],Lg:["#aaa","black","black","black"],me:2});hf(c,b.h[8],.02,!1,"red",2);hf(c,b.h[7],-.2,!1,"black",1)},fa:function(c,b,d,e,
f,g,k){c=gf(a,d,e,f,g,k);return null!==c?(D(b),b.h[c]=(b.h[c]+1)%4,F(b),c):jf(.02,!1,d,e,f,g,k)?(D(b),8):jf(-.2,!1,d,e,f,g,k)?(D(b),7):null},Qa:function(a,b,d,e,f,g,k,l){7<=d&&(b.h[d]=Math.max(0,Math.min(1,kf(!1,e,f,g,k,l))),F(b))},Vc:function(a){for(var c=0;7>c;c++)if(a.h[c])return null;return new Na("No sensor specified",!0)},jd:function(a,b){switch(b){case "b":if(b=a.T.sa(),a.h[7]===b[7]&&a.h[8]===b[8])return b=new B(Ia("horiz prox"),null,null),b.h=a.h.slice(0,7),b;default:return a}}}}()),new y(function(){var a=
[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},{C:"r",x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox 1",va:["a"],type:"e",sa:function(){return[0,0,0,0,0,0,0,.25]},fb:function(){return[0,1,-1,1,-1,0,0,.25]},ha:new A(sf(a,[0,1,-1]).concat(uf(7,.4,-.05,.6,1.05,.25,.75,3))),J:function(c,b){Oe(c);c.buttons(a,b.h,{me:-1});hf(c,b.h[7],-.1,!1,"black",1)},fa:function(c,b,d,e,f,
g,k){c=gf(a,d,e,f,g,k);return null!==c?(D(b),b.h[c]=(b.h[c]+2)%3-1,F(b),c):jf(-.1,!1,d,e,f,g,k)?(D(b),7):null},Qa:function(a,b,d,e,f,g,k,l){7<=d&&(b.h[d]=Math.max(.25,Math.min(.75,Math.round(4*kf(!1,e,f,g,k,l))/4)),F(b))},Vc:function(a){for(var c=0;7>c;c++)if(a.h[c])return null;return new Na("No sensor specified",!0)},jd:function(a,b){switch(b){case "b":if(b=a.T.sa(),a.h[7]===b[7])return b=new B(Ia("horiz prox"),null,null),b.h=a.h.slice(0,7),b;default:return a}}}}()),new y(function(){var a=[{C:"r",
x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground",va:["b"],type:"e",sa:function(){return[0,0]},fb:function(){return[1,-1]},ha:new A(sf(a,[0,1,-1])),J:function(c,b){Oe(c,{Kc:!0});c.buttons(a,b.h,{me:-1})},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[c]=(b.h[c]+2)%3-1,F(b));return c},Vc:function(a){return a.h[0]||a.h[1]?null:new Na("No ground sensor specified",!0)},jd:function(a,b){switch(b){case "a":return b=new B(Ia("ground adv"),null,null),b.h=a.h.concat(b.h.slice(2)),
b;default:return a}}}}()),new y(function(){var a=[{C:"r",x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground adv",va:["c"],type:"e",sa:function(){return[0,0,.4,.6]},fb:function(){return[1,2,.4,.6]},ha:new A(sf(a,[0,1,2,3]).concat(uf(2,.6,-.05,.8,1.05,.25,.75,3),uf(3,.38,-.05,.58,1.05,.25,.75,3))),J:function(c,b){Oe(c,{Kc:!0});c.buttons(a,b.h,{tg:["white","red","#333","#888"],Lg:["#aaa","black","black","black"],me:2});hf(c,b.h[3],.02,!1,"red",2);hf(c,b.h[2],-.2,!1,"black",1)},fa:function(c,
b,d,e,f,g,k){c=gf(a,d,e,f,g,k);return null!==c?(D(b),b.h[c]=(b.h[c]+1)%4,F(b),c):jf(.02,!1,d,e,f,g,k)?(D(b),3):jf(-.2,!1,d,e,f,g,k)?(D(b),2):null},Qa:function(a,b,d,e,f,g,k,l){2<=d&&(b.h[d]=Math.max(0,Math.min(1,kf(!1,e,f,g,k,l))),F(b))},Vc:function(a){return a.h[0]||a.h[1]?null:new Na("No ground sensor specified",!0)},jd:function(a,b){switch(b){case "b":if(b=a.T.sa(),a.h[2]===b[2]&&a.h[3]===b[3])return b=new B(Ia("ground"),null,null),b.h=a.h.slice(0,2),b;default:return a}}}}()),new y(function(){var a=
[{C:"r",x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground 1",va:["a"],type:"e",sa:function(){return[0,0,.5]},fb:function(){return[1,-1,.5]},ha:new A(sf(a,[0,1,-1]).concat(uf(2,.4,-.05,.6,1.05,.25,.75,3))),J:function(c,b){Oe(c,{Kc:!0});c.buttons(a,b.h,{me:-1});hf(c,b.h[2],0,!1,"black",1)},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);return null!==c?(D(b),b.h[c]=(b.h[c]+2)%3-1,F(b),c):jf(0,!1,d,e,f,g,k)?(D(b),2):null},Qa:function(a,b,d,e,f,g,k,l){2<=d&&(b.h[d]=Math.max(.25,Math.min(.75,
Math.round(4*kf(!1,e,f,g,k,l))/4)),F(b))},Vc:function(a){return a.h[0]||a.h[1]?null:new Na("No ground sensor specified",!0)},jd:function(a,b){switch(b){case "b":if(b=a.T.sa(),a.h[2]===b[2])return b=new B(Ia("ground"),null,null),b.h=a.h.slice(0,2),b;default:return a}}}}()),new y({name:"tap",va:["b","a"],type:"e",J:function(a){a.N.translate(.05*a.A.m,0);Se(a);Te(a)},jd:function(a,c){switch(c){case "a":return new B(Ia("accelerometer"),null,null);default:return a}}}),new y(function(){var a=[{C:"c",x:-.33,
y:-.3,r:0},{C:"c",x:0,y:-.3,r:0},{C:"c",x:.33,y:-.3,r:0}];return{name:"accelerometer",va:["c"],type:"e",sa:function(){return[0,0]},ha:new A(tf(a).concat(new Da(.1,.1,.9,.9,null,function(a){a.h[1]=0===a.h[0]?0:1===a.h[0]?Math.min(a.h[1]+1,6):Math.max(a.h[1]-1,-6)},function(a){a.h[1]=0===a.h[0]?0:1===a.h[0]?Math.max(a.h[1]-1,-6):Math.min(a.h[1]+1,6)}))),J:function(c,b){var d=b.h[0];b=b.h[1];0===d?(c.N.save(),c.N.translate(.08*c.A.m,-.2*c.A.m),Se(c),Te(c),c.N.restore()):Xe(c,2===d,2===d?-b:b);c.buttons(a,
[0===d,1===d,2===d])},fa:function(c,b,d,e,f,g,k){if(0!==b.h[0]&&Ye(d,f,g,k))return D(b),1;c=gf(a,d,e,f,g,k);return null!==c?(D(b),b.h[0]=c,F(b),2):null},Qa:function(a,b,d,e,f,g,k,l){1===d&&(a=Ze(e,g,k,l),b.h[1]=2===b.h[0]?-a:a,F(b))},jd:function(a,b){switch(b){case "b":if(0===a.h[0])return new B(Ia("tap"),null,null);default:return a}}}}()),new y({name:"roll",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},ha:new A([new Da(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},
function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){Xe(a,!1,c.h[0])},fa:function(a,c,b,d,e,f,g){return Ye(b,e,f,g,!0)?(D(c),1):null},Qa:function(a,c,b,d,e,f,g,k){c.h[0]=Ze(d,f,g,k,!0);F(c)}}),new y({name:"pitch",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},ha:new A([new Da(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){Xe(a,!0,c.h[0])},fa:function(a,c,b,d,e,f,g){return Ye(b,e,f,g,!0)?(D(c),1):null},Qa:function(a,
c,b,d,e,f,g,k){c.h[0]=Ze(d,f,g,k,!0);F(c)}}),new y({name:"yaw",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},ha:new A([new Da(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){var b=a.N,d=a.A;c=c.h[0]*Math.PI/12;b.save();b.translate(.5*d.m,.5*d.m);b.rotate(c);We(a);b.translate(-d.m/2,-d.m/2);Oe(a,{Kc:!0,scale:.45});b.restore()},fa:function(a,c,b,d,e,f,g){return Ye(b,e,f,g,!0)?(D(c),1):null},Qa:function(a,c,b,d,e,f,
g,k){c.h[0]=Ze(d,f,g,k,!0);F(c)}}),new y({name:"clap",type:"e",J:function(a){var c=a.N;a=a.A;c.save();c.beginPath();c.arc(.7*a.m,.6*a.m,.15*a.m,0,2*Math.PI);c.fillStyle="white";c.fill();c.beginPath();c.moveTo(.7*a.m,.6*a.m);c.lineTo(.8*a.m,.95*a.m);c.strokeStyle="white";c.lineWidth=.13*a.m;c.stroke();c.lineWidth=1.5*a.ua;c.translate(.3*a.m,.3*a.m);c.rotate(.1);for(var b=0;9>b;b++)c.beginPath(),c.moveTo(.07*a.m,0),c.lineTo(.14*a.m,0),c.moveTo(.17*a.m,0),c.lineTo(.22*a.m,0),c.stroke(),c.rotate(Math.PI/
4.5);c.restore()}}),new y({name:"init",va:["b","a"],type:"e",J:function(a){var c=a.N;a=a.A;var b=.4*a.m;c.save();c.fillStyle="black";c.strokeStyle="black";c.lineWidth=a.ua;c.beginPath();c.arc(.3*a.m,.5*a.m,.08*a.m,0,2*Math.PI);c.fill();c.beginPath();c.moveTo(.42*a.m,.5*a.m);c.lineTo(.7*a.m,.5*a.m);c.stroke();b*=.4;c.beginPath();c.moveTo(.8*a.m,.5*a.m);c.lineTo(.8*a.m-b*Math.sqrt(3)/2,.5*a.m+b/2);c.lineTo(.8*a.m-b*Math.sqrt(3)/2,.5*a.m-b/2);c.fill();c.restore()},sh:!0}),new y({name:"timer",va:["a"],
type:"e",J:function(a){af(a,0,!0,!1)}}),new y(function(){var a=[{C:"c",x:.3,y:.2},{C:"c",x:.3,y:-.2}];return{name:"clock",va:[],type:"e",sa:function(){return[10]},ha:new A([qf(a[0],function(a){a.h[0]=10}),qf(a[1],function(a){a.h[0]=20})]),J:function(c,b){Oe(c);var d=c.A.m;bf(c.N,.1*d,.6*d,.3*d,.15*d,4,{style:10===b.h[0]?"black":"#222",lineWidth:c.A.ua});bf(c.N,.1*d,.6*d,.7*d,.15*d,8,{style:20===b.h[0]?"black":"#222",lineWidth:c.A.ua});c.buttons(a,[10===b.h[0],20===b.h[0]])},fa:function(c,b,d,e,f,
g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[0]=0===c?10:20,F(b));return c}}}()),new y(function(){var a=[{C:"t",x:-.25,y:0,r:-Math.PI/2},{C:"t",x:0,y:.25,r:0},{C:"t",x:0,y:-.25,r:Math.PI},{C:"t",x:.25,y:0,r:Math.PI/2},{C:"c",x:0,y:0,r:0}];return{name:"remote control arrows",va:[],type:"e",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){var d=c.N,e=c.A;d.save();d.fillStyle="#eee";d.fillRect(.1*e.m,e.ua,.8*e.m,e.m-2*e.ua);d.restore();b=b.h[0];c.buttons(a,[0==b,1==b,2==b,3==b,4==b])},fa:function(c,
b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[0]=c,F(b));return c}}}()),new y(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"user event",va:["a"],type:"e",sa:function(){return[0]},ha:new A([new Da(0,0,1,.4,null,function(a){a.h[0]=Math.min(9,a.h[0]+1)},function(a){a.h[0]=Math.max(0,a.h[0]-1)})]),J:function(c,b){c.text(b.h[0].toString(10),{x:-.3*c.A.m,fillStyle:"black"});c.buttons(a,[9>b.h[0]?-2:0,0<b.h[0]?-2:0]);Oe(c,{scale:.45,cf:[-.15*c.A.m,-.1*c.A.m]});
fd(c.N,.75*c.A.m,.05*c.A.m,.375*c.A.m,2.2,2.8,{Bd:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua})},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);if(null!==c){D(b);switch(c){case 0:b.h[0]=Math.min(9,b.h[0]+1);break;case 1:b.h[0]=Math.max(0,b.h[0]-1)}F(b)}return c}}}()),new y({name:"state",va:["a"],type:"s",sa:function(){return[0,0,0,0]},fb:function(){return[1,0,0,-1]},ha:new A(wf([0,1,-1])),J:function(a,c){Oe(a);ef(a,c.h)},fa:function(a,c,b,d,e,f,g){a=of(b,d,e,f,g);null!==a&&(D(c),c.h[a]=(c.h[a]+2)%
3-1,F(c));return a},jd:function(a,c){return"b"===c&&0===a.h[0]&&0===a.h[1]&&0===a.h[2]&&0===a.h[3]?null:a}}),new y({name:"state 8",va:["c"],type:"s",sa:function(){return[0]},ha:new A(xf()),J:function(a,c){Oe(a);ff(a,c.h[0])},fa:function(a,c,b,d,e,f,g){a=pf(b,d,e,f,g);null!==a&&(D(c),c.h[0]=a,F(c));return a}}),new y(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI},{C:"t",x:.1,y:.3,r:0},{C:"t",x:.1,y:-.3,r:Math.PI},{C:"c",x:.35,y:-.3,r:0}];return{name:"counter comparison",va:["a"],
type:"s",sa:function(){return[0,0]},ha:new A([new Da(0,0,1,.4,null,function(a){a.h[0]=Math.min(1,a.h[0]+1)},function(a){a.h[0]=Math.max(-1,a.h[0]-1)}),new Da(0,.4,1,.8,null,function(a){a.h[1]=Math.min(255,a.h[1]+1)},function(a){a.h[1]=Math.max(0,a.h[1]-1)}),qf(a[4],function(a){a.h[1]=0})]),J:function(c,b){c.text(0===b.h[0]?"=":0<b.h[0]?"\u2265":"\u2264",{x:-.3*c.A.m,fillStyle:"black"});c.text(b.h[1].toString(10),{x:.1*c.A.m,fillStyle:"black"});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0,255>b.h[1]?
-2:0,0<b.h[1]?-2:0,0!==b.h[1]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);if(null!==c){D(b);switch(c){case 0:b.h[0]=Math.min(1,b.h[0]+1);break;case 1:b.h[0]=Math.max(-1,b.h[0]-1);break;case 2:b.h[1]=Math.min(255,b.h[1]+1);break;case 3:b.h[1]=Math.max(0,b.h[1]-1);break;case 4:b.h[1]=0}F(b)}return c}}}()),new y({name:"color state",va:["c"],type:"s",sa:function(){return[0,0,0]},ha:new A([uf(0,.1,-.05,.3,1.05,0,1,2),uf(1,.4,-.05,.6,1.05,0,1,2),uf(2,.7,-.05,.9,1.05,0,1,2)]),J:function(a,c){Oe(a,
{mc:c.h});hf(a,c.h[0],.3,!1,"red");hf(a,c.h[1],0,!1,"#0c0");hf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return jf(.3,!1,b,d,e,f,g)?(D(c),0):jf(0,!1,b,d,e,f,g)?(D(c),1):jf(-.3,!1,b,d,e,f,g)?(D(c),2):null},Qa:function(a,c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,Math.round(kf(!1,d,e,f,g,k))));F(c)}}),new y(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,
v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"color 8 state",va:["a"],type:"s",sa:function(){return[0]},
ha:new A(tf(a)),J:function(c,b){Oe(c,{mc:[b.h&1,(b.h&2)/2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h=[c],F(b));return c}}}()),new y({name:"motor state",va:["c"],type:"s",sa:function(){return[0,0]},ha:new A([uf(0,-.05,0,1.05,.2,-1,1,3),uf(1,-.05,.8,1.05,1,-1,1,3)]),J:function(a,c){var b=Qe(a,2.4*c.h[0],2.4*c.h[1],.19);Oe(a,{Kc:!0,scale:.45,rotation:b.kb,cf:[.19*b.x*a.A.m+.13*a.A.m*Math.sin(b.kb),.19*b.y*a.A.m+.13*a.A.m*
Math.cos(b.kb)]});a.N.save();a.N.globalAlpha=.2;Qe(a,2.4*c.h[0],2.4*c.h[1],.19);a.N.restore();hf(a,.5+.5*c.h[0],-.4,!0,0===c.h[0]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0");hf(a,.5+.5*c.h[1],.4,!0,0===c.h[1]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0")},fa:function(a,c,b,d,e,f,g){return jf(-.4,!0,b,d,e,f,g)?(D(c),0):jf(.4,!0,b,d,e,f,g)?(D(c),1):Re(a,b,e,f,.5*c.h[0],.5*c.h[1],g)?(D(c),2):null},Qa:function(a,c,b,d,e,f,g,k){2>b?(a=kf(!0,d,e,f,g,k),c.h[b]=.25>a?-1:
.75<a?1:0):(a=kf(!0,d,e,f,g,k),a=.25>a?-1:.75<a?1:0,c.h[0]=a,c.h[1]=a);F(c)}}),new y({name:"motor",type:"a",sa:function(){return[0,0]},fb:function(){return[.5,.2]},ha:new A([uf(0,-.05,0,1.05,.2,-1,1,11),uf(1,-.05,.8,1.05,1,-1,1,11)]),J:function(a,c){var b=Qe(a,2.4*c.h[0],2.4*c.h[1],.19);Oe(a,{Kc:!0,scale:.45,rotation:b.kb,cf:[.19*b.x*a.A.m+.13*a.A.m*Math.sin(b.kb),.19*b.y*a.A.m+.13*a.A.m*Math.cos(b.kb)]});a.N.save();a.N.globalAlpha=.2;Qe(a,2.4*c.h[0],2.4*c.h[1],.19);a.N.restore();hf(a,.5+.5*c.h[0],
-.4,!0,0===c.h[0]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0");hf(a,.5+.5*c.h[1],.4,!0,0===c.h[1]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0")},fa:function(a,c,b,d,e,f,g){return jf(-.4,!0,b,d,e,f,g)?(D(c),0):jf(.4,!0,b,d,e,f,g)?(D(c),1):Re(a,b,e,f,.5*c.h[0],.5*c.h[1],g)?(D(c),2):null},Qa:function(a,c,b,d,e,f,g,k){2>b?(a=2*kf(!0,d,e,f,g,k)-1,d=c.h[1-b],.1>Math.abs(a)?a=0:.1>Math.abs(a-d)?a=d:.1>Math.abs(a+d)&&(a=-d),c.h[b]=Math.max(-1,Math.min(1,a))):(a=2*kf(!0,
d,e,f,g,k)-1,a=.1>Math.abs(a)?0:Math.max(-1,Math.min(1,a)),.05>Math.abs(c.h[0]-c.h[1])?(c.h[0]=a,c.h[1]=a):Math.abs(c.h[0])>Math.abs(c.h[1])?(c.h[1]*=a/c.h[0],c.h[0]=a):(c.h[0]*=a/c.h[1],c.h[1]=a));F(c)}}),new y(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.35,r:0},{C:"t",x:0,y:-.35,r:Math.PI},{C:"t",x:-.3,y:.32,r:-.4},{C:"t",x:.3,y:.32,r:.4},{C:"t",x:-.35,y:.05,r:-Math.PI/2},{C:"t",x:.35,y:.05,r:Math.PI/2}];return{name:"move",va:["c"],type:"a",sa:function(){return[0]},J:function(c,b){Oe(c,
{Kc:!0,scale:.45});c.buttons(a,[0===b.h[0]?1:-2,1===b.h[0]?1:-2,2===b.h[0]?1:-2,3===b.h[0]?1:-2,4===b.h[0]?1:-2,5===b.h[0]?1:-2,6===b.h[0]?1:-2])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[0]=c,F(b));return c}}}()),new y({name:"nn obstacles",va:[],type:"a",sa:function(){return[0,0,0,0]},fb:function(){return[.3,.2,.1,.3]},ha:new A([new Da(0,0,.25,1,null,function(a){a.h[0]=Math.min(1,a.h[0]+.1)},function(a){a.h[0]=Math.max(0,a.h[0]-.1)},function(a,c){console.info(c)}),new Da(.25,
0,.5,1,null,function(a){a.h[1]=Math.min(1,a.h[1]+.1)},function(a){a.h[1]=Math.max(0,a.h[1]-.1)},function(a,c){console.info(c)}),new Da(.5,0,.75,1,null,function(a){a.h[2]=Math.min(1,a.h[2]+.1)},function(a){a.h[2]=Math.max(0,a.h[2]-.1)},function(a,c){console.info(c)}),new Da(.75,0,1,1,null,function(a){a.h[3]=Math.min(1,a.h[3]+.1)},function(a){a.h[3]=Math.max(0,a.h[3]-.1)},function(a,c){console.info(c)})]),J:function(a,c,b,d){b=d?.5:1;var e=a.N,f=a.A;e.save();d&&e.scale(b,b);e.fillStyle="white";e.font=
f.ng;e.textAlign="center";e.textBaseline="middle";e.translate(.5*f.m,.5*f.m);e.translate(-.5*f.m,-.5*f.m);d?(e.fillText("\u21d1",.25*f.m,.35*f.m),e.fillText(c.h[0].toFixed(1),.6*f.m,.35*f.m),e.fillText("\u21a7",.25*f.m,.81*f.m),e.fillText(c.h[1].toFixed(1),.6*f.m,.81*f.m),e.fillText("+",.25*f.m,1.27*f.m),e.fillText(c.h[2].toFixed(1),.6*f.m,1.27*f.m),e.fillText("\u2212",.25*f.m,1.69*f.m),e.fillText(c.h[3].toFixed(1),.6*f.m,1.69*f.m),e.translate(f.m,0),hf(a,c.h[0],.15,!1,"white"),hf(a,c.h[1],-.3,!1,
"white"),hf(a,c.h[2],-.75,!1,"white"),hf(a,c.h[3],-1.2,!1,"white")):(e.fillText("\u21d1",.25*f.m,.17*f.m),e.fillText(c.h[0].toFixed(1),.6*f.m,.17*f.m),e.fillText("\u21a7",.25*f.m,.4*f.m),e.fillText(c.h[1].toFixed(1),.6*f.m,.4*f.m),e.fillText("+",.25*f.m,.63*f.m),e.fillText(c.h[2].toFixed(1),.6*f.m,.63*f.m),e.fillText("\u2212",.25*f.m,.87*f.m),e.fillText(c.h[3].toFixed(1),.6*f.m,.87*f.m));e.restore()},Ie:!0,fa:function(a,c,b,d,e,f,g){return jf(.35,!1,b/2,d,e+b/2,f,g)?(D(c),0):jf(.12,!1,b/2,d,e+b/2,
f,g)?(D(c),1):jf(-.12,!1,b/2,d,e+b/2,f,g)?(D(c),2):jf(-.35,!1,b/2,d,e+b/2,f,g)?(D(c),3):null},Qa:function(a,c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,Math.round(20*kf(!1,d/2,e,f+d/2,g,k))/20));F(c)}}),new y({name:"top color",va:["a"],type:"a",sa:function(){return[0,0,0]},ha:new A([uf(0,.1,-.05,.3,1.05,0,1,11),uf(1,.4,-.05,.6,1.05,0,1,11),uf(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Oe(a,{mc:c.h});hf(a,c.h[0],.3,!1,"red");hf(a,c.h[1],0,!1,"#0c0");hf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,
e,f,g){return jf(.3,!1,b,d,e,f,g)?(D(c),0):jf(0,!1,b,d,e,f,g)?(D(c),1):jf(-.3,!1,b,d,e,f,g)?(D(c),2):null},Qa:function(a,c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,kf(!1,d,e,f,g,k)));F(c)}}),new y(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},
{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"top color 8",va:["b"],type:"a",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){Oe(c,{mc:[b.h&1,(b.h&2)/2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,
b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h=[c],F(b));return c}}}()),new y({name:"bottom color",va:["a"],type:"a",sa:function(){return[0,0,0]},ha:new A([uf(0,.1,-.05,.3,1.05,0,1,11),uf(1,.4,-.05,.6,1.05,0,1,11),uf(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Oe(a,{Kc:!0,mc:c.h});hf(a,c.h[0],.3,!1,"red");hf(a,c.h[1],0,!1,"#0c0");hf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return jf(.3,!1,b,d,e,f,g)?(D(c),0):jf(0,!1,b,d,e,f,g)?(D(c),1):jf(-.3,!1,b,d,e,f,g)?(D(c),2):null},Qa:function(a,
c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,kf(!1,d,e,f,g,k)));F(c)}}),new y({name:"bottom-left color",va:["c"],type:"a",sa:function(){return[0,0,0]},ha:new A([uf(0,.1,-.05,.3,1.05,0,1,11),uf(1,.4,-.05,.6,1.05,0,1,11),uf(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Oe(a,{Kc:!0,mc:c.h,zf:"left"});hf(a,c.h[0],.3,!1,"red");hf(a,c.h[1],0,!1,"#0c0");hf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return jf(.3,!1,b,d,e,f,g)?(D(c),0):jf(0,!1,b,d,e,f,g)?(D(c),1):jf(-.3,!1,b,d,e,f,g)?(D(c),2):null},
Qa:function(a,c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,kf(!1,d,e,f,g,k)));F(c)}}),new y({name:"bottom-right color",va:["c"],type:"a",sa:function(){return[0,0,0]},ha:new A([uf(0,.1,-.05,.3,1.05,0,1,11),uf(1,.4,-.05,.6,1.05,0,1,11),uf(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Oe(a,{Kc:!0,mc:c.h,zf:"right"});hf(a,c.h[0],.3,!1,"red");hf(a,c.h[1],0,!1,"#0c0");hf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return jf(.3,!1,b,d,e,f,g)?(D(c),0):jf(0,!1,b,d,e,f,g)?(D(c),1):jf(-.3,!1,b,d,e,f,g)?
(D(c),2):null},Qa:function(a,c,b,d,e,f,g,k){c.h[b]=Math.max(0,Math.min(1,kf(!1,d,e,f,g,k)));F(c)}}),new y(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",
x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom color 8",va:["b"],type:"a",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){Oe(c,{Kc:!0,mc:[b.h&1,(b.h&2)/2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h=[c],F(b));return c}}}()),
new y(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,
v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom-left color 8",va:["c"],type:"a",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){Oe(c,{Kc:!0,mc:[b.h&1,(b.h&2)/2,(b.h&4)/4],zf:"left"});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h=[c],F(b));return c}}}()),new y(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",
strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",
fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom-right color 8",va:["c"],type:"a",sa:function(){return[0]},ha:new A(tf(a)),J:function(c,b){Oe(c,{Kc:!0,mc:[b.h&1,(b.h&2)/2,(b.h&4)/4],zf:"right"});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h=[c],F(b));return c}}}()),new y({name:"notes",type:"a",sa:function(){return[0,1,1,1,2,1,0,1,2,1,4,2]},ha:new A(function(a,c,b,d,e,f){var g=[];for(b=0;b<e;b++)(function(b){g.push(new Da(.1,
a+b*(c-a)/e,.9,a+(b+1)*(c-a)/e,function(a){a.h[2*b+1]=rf(a.h[2*b+1],[0,1,2])},function(a){0===a.h[2*b+1]?(a.h[2*b]=0,a.h[2*b+1]=1):a.h[2*b]=Math.min(a.h[2*b]+1,f-1)},function(a){0===a.h[2*b+1]?(a.h[2*b]=0,a.h[2*b+1]=1):a.h[2*b]=Math.max(a.h[2*b]-1,0)},function(a,c,d){c=f-1-Math.floor(d*f*.9999);0===a.h[2*b+1]?(a.h[2*b]=c,a.h[2*b+1]=1):a.h[2*b]===c?a.h[2*b+1]=rf(a.h[2*b+1],[0,1,2]):a.h[2*b]=c}))})(b);return g}(.1,.9,.9,.1,6,5)),J:function(a,c){c=c.h;var b=a.N,d=a.A;b.save();b.fillStyle="#eee";for(var e=
0;5>e;e++)b.fillRect(.1*d.m,d.m*(.1+.16*e),.8*d.m,.16*d.m-d.ua);Ue(a,c,.1,.9,.9,.1,5,.14,1);b.restore()},fa:function(a,c,b,d,e,f,g){return(a=lf(.1,.9,.9,.1,6,5,b,d,e,f,g))?(D(c),c.h[2*a.index]===a.tone?c.h[2*a.index+1]=(c.h[2*a.index+1]+1)%3:(c.h[2*a.index]=a.tone,c.h[2*a.index+1]=1),F(c),0):null}}),new y(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"play",va:["c"],type:"a",sa:function(){return[0]},ha:new A([new Da(0,0,1,.4,null,function(a){a.h[0]=(a.h[0]+1)%
100},function(a){a.h[0]=(a.h[0]+99)%100})]),J:function(c,b){Ve(c,b.h[0]);c.buttons(a,[-2,-2])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);if(null!==c){D(b);switch(c){case 0:b.h[0]=(b.h[0]+1)%100;break;case 1:b.h[0]=(b.h[0]+99)%100}F(b)}return c}}}()),new y({name:"play stop",va:["c"],type:"a",J:function(a){Ve(a,null)}}),new y({name:"set state",va:["a"],type:"a",sa:function(){return[0,0,0,0]},fb:function(){return[0,1,-1,0]},ha:new A(wf([0,1,-1])),J:function(a,c){Oe(a);ef(a,c.h)},fa:function(a,c,b,
d,e,f,g){a=of(b,d,e,f,g);null!==a&&(D(c),c.h[a]=(c.h[a]+2)%3-1,F(c));return a}}),new y({name:"toggle state",va:["c"],type:"a",sa:function(){return[!1,!1,!1,!1]},fb:function(){return[!0,!1,!1,!1]},ha:new A(wf([!1,!0])),J:function(a,c){Oe(a);ef(a,c.h.map(function(a){return a?2:0}));fd(a.N,a.A.m/2,a.A.m/2,.2*a.A.m,-1.4,1.4,{style:"black",lineWidth:a.A.ua,Xc:5*a.A.ua});fd(a.N,a.A.m/2,a.A.m/2,.2*a.A.m,Math.PI-1.4,Math.PI+1.4,{style:"black",lineWidth:a.A.ua,Xc:5*a.A.ua})},fa:function(a,c,b,d,e,f,g){a=of(b,
d,e,f,g);null!==a&&(D(c),c.h[a]=!c.h[a],F(c));return a}}),new y({name:"set state 8",va:["c"],type:"a",sa:function(){return[0]},ha:new A(xf()),J:function(a,c){Oe(a);ff(a,c.h[0])},fa:function(a,c,b,d,e,f,g){a=pf(b,d,e,f,g);null!==a&&(D(c),c.h[0]=a,F(c));return a}}),new y(function(){var a=[{C:"c",x:-.2,y:0},{C:"c",x:.2,y:0}];return{name:"change state 8",va:["c"],type:"a",sa:function(){return[1]},ha:new A([qf(a[0],function(a){a.h[0]=-1}),qf(a[1],function(a){a.h[0]=1})]),J:function(c,b){Oe(c);var d=c.N;
d.save();for(var e=0;8>e;e++)df(c,Math.PI*(.46-.25*e),Math.PI*(.54-.25*e),0);d.restore();fd(c.N,c.A.m/2,c.A.m/2,.375*c.A.m,-.8,.8,{style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua});fd(c.N,c.A.m/2,c.A.m/2,.375*c.A.m,Math.PI-.8,Math.PI+.8,{Bd:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua});c.buttons(a,[0>b.h[0],0<b.h[0]])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);null!==c&&(D(b),b.h[0]=0===c?-1:1,F(b));return c}}}()),new y(function(){var a=[{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI}];return{name:"set counter",
va:["a"],type:"a",sa:function(){return[0]},ha:new A([new Da(.1,.25,.9,.75,null,function(a){a.h[0]=Math.min(1,a.h[0]+1)},function(a){a.h[0]=Math.max(-1,a.h[0]-1)})]),J:function(c,b){c.text(0===b.h[0]?"= 0":0<b.h[0]?"+1":"\u22121");c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);if(null!==c){D(b);switch(c){case 0:b.h[0]=Math.min(1,b.h[0]+1);break;case 1:b.h[0]=Math.max(-1,b.h[0]-1)}F(b)}return c}}}()),new y({name:"set timer",va:["a"],type:"a",sa:function(){return[1]},
ha:new A([new Da(.13,.14,.93,.96,null,function(a){a.h[0]=Math.min(a.h[0]+.1,4)},function(a){a.h[0]=Math.max(a.h[0]-.1,0)})]),J:function(a,c){af(a,c.h[0],!1,!1)},fa:function(a,c,b,d,e,f,g){return mf(b,d,e,f,g)?(D(c),1):null},Qa:function(a,c,b,d,e,f,g,k){c.h[0]=nf(d,e,f,g,!1,k);F(c)}}),new y({name:"set timer log",va:["c"],type:"a",sa:function(){return[1]},ha:new A([new Da(.13,.14,.93,.96,null,function(a){a.h[0]=Math.round(100*Math.min(1.05*a.h[0],10))/100},function(a){a.h[0]=Math.round(100*Math.max(.95*
a.h[0],.1))/100})]),J:function(a,c){af(a,c.h[0],!1,!0)},fa:function(a,c,b,d,e,f,g){return mf(b,d,e,f,g)?(D(c),1):null},Qa:function(a,c,b,d,e,f,g,k){c.h[0]=nf(d,e,f,g,!0,k);F(c)}}),new y(function(){function a(a,c){if(a.h[1]){var b=new Image;b.src=a.h[1];b.addEventListener("load",function(){a.h[2]=b;c&&c()},!1)}}var c=[{C:"c",x:-.33,y:-.3,r:0}];return{name:"picture comment",va:["a"],type:"c",sa:function(){return[!1,"",null]},Sf:function(a){return 2<=a.h.length?[!1,a.h[1]]:[!1,""]},Re:function(c,d,e){c.h=
2<=d.length?[!1,d[1]]:[!1,""];a(c,e)},J:function(a,d){d.h[2]&&a.N.drawImage(d.h[2],0,0,240,240,0,0,a.A.m,a.A.m);a.buttons(c,[d.h[0]])},fa:function(b,d,e,f,g,k,l){e=gf(c,e,f,g,k,l);0===e&&(d.h[0]?la&&(la.pause&&la.pause(),na.getTracks().forEach(function(a){a.stop()}),la=null):(D(d),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:320,height:240}}).then(function(c){na=c;la=document.createElement("video");la.srcObject=c;la.addEventListener("loadedmetadata",function(){la.play();var c=setInterval(function(){la?
(pa||(pa=document.createElement("canvas"),pa.width=240,pa.height=240),pa.getContext("2d").drawImage(la,0,0,240,240,0,0,240,240),d.h[1]=pa.toDataURL("image/png"),a(d,function(){b.qa&&b.qa();J(b)})):clearInterval(c)},100)},!1)})),d.h[0]=!d.h[0],F(d));return e}}}()),new y(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"send user event",va:["a"],type:"a",sa:function(){return[0]},ha:new A([new Da(0,0,1,.4,null,function(a){a.h[0]=Math.min(9,a.h[0]+1)},function(a){a.h[0]=
Math.max(0,a.h[0]-1)})]),J:function(c,b){c.text(b.h[0].toString(10),{x:-.3*c.A.m,fillStyle:"black"});c.buttons(a,[9>b.h[0]?-2:0,0<b.h[0]?-2:0]);Oe(c,{scale:.45,cf:[-.15*c.A.m,-.1*c.A.m]});fd(c.N,.65*c.A.m,.05*c.A.m,.375*c.A.m,.5,1.1,{Bd:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua})},fa:function(c,b,d,e,f,g,k){c=gf(a,d,e,f,g,k);if(null!==c){D(b);switch(c){case 0:b.h[0]=Math.min(9,b.h[0]+1);break;case 1:b.h[0]=Math.max(0,b.h[0]-1)}F(b)}return c}}}())];function yf(a,c){function b(a){return a instanceof Array?a.join(""):a}function d(a,c,b){return a.map(function(a){return Ca(a,c,b)})}var e=c||{};["aseba","l2","js","python"].forEach(function(c){a[c]&&(e[c]=function(e,f){var g=e?e.h:[],k={Jh:f?f.Af:1,K:0};e={};a[c].initVarDecl&&(e.ub=d(a[c].initVarDecl.map(b),g,k));a[c].initCodeDecl&&(e.tb=d(a[c].initCodeDecl.map(b),g,k));a[c].initCodeExec&&(e.Cb=d(a[c].initCodeExec.map(b),g,k));a[c].sectionBegin&&(e.da=Ca(b(a[c].sectionBegin),g,k));a[c].sectionEnd&&
(e.zb=Ca(b(a[c].sectionEnd),g,k));a[c].sectionPreamble&&(e.eb=Ca(b(a[c].sectionPreamble),g,k));a[c].clauseInit&&(e.na=Ca(b(a[c].clauseInit),g,k));if(a[c].clauseAnd){var q="";g.forEach(function(d,e){k.K=e;(d=Ca(b(a[c].clauseAnd),g,k))&&(q+=(0<q.length?" "+Ea[c].i+" ":"")+d)});e.cb=q||Ea[c].l}else a[c].clause&&(e.cb=Ca(b(a[c].clause),g,k));a[c].clauseAlwaysEval&&(e.Lf=a[c].clauseAlwaysEval);a[c].clauseAsCondition&&(e.fh=Ca(b(a[c].clauseAsCondition),g,k));e.ui=a[c].clauseOptional||!1;a[c].statement1?
e.ya=g.map(function(d,e){k.K=e;return Ca(b(a[c].statement1),g,k)}).join(""):a[c].statement&&(e.ya=Ca(b(a[c].statement),g,k));a[c].error&&(e.cb=Ca(b(a.error.error),g,k));return e})});return e};function zf(a){this.S=new DOMParser;this.b=this.S.parseFromString(a,"text/xml");this.i=this.b.documentElement;this.D=(this.i.getAttribute("viewBox")||"0 0 1 1").split(" ").map(function(a){return parseFloat(a)});this.w={}}
var Af={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",
darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",
ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",
lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",
moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",
seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function Bf(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])}function Cf(a){var c={};Bf(c,a);return c}
function Df(a,c){c.split(";").forEach(function(c){c=c.trim().split(":").map(function(a){return a.trim()});2===c.length&&(a[c[0]]=c[1])})}
function Ef(a,c,b,d,e){a&&(a=a.replace(/\s*\(\s*/g,"(").replace(/\s*\)\s*/g,")").replace(/ +,/g,",").replace(/, +/g,",").replace(/ +/g,","),a.split(")").slice(0,-1).forEach(function(a){var f=a.split("(")[0];a=a.split("(")[1].split(",").map(function(a){return parseFloat(a)});switch(f){case "translate":c(a[0]||0,a[1]||0);break;case "rotate":f=(a[0]||0)*Math.PI/180;var k=a[1]||0;a=a[2]||0;0!==k||0!==a?(c(-k,-a),b(f),c(k,a)):b(f);break;case "scale":f=a[0]||1;d(f,a[1]||f);break;case "matrix":e(a[0],a[1],
a[2],a[3],a[4],a[5]);break;default:throw"transform not implemented: "+f;}}))}function Ff(a,c){Ef(a,function(a,d){c.translate(a,d)},function(a){c.rotate(a)},function(a,d){c.scale(a,d)},function(a,d,e,f,g,k){c.wf(a,d,e,f,g,k)})}
zf.prototype.J=function(a,c){function b(e,h,m){function n(){for(var a=0;a<e.childElementCount;a++)b(e.children[a],h,m)}function w(a,c){a=e.getAttribute(a);return null===a?c||0:parseFloat(a)}function r(a,c){a=p.apply(new Gf(a,c));t.push(a.x);u.push(a.y)}function v(a,c,b){if(null==a||""==a)return c;a=/^\s*(-?[0-9.]+)\s*([a-z%]*)\s*$/i.exec(a);c=parseFloat(a[1]);switch(a[2]||"px"){case "pt":return 25.4*c/72*3;case "pc":return 25.4*c/6*3;case "in":return 25.4*c*3;case "mm":return 3*c;case "cm":return 30*
c;case "em":return 18*c;case "ex":return 9*c;case "%":return c*b/100;default:return c}}function E(b){b=b.replace(/\.([0-9]+)(?=\.)/g,".$1 ").replace(/([.0-9])-/g,"$1 -").replace(/\s*([a-z])\s*/gi,";$1").replace(/\s*,\s*/g,",").replace(/\s+/g,",");var e=0,f=0,g=0,k=0,h=0,l=0,m=[],q=[],p=!0;a&&a.beginPath();b.slice(1).split(";").forEach(function(b){var n=b[0];b=1<b.length?b.slice(1).split(",").map(function(a){return parseFloat(a)}):[];switch(n){case "M":if(2<=b.length){e=b[0];f=b[1];h=e;l=f;a&&a.moveTo(e,
f);r(e,f);p&&1<m.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(m,q,!1);p=!0;m=t.slice(-1);q=u.slice(-1);for(n=2;n+1<b.length;n+=2)e=b[n],f=b[n+1],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f}break;case "m":if(2<=b.length)for(e+=b[0],f+=b[1],h=e,l=f,a&&a.moveTo(e,f),r(e,f),p&&1<m.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(m,q,!1),p=!0,m=t.slice(-1),q=u.slice(-1),n=2;n+1<b.length;n+=2)e+=b[n],f+=b[n+1],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;
case "L":for(n=0;n+1<b.length;n+=2)e=b[n],f=b[n+1],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;case "l":for(n=0;n+1<b.length;n+=2)e+=b[n],f+=b[n+1],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;case "H":for(n=0;n<b.length;n++)e=b[n],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;case "h":for(n=0;n<b.length;n++)e+=b[n],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;
k=f;break;case "V":for(n=0;n<b.length;n++)f=b[n],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;case "v":for(n=0;n<b.length;n++)f+=b[n],a&&a.lineTo(e,f),r(e,f),m.push(t[t.length-1]),q.push(u[u.length-1]);g=e;k=f;break;case "A":for(n=0;n+6<b.length;n+=7){var w=b[n+5],ta=b[n+6],v=d(b[n],b[n+1],b[n+2]*Math.PI/180,0!=b[n+3],0==b[n+4],e,f,w,ta);e=w;f=ta;r(v.x,v.y);r(e,f);p=!1}g=e;k=f;break;case "a":for(n=0;n+6<b.length;n+=7)w=e+b[n+5],ta=f+b[n+6],v=d(b[n],b[n+1],b[n+
2]*Math.PI/180,0!=b[n+3],0==b[n+4],e,f,w,ta),e=w,f=ta,r(v.x,v.y),r(e,f),p=!1;g=e;k=f;break;case "C":for(n=0;n+5<b.length;n+=6)a&&a.bezierCurveTo(b[n],b[n+1],b[n+2],b[n+3],b[n+4],b[n+5]),e=b[n+4],f=b[n+5],g=2*e-b[n+2],k=2*f-b[n+3],r(e,f),p=!1;break;case "c":for(n=0;n+5<b.length;n+=6)a&&a.bezierCurveTo(e+b[n],f+b[n+1],e+b[n+2],f+b[n+3],e+b[n+4],f+b[n+5]),g=e+2*b[n+4]-b[n+2],k=f+2*b[n+5]-b[n+3],e+=b[n+4],f+=b[n+5],r(e,f),p=!1;break;case "S":for(n=0;n+3<b.length;n+=4)a&&a.bezierCurveTo(g,k,b[n],b[n+1],
b[n+2],b[n+3]),e=b[n+2],f=b[n+3],g=2*e-b[n],k=2*f-b[n+1],r(e,f),p=!1;break;case "s":for(n=0;n+3<b.length;n+=4)a&&a.bezierCurveTo(g,k,e+b[n],f+b[n+1],e+b[n+2],f+b[n+3]),g=e-b[n],k=f-b[n+1],e+=b[n+2],f+=b[n+3],r(e,f),p=!1;break;case "Q":for(n=0;n+3<b.length;n+=4)a&&a.quadraticCurveTo(b[n],b[n+1],b[n+2],b[n+3]),e=b[n+2],f=b[n+3],g=2*e-b[n],k=2*f-b[n+1],r(e,f),p=!1;break;case "q":for(n=0;n+3<b.length;n+=4)a&&a.quadraticCurveTo(e+b[n],f+b[n+1],e+b[n+2],f+b[n+3]),g=e+2*b[n+2]-b[n],k=f+2*b[n+3]-b[n+1],e+=
b[n+2],f+=b[n+3],r(e,f),p=!1;break;case "T":for(n=0;n+1<b.length;n+=2)a&&a.quadraticCurveTo(g,k,b[n],b[n+1]),e=b[n],f=b[n+1],g=2*e-g,k=2*f-k,r(e,f),p=!1;break;case "t":for(n=0;n+1<b.length;n+=2)a&&a.quadraticCurveTo(g,k,e+b[n],f+b[n+1]),e+=b[n],f+=b[n+1],g=2*e-g,k=2*f-k,r(e,f),p=!1;break;case "Z":case "z":e=h;f=l;a&&a.closePath();p&&1<m.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(m,q,!0);p=!0;m=[];q=[];break;default:throw"unimplemented path command: "+n;}});p&&1<m.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(m,
q,!1)}function C(b){function c(a,b){if(0<b.length){a.splice(0,a.length);for(var c=0;c<b.length&&1>c;c++){var d=(b[c].getAttribute("offset")||"0").trim(),e=/%$/.test(d)?parseFloat(d.slice(0,-1))/100:parseFloat(d),f=b[c].getAttribute("style");d={};f&&Df(d,f);isNaN(e)||(f=b[c].getAttribute("stop-color")||d["stop-color"]||"#000",Af.hasOwnProperty(f)&&(f=Af[f]),d=(b[c].getAttribute("stop-opacity")||d["stop-opacity"]||"1").trim(),d=/%$/.test(d)?parseFloat(d.slice(0,-1))/100:parseFloat(d),1!==d&&(/^#[0-9a-f]{3}$/i.test(f)?
f="rgba("+f.slice(1).split("").map(function(a){return 17*parseInt(a,16)}).map(function(a){return a.toString(10)}).join(",")+","+d.toFixed(2)+")":/^#[0-9a-f]{6}$/i.test(f)?f="rgba("+[f.slice(1,3),f.slice(3,5),f.slice(5)].map(function(a){return parseInt(a,16)}).map(function(a){return a.toString(10)}).join(",")+","+d.toFixed(2)+")":/^rgb(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(f)?f=f.slice(0,-1).replace(/\s+/g,",")+","+d.toFixed(2)+")":/^hsl(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(f)&&(f=f.slice(0,-1).replace(/\s+/g,
",")+","+d.toFixed(2)+")")),a.push({offset:e,color:f}))}}}function d(a,b){if(a.attributes["xlink:href"]){var e=a.getAttribute("xlink:href");"#"===e[0]&&(e=l.b.getElementById(e.slice(1)))&&(b=d(e,b))}b.Qd=a.attributes.x1?parseFloat(a.getAttribute("x1")):b.Qd||0;b.Sd=a.attributes.y1?parseFloat(a.getAttribute("y1")):b.Sd||0;b.Rd=a.attributes.x2?parseFloat(a.getAttribute("x2")):b.Rd||0;b.Td=a.attributes.y2?parseFloat(a.getAttribute("y2")):b.Td||0;b.cd=a.attributes.gradientUnits?a.getAttribute("gradientUnits"):
b.cd||"objectBoundingBox";b.lc=a.attributes.gradientTransform?a.getAttribute("gradientTransform"):b.lc||"";b.vb=b.vb||[];c(b.vb,a.getElementsByTagName("stop"));return b}function e(a,b){if(a.attributes["xlink:href"]){var d=a.getAttribute("xlink:href");"#"===d[0]&&(d=l.b.getElementById(d.slice(1)))&&(b=e(d,b))}b.Zc=a.attributes.cx?parseFloat(a.getAttribute("cx")):b.Zc||0;b.$c=a.attributes.cy?parseFloat(a.getAttribute("cy")):b.$c||0;b.r=a.attributes.r?parseFloat(a.getAttribute("r")):b.r||0;b.cd=a.attributes.gradientUnits?
a.getAttribute("gradientUnits"):b.cd||"objectBoundingBox";b.lc=a.attributes.gradientTransform?a.getAttribute("gradientTransform"):b.lc||"";b.vb=b.vb||[];c(b.vb,a.getElementsByTagName("stop"));return b}var f=/^url\(#(.+)\)$/.exec(b);if(f&&f[1]&&(f=l.b.getElementById(f[1])))switch(f.tagName){case "linearGradient":b=d(f,{});if("objectBoundingBox"===b.cd)throw"objectBoundingBox not supported";if(b.lc)throw f=new Hf,Ff(b.lc,f),"gradientTransform not supported";var g=a.createLinearGradient(b.Qd,b.Sd,b.Rd,
b.Td);for(f=0;f<b.vb.length;f++)g.addColorStop(b.vb[f].offset,b.vb[f].color);return g;case "radialGradient":b=e(f,{});if("objectBoundingBox"===b.cd)throw"objectBoundingBox not supported";b.lc&&(f=new Hf,Ff(b.lc,f),g=If(f,{x:b.Zc,y:b.$c}),f=b.r/Math.sqrt(Math.abs(f.b[0]*f.b[4])),b.Zc=g.x,b.$c=g.y,b.r=f);g=a.createRadialGradient(b.Zc,b.$c,0,b.Zc,b.$c,b.r);for(f=0;f<b.vb.length;f++)g.addColorStop(b.vb[f].offset,b.vb[f].color);return g}return b}function P(b,c,d,e,f,g){0>=f||0>=g?a.rect(b,c,d,e):(f=Math.min((f+
g)/2,Math.min(d,e)/2),a.moveTo(b+d-f,c),a.arc(b+d-f,c+f,f,1.5*Math.PI,2*Math.PI),a.lineTo(b+d,c+e-f),a.arc(b+d-f,c+e-f,f,0,.5*Math.PI),a.lineTo(b+f,c+e),a.arc(b+f,c+e-f,f,.5*Math.PI,Math.PI),a.lineTo(b,c+f),a.arc(b+f,c+f,f,Math.PI,1.5*Math.PI),a.closePath())}function Q(){if(a){var b=(h||"")+";"+(m||""),c={};b&&Df(c,b);"hidden"!==c.visibility&&(c.opacity&&(a.globalAlpha*=parseFloat(c.opacity)),c.fill&&"none"===c.fill||(a.fillStyle="white"===c.fill||"#fff"===c.fill||"#ffffff"===c.fill?"white":C(c.fill)||
"none",a.fill()),c.stroke&&"none"!==c.stroke&&(a.lineWidth=v(c["stroke-width"]||"1px",1,100),a.strokeStyle=c.stroke||"none",a.miterLimit=c["stroke-miterlimit"]||4,a.lineJoin=c["stroke-linejoin"]||"miter",a.lineCap=c["stroke-linecap"]||"butt",c["stroke-dasharray"]&&(a.setLineDash(c["stroke-dasharray"].split(" ").map(function(a){return parseFloat(a)})),a.lineDashOffset=c["stroke-dashoffset"]?parseFloat(c["stroke-dashoffset"]):0),a.stroke()))}}function Aa(b,d,e){if(a){var f=(h||"")+";"+(m||""),g={};
f&&Df(g,f);"hidden"!==g.visibility&&(a.font=(g["font-size"]||"12px")+" "+(g["font-family"]||"helvetica"),g.fill&&"none"!==g.fill&&(a.fillStyle="white"===g.fill||"#fff"===g.fill||"#ffffff"===g.fill?"white":c&&c.fill||"silver",a.fillText(b,d,e)),g.stroke&&"none"!==g.stroke&&(a.strokeStyle=c&&c.stroke||"black",a.strokeText(b,d,e)))}}function Oa(b,c){b=Jf({x:b,y:c});a.save();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(b.Y,b.ba,b.oa-b.Y,b.pa-b.ba);a.restore()}var z=e.getAttribute("id"),T=z&&c&&c.Yd&&
c.Yd[z];z=z&&c&&c.Mf&&c.Mf[z];a&&a.save();p.save();T&&a&&f(e,T);z&&a&&g(e,z);(function(){var a=(c&&c.ih||"")+";"+(e.getAttribute("style")||""),b=e.getAttribute("class");b&&q.hasOwnProperty(b)&&(a=q[b]+";"+a);h=(h||"")+";"+a;(a=e.getAttribute("fill"))&&(h+=";fill:"+a);(a=e.getAttribute("stroke"))&&(h+=";stroke:"+a);(a=e.getAttribute("stroke-width"))&&(h+="stroke-width:"+a);(a=e.getAttribute("stroke-dasharray"))&&(h+=";stroke-dasharray:"+a.split(",").join(" "));(a=e.getAttribute("stroke-dashoffset"))&&
(h+=";stroke-dashoffset:"+a);if(c&&c.style)if((a=e.getAttribute("id"))&&c.style.hasOwnProperty(a))m=(m||"")+";"+c.style[a];else for(var d in c.style)c.style.hasOwnProperty(d)&&"!"===d[0]&&d.slice(1)!==a&&(m=(m||"")+";"+c.style[d])})();T=t.length;switch(e.tagName){case "svg":p.save();k(e.getAttribute("transform"));n();p.restore();break;case "g":p.save();k(e.getAttribute("transform"));n();p.restore();break;case "path":a&&a.save();p.save();k(e.getAttribute("transform"));E(e.getAttribute("d")||"");Q();
a&&a.restore();p.restore();break;case "line":z=w("x1");var M=w("y1"),K=w("x2"),Ma=w("y2");a&&a.save();p.save();k(e.getAttribute("transform"));a&&a.beginPath();a&&a.moveTo(z,M);a&&a.lineTo(K,Ma);Q();r(z,M);r(K,Ma);c&&c.Ea&&c.Ea.line&&c.Ea.line([z,K],[M,Ma],!1);a&&a.restore();p.restore();break;case "polygon":case "polyline":z=e.getAttribute("points").trim().replace(/\s+/g," ").split(" ").map(function(a){return parseFloat(a)});if(4<=z.length){a&&a.save();p.save();k(e.getAttribute("transform"));a&&a.beginPath();
a&&a.moveTo(z[0],z[1]);r(z[0],z[1]);for(M=2;M+1<z.length;M+=2)a&&a.lineTo(z[M],z[M+1]),r(z[M],z[M+1]);"polygon"===e.tagName&&a.closePath();Q();c&&c.Ea&&c.Ea.line&&c.Ea.line(t.slice(-z.length/2),u.slice(-z.length/2),"polygon"===e.tagName);a&&a.restore();p.restore()}break;case "circle":z=w("cx");M=w("cy");K=w("r");a&&a.save();p.save();k(e.getAttribute("transform"));a&&a.beginPath();a&&a.arc(z,M,K,0,2*Math.PI);Q();r(z-K,M-K);r(z-K,M+K);r(z+K,M-K);r(z+K,M+K);c&&c.Ea&&c.Ea.Kf&&(z=t.slice(-4),M=u.slice(-4),
K=(z[3]-z[0])*(z[3]-z[0])+(M[3]-M[0])*(M[3]-M[0]),Ma=(z[2]-z[1])*(z[2]-z[1])+(M[2]-M[1])*(M[2]-M[1]),.001>Math.abs(K-Ma)/(K+Ma)&&.001>((z[3]-z[0])*(z[2]-z[1])+(M[3]-M[0])*(M[2]-M[1]))/K&&c.Ea.Kf((z[0]+z[2])/2,(M[0]+M[2])/2,Math.sqrt(K/8)));a&&a.restore();p.restore();break;case "rect":z=w("x");M=w("y");K=w("width");Ma=w("height");var ta=w("rx"),oa=w("ry",ta);ta=w("rx",oa);a&&a.save();p.save();k(e.getAttribute("transform"));a&&(a.beginPath(),0<ta||0<oa?P(z,M,K,Ma,ta,oa):a.rect(z,M,K,Ma));Q();r(z,M);
r(z,M+Ma);r(z+K,M);r(z+K,M+Ma);a&&a.restore();p.restore();break;case "text":z=w("x"),M=w("y"),a&&a.save(),p.save(),k(e.getAttribute("transform")),Aa(e.textContent,z,M),r(z,M),a&&a.restore(),p.restore()}a&&a.restore();p.restore();a&&c&&c.hh&&Oa(t.slice(T),u.slice(T))}function d(b,c,d,e,f,g,k,h,l){if(0===b||0===c)return a&&a.lineTo(h,l),new Gf(h,l);var m=Math.cos(d),n=Math.sin(d),p=(m*g+n*k)/b;k=(-n*g+m*k)/c;g=(m*h+n*l)/b;h=(-n*h+m*l)/c;l=(g-p)/2;m=(h-k)/2;n=l*l+m*m;n=Math.sqrt((1-n)/n);isNaN(n)?n=
0:e===f&&(n=-n);e=(p+g)/2+n*m;l=(k+h)/2-n*l;p=Math.atan2((k-l)/b,(p-e)/c);k=Math.atan2((h-l)/b,(g-e)/c);a&&(a.rotate(d),a.scale(b,c),f?a.arc(e,l,1,p,k,!0):a.arc(e,l,1,p,k),a.scale(1/b,1/c),a.rotate(-d));g=new Hf;g.rotate(d);g.scale(b,c);b=f?p<k?(p+k)/2+Math.PI:(p+k)/2:p<k?(p+k)/2:(p+k)/2+Math.PI;return g.apply(new Gf(e+Math.cos(b),l+Math.sin(b)))}function e(a){switch(a.tagName){case "svg":case "defs":for(var b=0;b<a.childElementCount;b++)e(a.children[b]);break;case "style":h+=a.textContent}}function f(b,
c){if(c.kb&&0!=c.kb){var d=c.Fe,e=c.Ge;if(void 0==d||void 0==e)d=l.J(null,{element:b}),b=Jf(d),d=(b.Y+b.oa)/2,e=(b.ba+b.pa)/2;a.translate(d+(c.Kb||0),e+(c.Lb||0));a.rotate(c.kb);a.translate(-d,-e)}else(c.Kb||c.Lb)&&a.translate(c.Kb,c.Lb)}function g(b,c){a.beginPath();a.rect(c.x,c.y,c.rc,c.ld);a.clip()}function k(b){Ef(b,function(b,c){a&&a.translate(b,c);p.translate(b,c)},function(b){a&&a.rotate(b);p.rotate(b)},function(b,c){a&&a.scale(b,c);p.scale(b,c)},function(b,c,d,e,f,g){a&&a.transform(b,c,d,
e,f,g);p.wf(b,c,d,e,f,g)})}var l=this,h="",q={},p=new Kf,t=[],u=[];e(this.i);(function(){h.split("}").forEach(function(a){var b=a.split("{");b[0].split(",").forEach(function(a){a=a.trim();/^\.[-a-z0-9]+/i.test(a)&&(a=a.slice(1),q[a]=q[a]?q[a]+";"+b[1]:b[1])})})})();var w=this.i;c&&c.qe?w=this.b.getElementById(c.qe):c&&c.element&&(w=c.element);if(w){c&&c.Wf&&c.Wf(a,this.D);if(a){for(var m=[],n=w.parentElement;null!=n;n=n.parentElement)m.push(n);for(n=m.length-1;0<=n;n--){var E=m[n].getAttribute("id");
(E=E&&c&&c.Yd&&c.Yd[E])&&f(m[n],E);E=m[n].getAttribute("transform");k(E)}}b(w)}return{x:t,y:u}};function Jf(a){if(0===a.x.length)return{Y:0,oa:0,ba:0,pa:0};for(var c=a.x[0],b=a.x[0],d=a.y[0],e=a.y[0],f=1;f<a.x.length;f++)c=Math.min(c,a.x[f]),b=Math.max(b,a.x[f]),d=Math.min(d,a.y[f]),e=Math.max(e,a.y[f]);return{Y:c,oa:b,ba:d,pa:e}}function Lf(a,c){if(a.w[c])return a.w[c];var b=a.J(null,{qe:c});b=Jf(b);return a.w[c]=b}
zf.prototype.$d=function(a,c,b){a=Lf(this,a);return c>=a.Y&&c<=a.oa&&b>=a.ba&&b<=a.pa};zf.prototype.Oc=function(a){return null!=this.b.getElementById(a)};zf.prototype.yg=function(a,c){a=this.b.getElementById(a);c=this.b.getElementById(c);return null!=c&&null!=a&&c.contains(a)};function Mf(a){zf.call(this,a);this.l={};this.H={};this.u={};Nf(this)}Mf.prototype=Object.create(zf.prototype);Mf.prototype.constructor=Mf;
function Nf(a){function c(a){switch(a.tagName){case "svg":case "defs":for(var b=0;b<a.childElementCount;b++)c(a.children[b]);break;case "style":f+=a.textContent}}function b(a){return a?(a=a.replace(/\s*\(\s*/g,"(").replace(/\s*\)\s*/g,")").replace(/ +,/g,",").replace(/, +/g,",").replace(/ +/g,","),a.split(")").slice(0,-1).map(function(a){var b=a.split("(")[0];a=a.split("(")[1].split(",").map(function(a){return parseFloat(a)});switch(b){case "translate":return{jb:b,F:[a[0]||0,a[1]||0]};case "rotate":return{jb:b,
F:[(a[0]||0)*Math.PI/180,a[1]||0,a[2]||0]};case "scale":var c=a[0]||1;return{jb:b,F:[c,a[1]||c]};case "matrix":return{jb:b,F:a};default:throw"transform not implemented: "+b;}})):null}function d(a,c){function f(b){for(var c=[],e=0;e<a.childElementCount;e++){var f=d(a.children[e],b);f&&c.push(f)}return c}function g(b,c){b=a.getAttribute(b);return null===b?c||0:parseFloat(b)}function k(a){a=a.replace(/\.([0-9]+)(?=\.)/g,".$1 ").replace(/([.0-9])-/g,"$1 -").replace(/\s*([a-z])\s*/gi,";$1").replace(/\s*,\s*/g,
",").replace(/\s+/g,",");var b=[],c=0,d=0,e=0,f=0,g=0,k=0;a.slice(1).split(";").forEach(function(a){var h=a[0];a=1<a.length?a.slice(1).split(",").map(function(a){return parseFloat(a)}):[];switch(h){case "M":if(2<=a.length){c=a[0];d=a[1];g=c;k=d;b.push({jb:"M",F:[c,d]});for(h=2;h+1<a.length;h+=2)c=a[h],d=a[h+1],b.push({jb:"L",F:[c,d]});e=c;f=d}break;case "m":if(2<=a.length)for(c+=a[0],d+=a[1],g=c,k=d,b.push({jb:"M",F:[c,d]}),h=2;h+1<a.length;h+=2)c+=a[h],d+=a[h+1],b.push({jb:"L",F:[c,d]});e=c;f=d;
break;case "L":for(h=0;h+1<a.length;h+=2)c=a[h],d=a[h+1],b.push({jb:"L",F:[c,d]});e=c;f=d;break;case "l":for(h=0;h+1<a.length;h+=2)c+=a[h],d+=a[h+1],b.push({jb:"L",F:[c,d]});e=c;f=d;break;case "H":for(h=0;h<a.length;h++)c=a[h],b.push({jb:"L",F:[c,d]});e=c;f=d;break;case "h":for(h=0;h<a.length;h++)c+=a[h],b.push({jb:"L",F:[c,d]});e=c;f=d;break;case "V":for(h=0;h<a.length;h++)d=a[h],b.push({jb:"L",F:[c,d]});e=c;f=d;break;case "v":for(h=0;h<a.length;h++)d+=a[h],b.push({jb:"L",F:[c,d]});e=c;f=d;break;
case "A":for(h=0;h+6<a.length;h+=7){var l=a[h+5],m=a[h+6];b.push({jb:"A",F:[a[h],a[h+1],a[h+2]*Math.PI/180,0!=a[h+3]?1:0,0==a[h+4]?1:0,c,d,l,m]});c=l;d=m}e=c;f=d;break;case "a":for(h=0;h+6<a.length;h+=7)l=c+a[h+5],m=d+a[h+6],b.push({jb:"A",F:[a[h],a[h+1],a[h+2]*Math.PI/180,0!=a[h+3],0==a[h+4],c,d,l,m]}),c=l,d=m;e=c;f=d;break;case "C":for(h=0;h+5<a.length;h+=6)b.push({jb:"C",F:a.slice(h,h+6)}),c=a[h+4],d=a[h+5],e=2*c-a[h+2],f=2*d-a[h+3];break;case "c":for(h=0;h+5<a.length;h+=6)b.push({jb:"C",F:[c+
a[h],d+a[h+1],c+a[h+2],d+a[h+3],c+a[h+4],d+a[h+5]]}),e=c+2*a[h+4]-a[h+2],f=d+2*a[h+5]-a[h+3],c+=a[h+4],d+=a[h+5];break;case "S":for(h=0;h+3<a.length;h+=4)b.push({jb:"S",F:[e,f,a[h],a[h+1],a[h+2],a[h+3]]}),c=a[h+2],d=a[h+3],e=2*c-a[h],f=2*d-a[h+1];break;case "s":for(h=0;h+3<a.length;h+=4)b.push({jb:"S",F:[e,f,c+a[h],d+a[h+1],c+a[h+2],d+a[h+3]]}),e=c-a[h],f=d-a[h+1],c+=a[h+2],d+=a[h+3];break;case "Q":for(h=0;h+3<a.length;h+=4)b.push({jb:"Q",F:[a[h],a[h+1],a[h+2],a[h+3]]}),c=a[h+2],d=a[h+3],e=2*c-a[h],
f=2*d-a[h+1];break;case "q":for(h=0;h+3<a.length;h+=4)b.push({jb:"Q",F:[c+a[h],d+a[h+1],c+a[h+2],d+a[h+3]]}),e=c+2*a[h+2]-a[h],f=d+2*a[h+3]-a[h+1],c+=a[h+2],d+=a[h+3];break;case "T":for(h=0;h+1<a.length;h+=2)b.push({jb:"Q",F:[e,f,a[h],a[h+1]]}),c=a[h],d=a[h+1],e=2*c-e,f=2*d-f;break;case "t":for(h=0;h+1<a.length;h+=2)b.push({jb:"Q",F:[e,f,c+a[h],d+a[h+1]]}),c+=a[h],d+=a[h+1],e=2*c-e,f=2*d-f;break;case "Z":case "z":c=g;d=k;b.push({jb:"Z",F:[]});break;default:throw"unimplemented path command: "+h;}});
return b}var p=a.getAttribute("id"),t=function(){var b=a.getAttribute("style")||"",c=a.getAttribute("class");c&&e.u.hasOwnProperty(c)&&(b=e.u[c]+";"+b);c={};Df(c,b);(b=a.getAttribute("fill"))&&(c.fill=b);(b=a.getAttribute("stroke"))&&(c.stroke=b);(b=a.getAttribute("stroke-width"))&&(c["stroke-width"]=b);(b=a.getAttribute("stroke-dasharray"))&&(c["stroke-dasharray"]=b.split(","));(b=a.getAttribute("stroke-dashoffset"))&&(c["stroke-dashoffset"]=b);(b=a.getAttribute("id"))&&(c.id=b);return c}();c={name:a.tagName,
id:p,style:t,parent:c};switch(a.tagName){case "svg":c.children=f(c);break;case "g":c.children=f(c);c.transform=b(a.getAttribute("transform"));break;case "path":c.path=k(a.getAttribute("d")||"");c.transform=b(a.getAttribute("transform"));break;case "line":c.Qd=g("x1");c.Sd=g("y1");c.Rd=g("x2");c.Td=g("y2");c.transform=b(a.getAttribute("transform"));break;case "polygon":case "polyline":c.Qc=a.getAttribute("points").trim().replace(/\s+/g," ").split(" ").map(function(a){return parseFloat(a)});c.transform=
b(a.getAttribute("transform"));break;case "circle":c.x=g("cx");c.y=g("cy");c.r=g("r");c.transform=b(a.getAttribute("transform"));break;case "rect":c.x=g("x");c.y=g("y");c.width=g("width");c.height=g("height");p=g("rx");t=g("ry",p);p=g("rx",t);c.Fh=p;c.Gh=t;c.transform=b(a.getAttribute("transform"));break;case "text":c.x=g("x");c.y=g("y");c.text=a.textContent;c.transform=b(a.getAttribute("transform"));break;default:return null}return c}var e=a,f="";c(a.i);a.u=function(){var a={};f.split("}").forEach(function(b){var c=
b.split("{");c[0].split(",").forEach(function(b){b=b.trim();/^\.[-a-z0-9]+/i.test(b)&&(b=b.slice(1),a[b]=a[b]?a[b]+";"+c[1]:c[1])})});return a}();a.i&&(a.l=d(a.i,null))}function Of(a,c){function b(a,c){if(a.id===c)return a;if(a.children)for(var d=0;d<a.children.length;d++){var e=b(a.children[d],c);if(e)return e}return null}if(a.H[c])return a.H[c];var d=b(a.l,c);d&&(a.H[c]=d);return d}
function Pf(a,c,b,d,e){a&&a.forEach(function(a){switch(a.jb){case "translate":c(a.F[0],a.F[1]);break;case "rotate":0!==a.F[1]||0!==a.F[2]?(c(-a.F[1],-a.F[2]),b(a.F[0]),c(a.F[1],a.F[2])):b(a.F[0]);break;case "scale":d(a.F[0],a.F[1]);break;case "matrix":e(a.F[0],a.F[1],a.F[2],a.F[3],a.F[4],a.F[5])}})}
Mf.prototype.J=function(a,c){function b(p,m,n){function q(){for(var a=0;a<p.children.length;a++)b(p.children[a],m,n)}function r(a,b){a=k.apply(new Gf(a,b));l.push(a.x);h.push(a.y)}function t(a,b,c){if(null==a||""==a)return b;a=/^\s*(-?[0-9.]+)\s*([a-z%]*)\s*$/i.exec(a);b=parseFloat(a[1]);switch(a[2]||"px"){case "pt":return 25.4*b/72*3;case "pc":return 25.4*b/6*3;case "in":return 25.4*b*3;case "mm":return 3*b;case "cm":return 30*b;case "em":return 18*b;case "ex":return 9*b;case "%":return b*c/100;
default:return b}}function u(b){var d=0,e=0,f=[],g=[],k=!0;a&&a.beginPath();b.forEach(function(b){switch(b.jb){case "M":2<=b.F.length&&(d=b.F[0],e=b.F[1],a&&a.moveTo(d,e),r(d,e),k&&1<f.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(f,g,!1),k=!0,f=l.slice(-1),g=h.slice(-1));break;case "L":d=b.F[0];e=b.F[1];a&&a.lineTo(d,e);r(d,e);f.push(l[l.length-1]);g.push(h[h.length-1]);break;case "A":var m=b.F[5],p=b.F[6];var n=b.F[0];var q=b.F[1],ta=b.F[2],t=0!=b.F[3],v=0!=b.F[4],u=b.F[5],oa=b.F[6],w=b.F[7],z=b.F[8];if(0===
n||0===q)a&&a.lineTo(w,z),n=new Gf(w,z);else{var P=Math.cos(ta),Q=Math.sin(ta);b=(P*u+Q*oa)/n;oa=(-Q*u+P*oa)/q;u=(P*w+Q*z)/n;w=(-Q*w+P*z)/q;z=(u-b)/2;P=(w-oa)/2;Q=z*z+P*P;Q=Math.sqrt((1-Q)/Q);isNaN(Q)?Q=0:t===v&&(Q=-Q);t=(b+u)/2+Q*P;z=(oa+w)/2-Q*z;b=Math.atan2((oa-z)/n,(b-t)/q);oa=Math.atan2((w-z)/n,(u-t)/q);a&&(a.rotate(ta),a.scale(n,q),v?a.arc(t,z,1,b,oa,!0):a.arc(t,z,1,b,oa),a.scale(1/n,1/q),a.rotate(-ta));u=new Hf;u.rotate(ta);u.scale(n,q);n=v?b<oa?(b+oa)/2+Math.PI:(b+oa)/2:b<oa?(b+oa)/2:(b+oa)/
2+Math.PI;n=u.apply(new Gf(t+Math.cos(n),z+Math.sin(n)))}d=m;e=p;r(n.x,n.y);r(d,e);k=!1;break;case "C":a&&a.bezierCurveTo(b.F[0],b.F[1],b.F[2],b.F[3],b.F[4],b.F[5]);d=b.F[4];e=b.F[5];r(d,e);k=!1;break;case "S":a&&a.bezierCurveTo(b.F[0],b.F[1],b.F[2],b.F[3],b.F[4],b.F[5]);d=b.F[4];e=b.F[5];r(d,e);k=!1;break;case "Q":a&&a.quadraticCurveTo(b.F[0],b.F[1],b.F[2],b.F[3]);d=b.F[2];e=b.F[3];r(d,e);k=!1;break;case "Z":a&&a.closePath(),k&&1<f.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(f,g,!0),k=!0,f=[],g=[]}});
k&&1<f.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(f,g,!1)}function w(b){function c(a,b){if(0<b.length){a.splice(0,a.length);for(var c=0;c<b.length&&1>c;c++){var d=(b[c].getAttribute("offset")||"0").trim(),e=/%$/.test(d)?parseFloat(d.slice(0,-1))/100:parseFloat(d),f=b[c].getAttribute("style");d={};f&&Df(d,f);isNaN(e)||(f=b[c].getAttribute("stop-color")||d["stop-color"]||"#000",Af.hasOwnProperty(f)&&(f=Af[f]),d=(b[c].getAttribute("stop-opacity")||d["stop-opacity"]||"1").trim(),d=/%$/.test(d)?parseFloat(d.slice(0,
-1))/100:parseFloat(d),1!==d&&(/^#[0-9a-f]{3}$/i.test(f)?f="rgba("+f.slice(1).split("").map(function(a){return 17*parseInt(a,16)}).map(function(a){return a.toString(10)}).join(",")+","+d.toFixed(2)+")":/^#[0-9a-f]{6}$/i.test(f)?f="rgba("+[f.slice(1,3),f.slice(3,5),f.slice(5)].map(function(a){return parseInt(a,16)}).map(function(a){return a.toString(10)}).join(",")+","+d.toFixed(2)+")":/^rgb(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(f)?f=f.slice(0,-1).replace(/\s+/g,",")+","+d.toFixed(2)+")":/^hsl(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(f)&&
(f=f.slice(0,-1).replace(/\s+/g,",")+","+d.toFixed(2)+")")),a.push({offset:e,color:f}))}}}function d(a,b){if(a.attributes["xlink:href"]){var e=a.getAttribute("xlink:href");"#"===e[0]&&(e=g.b.getElementById(e.slice(1)))&&(b=d(e,b))}b.Qd=a.attributes.x1?parseFloat(a.getAttribute("x1")):b.Qd||0;b.Sd=a.attributes.y1?parseFloat(a.getAttribute("y1")):b.Sd||0;b.Rd=a.attributes.x2?parseFloat(a.getAttribute("x2")):b.Rd||0;b.Td=a.attributes.y2?parseFloat(a.getAttribute("y2")):b.Td||0;b.cd=a.attributes.gradientUnits?
a.getAttribute("gradientUnits"):b.cd||"objectBoundingBox";b.lc=a.attributes.gradientTransform?a.getAttribute("gradientTransform"):b.lc||"";b.vb=b.vb||[];c(b.vb,a.getElementsByTagName("stop"));return b}function e(a,b){if(a.attributes["xlink:href"]){var d=a.getAttribute("xlink:href");"#"===d[0]&&(d=g.b.getElementById(d.slice(1)))&&(b=e(d,b))}b.Zc=a.attributes.cx?parseFloat(a.getAttribute("cx")):b.Zc||0;b.$c=a.attributes.cy?parseFloat(a.getAttribute("cy")):b.$c||0;b.r=a.attributes.r?parseFloat(a.getAttribute("r")):
b.r||0;b.cd=a.attributes.gradientUnits?a.getAttribute("gradientUnits"):b.cd||"objectBoundingBox";b.lc=a.attributes.gradientTransform?a.getAttribute("gradientTransform"):b.lc||"";b.vb=b.vb||[];c(b.vb,a.getElementsByTagName("stop"));return b}var f=/^url\(#(.+)\)$/.exec(b);if(f&&f[1]&&(f=g.b.getElementById(f[1])))switch(f.tagName){case "linearGradient":b=d(f,{});if("objectBoundingBox"===b.cd)throw"objectBoundingBox not supported";if(b.lc)throw f=new Hf,Ff(b.lc,f),"gradientTransform not supported";var h=
a.createLinearGradient(b.Qd,b.Sd,b.Rd,b.Td);for(f=0;f<b.vb.length;f++)h.addColorStop(b.vb[f].offset,b.vb[f].color);return h;case "radialGradient":b=e(f,{});if("objectBoundingBox"===b.cd)throw"objectBoundingBox not supported";b.lc&&(f=new Hf,Ff(b.lc,f),h=If(f,{x:b.Zc,y:b.$c}),f=b.r/Math.sqrt(Math.abs(f.b[0]*f.b[4])),b.Zc=h.x,b.$c=h.y,b.r=f);h=a.createRadialGradient(b.Zc,b.$c,0,b.Zc,b.$c,b.r);for(f=0;f<b.vb.length;f++)h.addColorStop(b.vb[f].offset,b.vb[f].color);return h}return b}function S(b,c,d,e,
f,g){0>=f||0>=g?a.rect(b,c,d,e):(f=Math.min((f+g)/2,Math.min(d,e)/2),a.moveTo(b+d-f,c),a.arc(b+d-f,c+f,f,1.5*Math.PI,2*Math.PI),a.lineTo(b+d,c+e-f),a.arc(b+d-f,c+e-f,f,0,.5*Math.PI),a.lineTo(b+f,c+e),a.arc(b+f,c+e-f,f,.5*Math.PI,Math.PI),a.lineTo(b,c+f),a.arc(b+f,c+f,f,Math.PI,1.5*Math.PI),a.closePath())}function Ga(){if(a){var b={};m&&Bf(b,m);n&&Bf(b,n);"hidden"!==b.visibility&&(b.opacity&&(a.globalAlpha*=parseFloat(b.opacity)),b.fill&&"none"===b.fill||(a.fillStyle="white"===b.fill||"#fff"===b.fill||
"#ffffff"===b.fill?"white":w(b.fill)||"none",a.fill()),b.stroke&&"none"!==b.stroke&&(a.lineWidth=t(b["stroke-width"]||"1px",1,100),a.strokeStyle=b.stroke||"none",a.miterLimit=b["stroke-miterlimit"]||4,a.lineJoin=b["stroke-linejoin"]||"miter",a.lineCap=b["stroke-linecap"]||"butt",b["stroke-dasharray"]&&(a.setLineDash(b["stroke-dasharray"].split(" ").map(function(a){return parseFloat(a)})),a.lineDashOffset=b["stroke-dashoffset"]?parseFloat(b["stroke-dashoffset"]):0),a.stroke()))}}function qa(b,d,e){if(a){var f=
{};m&&Bf(f,m);n&&Bf(f,n);"hidden"!==f.visibility&&(a.font=(f["font-size"]||"12px")+" "+(f["font-family"]||"helvetica"),f.fill&&"none"!==f.fill&&(a.fillStyle="white"===f.fill||"#fff"===f.fill||"#ffffff"===f.fill?"white":c&&c.fill||"silver",a.fillText(b,d,e)),f.stroke&&"none"!==f.stroke&&(a.strokeStyle=c&&c.stroke||"black",a.strokeText(b,d,e)))}}function za(b,c){b=Jf({x:b,y:c});a.save();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(b.Y,b.ba,b.oa-b.Y,b.pa-b.ba);a.restore()}var ma=p.id&&c&&c.Yd&&c.Yd[p.id],
P=p.id&&c&&c.Mf&&c.Mf[p.id];a&&a.save();k.save();ma&&a&&d(p,ma);P&&a&&e(P);m=Cf(m);n=Cf(n);(function(){p.style&&Bf(m,p.style);c&&c.ih&&Df(m,c.ih);p.id&&c&&c.style&&c.style.hasOwnProperty(p.id)&&Df(n,c.style[p.id]);for(var a in c.style)c.style.hasOwnProperty(a)&&"!"===a[0]&&a.slice(1)!==p.id&&Df(n,c.style[a])})();ma=l.length;switch(p.name){case "svg":k.save();f(p.transform);q();k.restore();break;case "g":k.save();f(p.transform);q();k.restore();break;case "path":a&&a.save();k.save();f(p.transform);
u(p.path);Ga();a&&a.restore();k.restore();break;case "line":a&&a.save();k.save();f(p.transform);a&&a.beginPath();a&&a.moveTo(p.Qd,p.Sd);a&&a.lineTo(p.Rd,p.Td);Ga();r(p.Qd,p.Sd);r(p.Rd,p.Td);c&&c.Ea&&c.Ea.line&&c.Ea.line([p.Qd,p.Rd],[p.Sd,p.Td],!1);a&&a.restore();k.restore();break;case "polygon":case "polyline":if(4<=p.Qc.length){a&&a.save();k.save();f(p.transform);a&&a.beginPath();a&&a.moveTo(p.Qc[0],p.Qc[1]);r(p.Qc[0],p.Qc[1]);for(P=2;P+1<p.Qc.length;P+=2)a&&a.lineTo(p.Qc[P],p.Qc[P+1]),r(p.Qc[P],
p.Qc[P+1]);"polygon"===p.name&&a&&a.closePath();Ga();c&&c.Ea&&c.Ea.line&&c.Ea.line(l.slice(-p.Qc.length/2),h.slice(-p.Qc.length/2),"polygon"===p.name);a&&a.restore();k.restore()}break;case "circle":a&&a.save();k.save();f(p.transform);a&&a.beginPath();a&&a.arc(p.x,p.y,p.r,0,2*Math.PI);Ga();r(p.x-p.r,p.y-p.r);r(p.x-p.r,p.y+p.r);r(p.x+p.r,p.y-p.r);r(p.x+p.r,p.y+p.r);if(c&&c.Ea&&c.Ea.Kf){P=l.slice(-4);var Q=h.slice(-4),Aa=(P[3]-P[0])*(P[3]-P[0])+(Q[3]-Q[0])*(Q[3]-Q[0]),Oa=(P[2]-P[1])*(P[2]-P[1])+(Q[2]-
Q[1])*(Q[2]-Q[1]);.001>Math.abs(Aa-Oa)/(Aa+Oa)&&.001>((P[3]-P[0])*(P[2]-P[1])+(Q[3]-Q[0])*(Q[2]-Q[1]))/Aa&&c.Ea.Kf((P[0]+P[2])/2,(Q[0]+Q[2])/2,Math.sqrt(Aa/8))}a&&a.restore();k.restore();break;case "rect":a&&a.save();k.save();f(p.transform);a&&(a.beginPath(),0<p.Fh||0<p.Gh?S(p.x,p.y,p.width,p.height,p.Fh,p.Gh):a.rect(p.x,p.y,p.width,p.height));Ga();r(p.x,p.y);r(p.x,p.y+p.height);r(p.x+p.width,p.y);r(p.x+p.width,p.y+p.height);a&&a.restore();k.restore();break;case "text":a&&a.save(),k.save(),f(p.transform),
qa(p.text,p.x,p.y),r(p.x,p.y),a&&a.restore(),k.restore()}a&&a.restore();k.restore();a&&c&&c.hh&&za(l.slice(ma),h.slice(ma))}function d(b,c){if(c.kb&&0!=c.kb){var d=c.Fe,e=c.Ge;if(void 0==d||void 0==e)d=g.J(null,{ed:b}),b=Jf(d),d=(b.Y+b.oa)/2,e=(b.ba+b.pa)/2;a.translate(d+(c.Kb||0),e+(c.Lb||0));a.rotate(c.kb);a.translate(-d,-e)}else(c.Kb||c.Lb)&&a.translate(c.Kb,c.Lb)}function e(b){a.beginPath();a.rect(b.x,b.y,b.rc,b.ld);a.clip()}function f(b){Pf(b,function(b,c){a&&a.translate(b,c);k.translate(b,c)},
function(b){a&&a.rotate(b);k.rotate(b)},function(b,c){a&&a.scale(b,c);k.scale(b,c)},function(b,c,d,e,f,g){a&&a.transform(b,c,d,e,f,g);k.wf(b,c,d,e,f,g)})}var g=this,k=new Kf,l=[],h=[],q=this.l;c&&c.qe?q=Of(this,c.qe):c&&c.ed&&(q=c.ed);if(q){c&&c.Wf&&c.Wf(a,this.D);if(a){for(var p=[],t=q.parentElement;null!=t;t=t.parentElement)p.push(t);for(t=p.length-1;0<=t;t--){var u=p[t].id;(u=u&&c&&c.Yd&&c.Yd[u])&&d(p[t],u);f(p[t].transform)}}b(q,{},{})}return{x:l,y:h}};
function Qf(a,c){if(a.id===c)return a;if(a.children)for(var b=0;b<a.children.length;b++){var d=Qf(a.children[b],c);if(d)return d}return null}Mf.prototype.Oc=function(a){return null!=Qf(this.l,a)};Mf.prototype.yg=function(a,c){var b=Qf(this.l,c);if(null==b)throw"Undefined SVG element id "+c;return null!=Qf(b,a)};function Hf(a){this.b=a||[1,0,0,0,1,0]}x=Hf.prototype;x.sb=function(){return new Hf(this.b)};x.apply=function(a){return new Gf(this.b[0]*a.x+this.b[1]*a.y+this.b[2],this.b[3]*a.x+this.b[4]*a.y+this.b[5])};function If(a,c){var b=a.b[0]*a.b[4]-a.b[3]*a.b[1];return new Gf((a.b[4]*c.x-a.b[1]*c.y+a.b[1]*a.b[5]-a.b[4]*a.b[2])/b,(-a.b[3]*c.x+a.b[0]*c.y+a.b[3]*a.b[2]-a.b[0]*a.b[5])/b)}
x.translate=function(a,c){this.b=[this.b[0],this.b[1],this.b[0]*a+this.b[1]*c+this.b[2],this.b[3],this.b[4],this.b[3]*a+this.b[4]*c+this.b[5]]};x.scale=function(a,c){this.b=[this.b[0]*a,this.b[1]*c,this.b[2],this.b[3]*a,this.b[4]*c,this.b[5]]};x.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);this.b=[c*this.b[0]+a*this.b[1],-a*this.b[0]+c*this.b[1],this.b[2],c*this.b[3]+a*this.b[4],-a*this.b[3]+c*this.b[4],this.b[5]]};
x.wf=function(a,c,b,d,e,f){this.b=[a*this.b[0]+b*this.b[1],c*this.b[0]+d*this.b[1],a*this.b[2]+b*this.b[3],c*this.b[2]+d*this.b[3],a*this.b[4]+b*this.b[5]+e,c*this.b[4]+d*this.b[5]+f]};function Gf(a,c){this.x=a||0;this.y=c||0}function Kf(){this.stack=[new Hf]}x=Kf.prototype;x.apply=function(a){return this.stack[this.stack.length-1].apply(a)};x.save=function(){this.stack.push(this.stack[this.stack.length-1].sb())};x.restore=function(){if(2>this.stack.length)throw"restore doesn't match save";this.stack.pop()};
x.translate=function(a,c){this.stack[this.stack.length-1].translate(a,c)};x.scale=function(a,c){this.stack[this.stack.length-1].scale(a,c)};x.rotate=function(a){this.stack[this.stack.length-1].rotate(a)};x.wf=function(a,c,b,d,e,f){this.stack[this.stack.length-1].wf(a,c,b,d,e,f)};function Rf(a){for(var c=0;c<a.draw.length;c++)if(a.draw[c].uri)return a.draw[c].uri;throw"URI not found";}function Mc(a){a=a.split("#");return{ad:a[0],id:a[1]}}function Sf(a,c,b){a.N.save();b.Wf=function(a,b){this.clientData.Ke=b;a.translate(-b[0],-b[1]);a.scale(this.A.m/(b[2]-b[0]),this.A.m/(b[3]-b[1]))}.bind(a);c.J(a.N,b);a.N.restore()}
function Tf(a,c,b,d,e){return{x:(a.clientData.Ke[2]-a.clientData.Ke[0])/d*(c+a.clientData.Ke[0]),y:(a.clientData.Ke[3]-a.clientData.Ke[1])/e*(b+a.clientData.Ke[1])}}
function Uf(a,c,b){var d={},e=(a.buttons?a.buttons.length:0)+(a.radiobuttons?1:0);if(void 0!=a.sliders){for(var f=0;f<a.sliders.length;f++){var g=a.sliders[f],k=Lf(c,g.id),l=Lf(c,g.thumbId),h=(l.Y+l.oa)/2,q=(l.ba+l.pa)/2;k.oa-k.Y<k.pa-k.ba?(k.Y=k.oa=(k.Y+k.oa)/2,h=k.Y):(k.ba=k.pa=(k.ba+k.pa)/2,q=k.ba);l=(b[e+f]-g.min)/(g.max-g.min);d[g.thumbId]={Kb:l*(k.oa-k.Y)-(h-k.Y),Lb:l*(k.ba-k.pa)-(q-k.pa)}}e+=a.sliders.length}if(void 0!=a.rotating)for(f=0;f<a.rotating.length;f++)g=a.rotating[f],l=g.numSteps?
2*Math.PI/g.numSteps:1,k=Lf(c,g.centerId),d[g.id]={kb:b[e+f]*l,Fe:(k.Y+k.oa)/2,Ge:(k.ba+k.pa)/2};return d}function Vf(a,c,b){return Math.min(Math.max((b-a)/(c-a),0),1)}
function Wf(a,c,b,d,e,f,g,k,l){e=Tf(a,l.x-g,l.y-k,e,f);var h=a.clientData.Kd.min+(a.clientData.Kd.max-a.clientData.Kd.min)*Vf(a.clientData.min,a.clientData.max,a.clientData.ef?e.y:e.x),q=a.clientData.Kd.min,p=a.clientData.Kd.max;(e=a.clientData.Kd.discrete)&&0<e.length?h=e.reduce(function(a,b){return Math.abs(h-b)<Math.abs(h-a)?b:a},e[0]):(a=a.clientData.Kd.snap)&&a.forEach(function(a,b){"string"===typeof a&&/^`.+`$/.test(a)&&(a=Ca(a,c.h,b,!0));Math.abs(h-a)<Math.abs(p-q)/10&&(h=a)});c.h[(d.buttons?
d.buttons.length:0)+(d.radiobuttons?1:0)+b]=Math.max(Math.min(q,p),Math.min(Math.max(q,p),h));F(c)}
function Xf(a,c,b,d){if(0!==b.draw.length){var e=Mc(Rf(b)).ad,f=e?Uf(b,c.Ib[e],d.h):{},g=null;if(b.diffwheelmotion&&b.diffwheelmotion.id){g=b.diffwheelmotion;var k=g.id,l=g.dx||0,h=g.dy||0,q=g.adjscale||1,p=g.color||"black",t=void 0===g.linewidth?1:g.linewidth;g=Lf(c.Ib[e],k);var u=(b.buttons?b.buttons.length:0)+(b.radiobuttons?1:0),w=2.4*d.h[u];u=2.4*d.h[u+1];var m=a.A.m;g=(.5+l)*(g.oa-g.Y)*q/m;l=Qe(a,w,u,g,{color:p,vf:t});f[k]={Kb:-(l.x*g*m+h*m*Math.sin(l.kb)),Lb:-(l.y*g*m+h*m*Math.cos(l.kb)),kb:-l.kb};
g={bi:w,ci:u,ii:g,color:p,vf:t}}b.draw.forEach(function(a){if(a.uri){var g=Mc(a.uri),h=c.Ib[g.ad];g=g.id;for(var k={},l=b.buttons?b.buttons.length:0,p=b.radiobuttons?b.radiobuttons.length:0,m=b.styles?b.styles.length:0,n=0;n<l;n++){var q=b.buttons[n].val,t=b.buttons[n].st;q=q.indexOf(d.h[n]);0<=q&&(k[b.buttons[n].id]=t[q])}for(n=0;n<p;n++)q=b.radiobuttons[n].val,t=b.radiobuttons[n].st,k[b.radiobuttons[n].id]=t[d.h[l]===q?1:0];for(n=0;n<m;n++)k[(b.styles[n].complement?"!":"")+b.styles[n].id]=Ca(b.styles[n].st,
d.h);l=c.Ib[e];p=d.h;m={};if(void 0!=b.sliders)for(n=0;n<b.sliders.length;n++){t=b.sliders[n];q=Lf(l,t.id);var u=t.lowerPartId&&Lf(l,t.lowerPartId);if(u){var P=(p[n]-t.min)/(t.max-t.min),w=u.oa-u.Y,Aa=u.pa-u.ba;m[t.lowerPartId]=q.oa-q.Y<q.pa-q.ba?{x:u.Y-Aa,y:u.ba,rc:w+2*Aa,ld:Aa*P}:{x:u.Y,y:u.ba-Aa,rc:w*P,ld:Aa+2*w}}}Sf(this,h,{qe:g,style:k,Yd:f,Mf:m,hh:!1})}a.js&&(a=new Function("ctx","$",a.js),this.N.save(),this.N.scale(this.A.m/1E3,this.A.m/1E3),this.N.beginPath(),a(this.N,d.h),this.N.restore())},
a);g&&Qe(a,g.bi,g.ci,g.ii,{color:g.color,vf:g.vf});b.score&&b.score.id&&(k=(b.buttons?b.buttons.length:0)+(b.radiobuttons?1:0)+(b.sliders?b.sliders.length:0),h=b.score,p=h.numHeights||5,g=Lf(c.Ib[e],h.id),t=c.Ib[e].D,Ue(a,d.h.slice(k),(g.Y-t[0])/(t[2]-t[0]),(g.oa-t[0])/(t[2]-t[0]),(g.pa-t[1])/(t[3]-t[1]),(g.ba-t[1])/(t[3]-t[1]),p,(g.pa-g.ba)/(t[3]-t[1])/p*(h.noteSize||1),void 0===h.linewidth?1:h.linewidth))}}
function Yf(a,c,b){function d(a){for(var c=0;c<b.length;c++)if(b[c].name===a)return c;return-1}c.forEach(function(c){var e=c.name;if(!e)throw"Missing block name";var g=d(e),k=0<=g?b[g]:null,l=k?k.type:"?";if(c.type||!k)switch(c.type){case "event":l="e";break;case "action":l="a";break;case "state":l="s";break;case "comment":l="c";break;case "hidden":l="h";break;default:throw"Unknown block type "+c.type+" for block "+e;}var h=k?k.va:[];c.modes&&!k&&c.modes.forEach(function(a){switch(a){case "basic":h.push("b");
break;case "advanced":h.push("a");break;default:throw"Unknown block mode "+a;}});var q=k?k.Vc:null,p=c.validation;p&&(q=function(a){for(var b=0;b<p.length;b++){var c=p[b].assert;if("string"===typeof c&&/^`.+`$/.test(c)?!Ca(c,a.h,void 0,!0):!c)return(a=p[b].warning)?new Na(a,!0):new Na(p[b].error||"Error")}});var t=k?k.J:function(b,d){Xf(b,a,c,d)},u=k?k.fa:function(b,d,e,f,g,h,k){a:{var l=Mc(Rf(c)).ad,p=0,m=c.buttons;if(m){var n;b:{var q=a.Ib[l],t=Tf(b,k.x-g,k.y-h,e,f);for(n=0;n<m.length;n++)if(q.$d(m[n].id,
t.x,t.y)){q=m[n].val.indexOf(d.h[n]);0<=q&&(D(d),d.h[n]=m[n].val[(q+1)%m[n].val.length],F(d));break b}n=null}if(null!==n){d=p+n;break a}p+=m.length}if(n=c.radiobuttons){b:{q=a.Ib[l];m=m||0;t=Tf(b,k.x-g,k.y-h,e,f);for(var r=0;r<n.length;r++)if(q.$d(n[r].id,t.x,t.y)){D(d);d.h[m]=n[r].val;F(d);n=0;break b}n=null}if(null!==n){d=p+n;break a}p++}if(n=m=c.pushbuttons){b:{n=a.Ib[l];q=Tf(b,k.x-g,k.y-h,e,f);for(t=0;t<m.length;t++)if(n.$d(m[t].id,q.x,q.y)){D(d);m=m[t].newParameters;"string"===typeof m&&/^`.+`$/.test(m)&&
(m=Ca(m,d.h,void 0,!0));d.h=m;F(d);m=!0;break b}m=null}n=null!==m}if(n)d=-1;else{if(m=c.sliders){b:{n=a.Ib[l];q=Tf(b,k.x-g,k.y-h,e,f);for(t=0;t<m.length;t++){b.clientData.Kd=m[t];var u=Lf(n,b.clientData.Kd.id);b.clientData.ef=u.oa-u.Y<u.pa-u.ba;b.clientData.min=b.clientData.ef?u.pa:u.Y;b.clientData.max=b.clientData.ef?u.ba:u.oa;r=(u.Y+u.oa)/2;u=(u.ba+u.pa)/2;var v=Lf(n,b.clientData.Kd.thumbId);if(Math.abs((b.clientData.ef?q.x:q.y)-(b.clientData.ef?r:u))<(b.clientData.ef?v.oa-v.Y:v.pa-v.ba)){D(d);
n=t;break b}}n=null}if(null!==n){d=p+n;break a}p+=m.length}if(m=c.rotating){b:{n=a.Ib[l];q=d.h.slice(p,p+m.length);t=Tf(b,k.x-g,k.y-h,e,f);for(r=0;r<m.length;r++){u=Lf(n,m[r].centerId);u={x:(u.Y+u.oa)/2,y:(u.ba+u.pa)/2};var w=m[r].numSteps?2*Math.PI/m[r].numSteps:1;v=u.x+(t.x-u.x)*Math.cos(q[r]*w)+(t.y-u.y)*Math.sin(q[r]*w);w=u.y-(t.x-u.x)*Math.sin(q[r]*w)+(t.y-u.y)*Math.cos(q[r]*w);if(n.$d(m[r].thumbId,v,w)){b.clientData.Hi=m[r];b.clientData.bh=u;b.clientData.gi=Math.atan2(w-u.y,v-u.x);D(d);n=r;
break b}}n=null}if(null!==n){d=p+n;break a}p+=m.length}if(c.score&&(q=a.Ib[l],b=(c.buttons?c.buttons.length:0)+(c.radiobuttons?1:0)+(c.sliders?c.sliders.length:0),l=d.h.slice(b).length/2,m=c.score.numHeights||5,n=Lf(q,c.score.id),q=q.D,(e=lf((n.Y-q[0])/(q[2]-q[0]),(n.oa-q[0])/(q[2]-q[0]),(n.pa-q[1])/(q[3]-q[1]),(n.ba-q[1])/(q[3]-q[1]),l,m,e,f,g,h,k))?(D(d),d.h[b+2*e.index]===e.tone?d.h[b+2*e.index+1]=(d.h[b+2*e.index+1]+1)%3:(d.h[b+2*e.index]=e.tone,d.h[b+2*e.index+1]=1),F(d),n=0):n=null,null!==n)){d=
p+n;break a}d=null}}return d},w=k?k.Qa:function(a,b,d,e,f,g,h,k){var l=(c.buttons?c.buttons.length:0)+(c.radiobuttons?1:0),m=c.sliders?c.sliders.length:0;d>=l&&d<l+m?Wf(a,b,d-l,c,e,f,g,h,k):(l+=m,m=c.rotating?c.rotating.length:0,d>=l&&d<l+m&&(d-=l,e=Tf(a,k.x-g,k.y-h,e,f),b.h[(c.buttons?c.buttons.length:0)+(c.radiobuttons?1:0)+(c.sliders?c.sliders.length:0)+d]=Math.round(((Math.atan2(e.y-a.clientData.bh.y,e.x-a.clientData.bh.x)-a.clientData.gi+Math.PI)%(2*Math.PI)-Math.PI)/(c.rotating[d].numSteps?
2*Math.PI/c.rotating[d].numSteps:1)),F(b)))},m=yf(c,k&&k.Mb),n=k&&k.ha||null;if((null==k||null==k.J)&&"h"!==l){var E=Mc(Rf(c)).ad,r=a.Ib[E],v=0;c.buttons&&(c.buttons.forEach(function(a,b){var c=Lf(r,a.id);c=new Da((c.ba-r.D[1])/(r.D[3]-r.D[1]),(c.Y-r.D[0])/(r.D[2]-r.D[0]),(c.pa-r.D[1])/(r.D[3]-r.D[1]),(c.oa-r.D[0])/(r.D[2]-r.D[0]),function(c){var d=a.val.indexOf(c.h[b]);0<=d&&(D(c),c.h[b]=a.val[(d+1)%a.val.length],F(c))},null,null);null==n&&(n=new A);n.controls.push(c)}),v=c.buttons.length);var C=
0;c.radiobuttons&&(c.radiobuttons.forEach(function(a){var b=Lf(r,a.id);b=new Da((b.ba-r.D[1])/(r.D[3]-r.D[1]),(b.Y-r.D[0])/(r.D[2]-r.D[0]),(b.pa-r.D[1])/(r.D[3]-r.D[1]),(b.oa-r.D[0])/(r.D[2]-r.D[0]),function(b){D(b);b.h[v]=a.val;F(b)},null,null);null==n&&(n=new A);n.controls.push(b)}),C=c.radiobuttons.length);var R=0;c.pushbuttons&&(c.pushbuttons.forEach(function(a){var b=Lf(r,a.id);b=new Da((b.ba-r.D[1])/(r.D[3]-r.D[1]),(b.Y-r.D[0])/(r.D[2]-r.D[0]),(b.pa-r.D[1])/(r.D[3]-r.D[1]),(b.oa-r.D[0])/(r.D[2]-
r.D[0]),function(b){D(b);var c=a.newParameters;"string"===typeof c&&/^`.+`$/.test(c)&&(c=Ca(c,b.h,void 0,!0));b.h=c;F(b)},null,null);null==n&&(n=new A);n.controls.push(b)}),R=c.pushbuttons.length);var S=0;c.sliders&&(c.sliders.forEach(function(a,b){var c=Lf(r,a.id),d=Lf(r,a.thumbId),e=Math.abs(d.oa-d.Y);d=Math.abs(d.pa-d.ba);var f=a.min,g=a.max,h=a.discrete;a=new Da((c.ba-d/2-r.D[1])/(r.D[3]-r.D[1]),(c.Y-e/2-r.D[0])/(r.D[2]-r.D[0]),(c.pa+d/2-r.D[1])/(r.D[3]-r.D[1]),(c.oa+e/2-r.D[0])/(r.D[2]-r.D[0]),
null,function(a){var c=a.h[v+C+R+b];h?(c=h.indexOf(c),c=0<=c&&c+1<h.length?h[c+1]:0<h.length?h[h.length-1]:Math.max(f,g)):c=Math.min(Math.max(f,g),c+Math.abs(g-f)/10);a.h[v+C+R+b]=c},function(a){var c=a.h[v+C+R+b];h?(c=h.indexOf(c),c=0<=c&&0<c?h[c-1]:0<h.length?h[0]:Math.min(f,g)):c=Math.max(Math.min(f,g),c-Math.abs(g-f)/10);a.h[v+C+R+b]=c});null==n&&(n=new A);n.controls.push(a)}),S=c.sliders.length);var Ga=0;c.rotating&&(c.rotating.forEach(function(a,b){var c=Lf(r,a.id),d=Lf(r,a.centerId),e=(d.Y+
d.oa)/2;d=(d.ba+d.pa)/2;c=Math.max(Math.max(Math.abs(c.Y-e),Math.abs(c.oa-e)),Math.max(Math.abs(c.ba-d),Math.abs(c.pa-d)));var f=a.numSteps,g=-Math.floor(f/2);a=new Da((d-c-r.D[1])/(r.D[3]-r.D[1]),(e-c-r.D[0])/(r.D[2]-r.D[0]),(d+c-r.D[1])/(r.D[3]-r.D[1]),(e+c-r.D[0])/(r.D[2]-r.D[0]),null,function(a){a.h[v+C+R+S+b]=(a.h[v+C+R+S+b]+f-g+1)%f+g},function(a){a.h[v+C+R+S+b]=(a.h[v+C+R+S+b]+f-g-1)%f+g});null==n&&(n=new A);n.controls.push(a)}),Ga=c.rotating.length);if(c.score){var qa=Lf(r,c.score.id),za=
(c.defaultParameters.length-v-C-R-S-Ga)/2,ma=c.score.numHeights||5;for(E=0;E<za;E++)(function(a){var b=v+C+R+S+Ga,c=new Da((qa.ba-r.D[1])/(r.D[3]-r.D[1]),(qa.Y-r.D[0]+(qa.oa-qa.Y)*a/za)/(r.D[2]-r.D[0]),(qa.pa-r.D[1])/(r.D[3]-r.D[1]),(qa.Y-r.D[0]+(qa.oa-qa.Y)*(a+1)/za)/(r.D[2]-r.D[0]),function(c){c.h[b+2*a+1]=rf(c.h[b+2*a+1],[0,1,2])},function(c){0===c.h[b+2*a+1]?(c.h[b+2*a]=0,c.h[b+2*a+1]=1):c.h[b+2*a]=Math.min(c.h[b+2*a]+1,ma-1)},function(c){0===c.h[b+2*a+1]?(c.h[b+2*a]=0,c.h[b+2*a+1]=1):c.h[b+2*
a]=Math.max(c.h[b+2*a]-1,0)},function(c,d,e){d=ma-1-Math.floor(e*ma*.9999);0===c.h[b+2*a+1]?(c.h[b+2*a]=d,c.h[b+2*a+1]=1):c.h[b+2*a]===d?c.h[b+2*a+1]=rf(c.h[b+2*a+1],[0,1,2]):c.h[b+2*a]=d});null==n&&(n=new A);n.controls.push(c)})(E)}}e={name:e,type:l,va:h,sa:k?k.sa:function(){return c.defaultParameters||[]},fb:k?k.fb:function(){return c.typicalParameters||c.defaultParameters||[]},df:k?k.df||null:c.typicalParamSet||null,ha:n,J:t,Ie:k?k.Ie||!1:c.alwaysZoom||!1,fa:u,Qa:w,Mb:m,Vc:q};0<=g?b[g]=new y(e):
b.push(new y(e))})}
function Zf(a){qc=function(b,c){return{m:b,ph:void 0===a.styles.minInteractiveBlockSize?60:a.styles.minInteractiveBlockSize,qh:void 0===a.styles.minTouchInteractiveBlockSize?120:a.styles.minTouchInteractiveBlockSize,jh:void 0===a.styles.eventRightAlign?!1:a.styles.eventRightAlign,ua:void 0===a.styles.blockLineWidth?Math.max(1,Math.min(3,b/40)):a.styles.blockLineWidth,ng:Math.round(b/4).toString(10)+"px sans-serif",g:c,Ca:void 0===a.styles.controlLineWidth?Math.max(1,Math.min(3,b/40)):a.styles.controlLineWidth,
Zh:"bold 15px sans-serif",qg:a.styles.errorColor||"#f88",Ug:a.styles.warningColor||"#f88",background:a.styles.background||"white",Ig:a.styles.ruleMarks||"#bbb",Kg:a.styles.scrollbarThumbColor||"navy",Jg:a.styles.scrollbarBackgroundColor||"#ccc",vd:a.styles.scrollbarWidth||5}};var c=[];Yf(a,a.blocks||[],c);G=c};function Na(a,c){this.w=a;this.Wb=c||!1;this.i=!1;this.l=[];this.b=[];this.u=null}function Ab(a,c){a.i=!0;a.l=c}function Pa(a,c){a.i=!0;a.u=c};function $a(){this.Hc=[];this.Id=[]}function $f(a,c){this.state=a;this.marks=c||{}}function ag(a,c){function b(a){if(c){if(a.marks)for(var b in a.marks)a.marks.hasOwnProperty(b)&&c[b]&&(a.marks[b]=!1)}else a.marks={}}a.Hc.forEach(b);a.Id.forEach(b)}$a.prototype.yb=function(a,c){c&&ag(this,c);this.Hc.push(new $f(a,c));20<this.Hc.length&&(this.Hc=this.Hc.slice(-20));this.Id=[]};$a.prototype.ig=function(a,c){c&&ag(this,c);return 0<this.Hc.length?(this.Id.push(new $f(a,c)),this.Hc.pop()):new $f(a,c)};
$a.prototype.Fg=function(a,c){c&&ag(this,c);return 0<this.Id.length?(this.Hc.push(new $f(a,c)),this.Id.pop()):new $f(a,c)};B.prototype.toDataURL=function(a,c,b){function d(a){a&&(a[0]*=g,a[1]*=k)}var e=this;switch(this.T.type){case "e":var f=N(a,{tag:"block",ga:["event","html"]});break;case "a":f=N(a,{tag:"block",ga:["action","html"]});break;case "s":f=N(a,{tag:"block",ga:["state","html"]});break;case "c":f=N(a,{tag:"block",ga:["comment","html"]});break;default:throw"internal";}var g=c.m/f.width,k=c.m/f.height;f.width=c.m;f.height=c.m;d(f.borderBottomLeftRadius);d(f.borderBottomRightRadius);d(f.borderTopLeftRadius);d(f.borderTopRightRadius);
return(new ud(this,L(f),f.ra(),0,0,function(a,b,c,d,g){c=b.x+f.offsetLeft()+c;d=b.y+f.offsetTop()+d;Zc(f,a.N,c,d);var h=e.T;b=b.data;var k=f;a.N.save();a.N.translate(c,d);h.J(a,b,k,g);a.N.restore()})).toDataURL(c,b||1)};function bg(a,c,b,d,e){a=a.toDataURL(c,b,d);b="<img width='"+b.m.toString(10)+"' height='"+b.m.toString(10)+"' src='"+a+"'>";return e?"<a href='"+a+"' download='"+e+"'>"+b+"</a>":b}
function cg(a,c,b,d,e){var f=N(b,{tag:"widget",id:"widget-"+c.replace(/^.*:/g,"")}),g=L(f),k=f.ra();return{url:(new ud(null,g,k,0,0,function(b,d,e,p){b.ca=a.ca;Hd(b,c,g/2+e,k/2+p,f)})).toDataURL(d,e||1),width:g,height:k}}function dg(a,c,b,d,e,f){a=cg(a,c,b,d,e);c="<img width='"+a.width.toString(10)+"' height='"+a.height.toString(10)+"' src='"+a.url+"'>";return f?"<a href='"+a.url+"' download='"+f+"'>"+c+"</a>":c}
function rc(a,c,b,d,e,f){return{url:(new ud(null,c,b,0,0,function(b){a(b.N,d,!1)})).toDataURL(e,f||1),width:c,height:b}}function yc(a,c,b,d,e){for(var f=0;f<a.controls.length;f++){var g=a.controls[f];if(g.id===c)return rc(function(a,b,c){g.J(a,b,c)},g.hd.oa-g.hd.Y,g.hd.pa-g.hd.ba,b,d,e)}return null}
function Pc(a,c){var b=qc(100,100),d=dg(a.aa,"vpl:then",c,b,5);return"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table class='program'>\n"+a.j.j.map(function(a){return a instanceof Qa?"<tr class='rule-comment'>\n<td class='comment'>\n"+a.ke+"\n</td>\n</tr>\n":a.Tb()?"":"<tr class='rule'>\n<td class='events'>\n<table class='events'>\n<tr class='events'>\n"+a.X.map(function(a,d){var e="block";switch(a.T.type){case "e":e=e+" event"+(0===d?" event-main":
" event-aux");break;case "s":e+=" state";break;case "c":e+=" comment"}return"<td class='"+e+"'>"+bg(a,c,b,5)+"</td>\n"}).join("")+"</tr>\n</table>\n</td>\n<td class='then'>"+d+"</td>\n<td class='actions'>\n<table class='actions'>\n<tr class='actions'>\n"+a.actions.map(function(a){var d="block";switch(a.T.type){case "a":d+=" action";break;case "c":d+=" comment"}return"<td class='"+d+"'>"+bg(a,c,b,5)+"</td>\n"}).join("")+"</tr>\n</table>\n</td>\n</tr>\n"}).join("")+"</table>\n</body>\n</html>\n"}
function Rc(a,c,b){function d(a,b){return b.controls.map(function(c){return(a.I.find(c.id).lb||[{}]).map(function(d){a.kc.Pa=!0===d.selected;a.kc.state=d.state||null;var g=!0===d.selected?"selected":!1===d.selected?"unselected":"";d.state&&(g+=(0<g.length?" ":"")+"="+d.state);d=c.id+(g?"-"+g.replace(/\s+/g,"-").replace("=",""):"")+".png";var h=yc(b,c.id,k[c.id],e,f),l="<img width='"+h.width.toString(10)+"' height='"+h.height.toString(10)+"' src='"+h.url+"'>";return"<tr><td>"+(d?"<a href='"+h.url+
"' download='"+d+"'>"+l+"</a>":l)+"</td><td>"+c.id+"</td><td>"+g+"</td></tr>\n"}).join("")}).join("")}var e=qc(100,100),f=5,g=vc(a,c);a.kc={disabled:!1,$:!0,nh:!1,isEnabled:!0,Pa:!1,state:null};var k=wc(a,a.Jc,["vpl","top"]),l=xc(a,a.Jc,["vpl","top"],g.Gc,g.Og,k);k=Object.assign(k,wc(a,a.yc,["vpl","bottom"]));g=xc(a,a.yc,["vpl","bottom"],g.Od,g.Ng,k);a.rb.forEach(function(a){k[a]=N(c,{tag:"button",id:a.replace(/:/g,"-"),ga:["src","top"]})},a);var h=null;null!=a.O&&(h=eg(a,a.rb,N(c,{tag:"toolbar",
ga:["src","top"]}),N(c,{tag:"separator",ga:["src","top"]}),k));a.Za.forEach(function(a){k[a]=N(c,{tag:"button",id:a.replace(/:/g,"-"),ga:["sim","top"]})},a);var q=a.M,p=null,t=[],u=null;if(null!=q){p=fg(a,a.Za,N(c,{tag:"toolbar",ga:["sim","top"]}),N(c,{tag:"separator",ga:["sim","top"]}),k);t="sim-event:forward sim-event:backward sim-event:left sim-event:right sim-event:center sim-event:clap sim-event:tap".split(" ");var w=N(c,{tag:"button",ga:["sim","event"]});u=t.map(function(a){return rc(function(b,
d,f){(q.he||sc)(a,b,e,c,["sim","event"],null,!0,!1,f)},w.width,w.height,w,e,f)})}var m=a.j;b=b?"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table>\n"+function(){for(var a=0,b=0,d="";;){for(;a<G.length&&("e"!==G[a].type&&"s"!==G[a].type||0>("b"===m.mode?m.ec:m.jc).indexOf(G[a].name));)a++;var g="";if(a<G.length){var h=new B(G[a],null,null);G[a].fb&&(h.h=G[a].fb());g=bg(h,c,e,f,G[a].name.replace(/ /g,"_")+".png");a++}for(;b<G.length&&("a"!==G[b].type&&
"c"!==G[b].type||0>("b"===m.mode?m.ec:m.jc).indexOf(G[b].name));)b++;h="";b<G.length&&(h=new B(G[b],null,null),G[b].fb&&(h.h=G[b].fb()),h=bg(h,c,e,f,G[b].name.replace(/ /g,"_")+".png"),b++);if(g||h)d+="<tr>\n<td>"+g+"</td>\n<td>"+h+"</td>\n</tr>\n";else break}return d}()+"</table></html>":"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table>\n"+G.map(function(a){var b=null;switch(a.type){case "e":b="event";break;case "s":b="state";break;case "a":b="action";
break;case "c":b="comment";break;default:return""}var d=new B(a,null,null),g="<tr class='"+b+"'>\n<td>\n";a.df?a.df.forEach(function(b,h){d.h=b;g+=bg(d,c,e,f,a.name.replace(/ /g,"_")+"-"+h.toString(10)+".png")}):(d.h=a.fb?a.fb():d.h,g+=bg(d,c,e,f,a.name.replace(/ /g,"_")+".png"));return g+="</td>\n<td>"+a.name+"</td>\n</tr>\n"}).join("")+"</table>\n<table>\n"+Object.keys(a.aa.ca).map(function(a){return"<tr><td>"+dg(this.aa,a,c,e,f,a+".png")+"</td><td>"+a+"</td></tr>\n"},a).join("")+"</table>\n<table>\n"+
d(a,l)+d(a,g)+(null!=a.O?d(a,h):"")+(null!=q?d(a,p)+u.map(function(a,b){b=t[b];var c="<img width='"+a.width.toString(10)+"' height='"+a.height.toString(10)+"' src='"+a.url+"'>",d=b.replace(/ /g,"_")+".png";return"<tr><td>"+("<a href='"+a.url+"' download='"+d+"'>"+c+"</a>")+"</td><td>"+b+"</td></tr>\n"}):"")+"</table>\n</body>\n</html>\n";a.kc=null;return b};function gg(a,c){c=(new DOMParser).parseFromString(c,"text/xml").getElementsByTagName("node");if(1>c.length)throw"empty";c=c[0].getElementsByTagName("program");if(1!==c.length)throw"program";var b="0"!==c[0].getAttribute("advanced_mode");c=c[0].getElementsByTagName("set");ib(a);a.mode=b?"a":"b";for(b=0;b<c.length;b++){var d=hg(c[b],function(){a.yb()},function(){mb(a)});a.j.push(d)}}
function hg(a,c,b){a=a.getElementsByTagName("block");for(var d=new Ja,e=0;e<a.length;e++){a:{var f=a[e];f.getAttribute("type");var g=f.getAttribute("name");var k=[];for(var l=[],h=0;1E3>h;h++){var q=f.getAttribute("value"+h);if(null===q)break;k.push(q);l.push(parseFloat(q))}for(h=0;h<Ba.length;h++)if(g===Ba[h].Sh&&(!Ba[h].Ta||Ca(Ba[h].Ta,Ba[h].Lh?k:l,void 0,!0))){f=Ba[h].Wh;if(void 0==f){k=null;break a}k=Ba[h].parameters?Ca(Ba[h].parameters,Ba[h].Lh?k:l,void 0,!0):null;l=Ia(f);h=new B(l,null,null);
l.Re?l.Re(h,k):h.h=k;k=h;break a}throw"unknown AESL block "+g;}k&&d.Yb(k,null,c,b,!0)}return d}
var tc=function(){var a=null;return function(c,b,d){null===a&&(a=document.createElement("a"),document.body.appendChild(a),a.style.display="none");d=d||"application/xml";if("function"===typeof window.Blob&&window.URL){var e=new window.Blob([c],{type:d});e=window.URL.createObjectURL(e)}else e="data:"+d+";base64,"+window.btoa(c);var f=a;d=d||"application/xml";"function"===typeof window.Blob&&window.URL?(c=new window.Blob([c],{type:d}),c=window.URL.createObjectURL(c)):c="data:"+d+";base64,"+window.btoa(c);
f.href=c;f.download=b||"untitled.xml";a.click();"string"!==typeof e&&window.URL.revokeObjectURL(e)}}();function ig(){this.Ob=document.getElementById("editor");this.Ob.value="";this.b=this.Ob.parentElement;var a=window.innerWidth,c=window.getComputedStyle(this.Ob);this.Ob.style.width=a-10-parseInt(c.paddingLeft,10)-parseInt(c.paddingRight,10)+"px";this.Ob.style.border="0px";this.Ob.style.outline="none";this.Ob.style.resize="none";this.Ob.style.whiteSpace="pre";this.Ob.setAttribute("wrap","off");this.i=null}ig.prototype.eg=function(a,c){this.Ob.setSelectionRange(a,c)};
ig.prototype.resize=function(){var a=this.b.getBoundingClientRect().width,c=window.getComputedStyle(this.Ob);this.Ob.style.width=a-10-parseInt(c.paddingLeft,10)-parseInt(c.paddingRight,10)+"px"};function jg(a,c){a.Ob.value=c;window.getComputedStyle(a.Ob)};function kg(a,c,b){this.ta=c;this.language=b||"aseba";this.b="";this.nd=!0;this.Md=this.Oe=this.Rg=null;this.Zb=!1;this.W=a.W||new Ra;this.Fc=new ig;this.Fc.Ob.readOnly=this.nd;this.Fc.i=function(a){window.vplBreakpointsFunction&&window.vplBreakpointsFunction(a)};var d=this;this.Ua=new Xb(a.Jb,{ia:a.ia});document.getElementById("editor").addEventListener("input",function(){Ec(a);lg(d)===a.j.ta&&(a.j.ta=!a.j.ta,H(a))},!1);var e=document.getElementById("editor");e&&document.getElementById("editor").addEventListener("keydown",
function(a){if(9===a.keyCode){a.preventDefault();a.b=!0;a=e.value;var b=this.selectionStart;a=a.slice(0,b)+"\t"+a.slice(this.selectionEnd);jg(d.Fc,a);this.selectionStart=this.selectionEnd=b+1;return!1}return!0},!1)}function mg(a,c){a.Rg=c}x=kg.prototype;x.We=function(){this.W.b=[]};function Bc(a,c,b){null===c?jg(a.Fc,a.b):(a.b=c,jg(a.Fc,c));b||(a.Md=null)}x.Bc=function(){return document.getElementById("editor").value.replace(/\s+$/,"")};function lg(a){return a.Bc()===a.b.trim()}
x.eg=function(a,c){this.Fc.eg(a,c)};function ng(a){var c=N(a.Ua.ia,{tag:"button",ga:["src","top"]});c.height=a.Ua.A.g;a=N(a.Ua.ia,{tag:"toolbar",ga:["src","top"]});a.height=c.ra();return{height:a.height,ra:a.ra()}}function eg(a,c,b,d,e){var f=new Uc(a.O.Ua);ld(f,a,c,["src","top"],a.O.he||sc,a.O.bf||gd);Wc(f,b,e,d);return f}
function Ec(a){var c=a.O;c.Ua.ob=[];var b=c.Mg||a.rb,d=wc(a,b,["src","top"]),e=ng(c).height,f=Qd(c.Ua);Pd(c.Ua);var g=N(c.Ua.ia,{tag:"view",ga:["src"]});N(c.Ua.ia,{tag:"button",ga:["src","top"]});var k=N(c.Ua.ia,{tag:"separator",ga:["src","top"]}),l=N(c.Ua.ia,{tag:"toolbar",ga:["src","top"]});g.Tc(f.width);g.Dc(f.height);g.setPosition(0,0);l.Tc(g.width);l.height=e;l.setPosition(g.x,g.y);Yc(c.Ua,function(a){g.J(a)});Xc(eg(a,b,l,k,d),l,d);J(c.Ua)}
function zc(a,c){(a.nd=c)&&jg(a.Fc,a.b);a.Fc.Ob.readOnly=c;Ec(window.vplApp)}
x.resize=function(a,c){this.Ua.resize(a,c);a=this.Ua.b.getBoundingClientRect();c=document.getElementById("src-editor");var b=Qd(this.Ua);var d=N(this.Ua.ia,{tag:"view",ga:["src"]});d.Tc(b.width);d.Dc(b.height);d.setPosition(0,0);var e=ng(this);b=d.x;var f=d.y+e.ra;var g=d.width;d=d.height-e.ra;c.style.left=a.left+a.width*this.Ua.Ja.Y+b+"px";c.style.width=g+"px";c.style.top=a.top+a.height*this.Ua.Ja.ba+f+"px";c.style.height=d+"px";this.Fc.resize();Ec(window.vplApp)};
x.focus=function(){document.getElementById("editor").focus();J(this.Ua)};function og(a){a.I.add("src:close",{action:function(a){a.qb(["src"],{Nf:!0})},object:a,$:function(a){return 1<a.Ka.length&&0<=a.Ka.indexOf("src")}});a.I.add("src:new",{action:function(a){jg(a.O.Fc,"");J(a.O.Ua)},isEnabled:function(a){return!a.O.nd&&0<a.O.Bc().length},object:a});a.I.add("src:save",{action:function(a){var b=pb(a.j,{qd:!1,td:!0});tc(b,a.j.filename||"program.vpl3","application/x-vpl3")},isEnabled:function(a){return 0<a.O.Bc().length},object:a});a.I.add("src:vpl",{action:function(a){a.we?
a.qb(["vpl"],{ye:!0}):a.qb(["vpl"],{ue:"src"})},isEnabled:function(a){return lg(a.O)},object:a,$:function(a){return!a.O.ta&&0>a.Ka.indexOf("vpl")}});a.I.add("src:locked",{action:function(a){zc(a.O,!a.O.nd);J(a.O.Ua);a.O.nd&&(a.j.ta=!1,H(a))},isEnabled:function(a){return null===a.O.Md},Pa:function(a){return a.O.nd},object:a,$:function(a){return!a.O.ta},lb:[{selected:!1},{selected:!0}]});a.I.add("src:language",{action:function(a){var b=a.O.Rg();a.O.language=b.language;a.O.nd&&Bc(a.O,b.code)},isEnabled:function(a){return null===
a.O.Md},getState:function(a){return a.O.language},object:a,$:function(a){return null!=a.O.Rg},lb:[{state:"aseba"},{state:"l2"},{state:"asm"},{state:"js"},{state:"python"}]});a.I.add("src:disass",{action:function(a){if(null!==a.O.Md)Bc(a.O,a.O.Md),a.O.Fc.Ob.readOnly=a.O.nd;else{var b=a.O.Bc(),c=a.O.Oe(a.O.language,b);null!==c&&(Bc(a.O,c,!0),a.O.Fc.Ob.readOnly=!0,a.O.Md=b)}Ec(a)},isEnabled:function(a){return null!=a.O.Oe&&null!==a.O.Oe(a.O.language,"")},Pa:function(a){return null!==a.O.Md},object:a,
$:function(a){return null!==a.O.Oe},lb:[{selected:!1},{selected:!0}]});a.I.add("src:run",{action:function(a){var b=a.O.Bc();a.Ga[a.la].Ma.nc(b,a.O.language)},isEnabled:function(a){return a.Ga[a.la].Ma.isEnabled(a.O.language)},object:a,$:function(a){return 0<=a.la}});a.I.add("src:stop",{action:function(a){Hc(a)},isEnabled:function(a){return Ic(a)},object:a,$:function(a){return 0<=a.la}});a.I.add("src:connected",{isEnabled:function(a){return!a.j.ta&&0<=a.la&&a.Ga[a.la].Ma.isConnected()},object:a,$:function(a){return 0<
a.Ga.length},lb:[{selected:!1},{selected:!0},{selected:!1,state:"monitored"},{selected:!0,state:"monitored"},{selected:!1,state:"nonmonitored"},{selected:!0,state:"nonmonitored"}]});a.I.add("src:sim",{action:function(a){a.we?a.qb(["sim"],{ye:!0}):a.qb(["sim"],{ue:"src"})},object:a,$:function(a){return null!=a.Ga.find(function(a){return"sim"===a.name})&&null!=a.M&&0>a.Ka.indexOf("sim")}});a.I.add("src:teacher-reset",{action:function(a){a.O.We();Ec(a)},object:a,pd:!0,$:function(a){return a.O.Zb&&a.O.W.hc}});
a.I.add("src:teacher",{action:function(a){a.O.W.hc=!a.O.W.hc;Ec(a)},Pa:function(a){return a.O.W.hc},object:a,pd:!0,$:function(a){return a.O.Zb},lb:[{selected:!1},{selected:!0}]})};function pg(a){var c=["vpl:message-error","vpl:message-warning","vpl:filename"];return function(b,d,e,f,g,k,l,h,q,p,t,u){function w(a){if(void 0==a)return!0;for(var b=0;b<a.length;b++)switch(a[b]){case "pressed":if(!t||!q)return!1;break;case "unpressed":if(t&&q)return!1;break;case "selected":if(!p)return!1;break;case "unselected":if(p)return!1;break;case "disabled":if(q)return!1;break;case "enabled":if(!q)return!1;break;default:if("="===a[b][0]&&(u||"").toString()!==a[b].slice(1))return!1}return!0}
if(a.buttons)for(var m=0;m<a.buttons.length;m++)if(a.buttons[m].name===d&&w(a.buttons[m].state)){var n=a.buttons[m];n.draw.forEach(function(b){if(b.uri){var c=Mc(b.uri);e.save();b.alpha&&(e.globalAlpha=b.alpha);var d={};n.styles&&n.styles.forEach(function(a){d[(a.complement?"!":"")+a.id]=a.st});a.Ib[c.ad].J(e,{qe:c.id,style:d});b.debug&&(e.fillStyle="black",e.textAlign="center",e.textBaseline="middle",e.fillText(b.debug,l.width/2,l.height/2));e.restore()}b.js&&(c={pressed:t&&q,unpressed:!(t&&q),selected:p,
unselected:!p,disabled:!q,enabled:q,state:u},b=new Function("ctx","$",b.js),e.save(),e.scale(l.width/1E3,l.height/1E3),e.beginPath(),b(e,c),e.restore())});return}0<=c.indexOf(d)?sc(b,d,e,f,g,k,l,h,q,p,t,u):(e.fillStyle="brown",e.fillRect(0,0,l.width,l.height),e.fillStyle="white",e.textAlign="left",e.textBaseline="top",e.font=Math.round(l.height/6).toString(10)+"px sans-serif",e.fillText(d,.02*l.width,.02*l.height),e.fillText((t?"pr ":"")+(p?"sel ":"")+(q?"":"dis"),.02*l.width,.22*l.height),u&&e.fillText("="+
u,.02*l.width,.42*l.height))}}function qg(a){return function(c,b){if(a.buttons)for(var d=0;d<a.buttons.length;d++){var e=a.buttons[d];if(e.name===c&&(void 0==e.state||0>e.state.indexOf("pressed")&&0>e.state.indexOf("selected")&&0>e.state.indexOf("disabled")))return c=Mc(e.draw[0].uri),Lf(a.Ib[c.ad],c.id)}return{Y:0,oa:b.g,ba:0,pa:b.g}}}
function rg(a){function c(b){for(var c=0;c<a.widgets.length;c++)if(a.widgets[c].name===b)return a.widgets[c];return null}if(void 0==a.widgets)return{};var b={};["vpl:then","vpl:error","vpl:warning","vpl:moreHigh","vpl:moreLow"].forEach(function(d){var e=c(d);if(e){var f=Mc(e.draw[0].uri),g=Lf(a.Ib[f.ad],f.id);b[d]=function(b,c,d,f){e.draw.forEach(function(c){if(c.uri){var d=Mc(c.uri);c.alpha&&(b.globalAlpha=c.alpha);b.save();var e=Math.min(f.width/(g.oa-g.Y),f.height/(g.pa-g.ba));b.scale(e,e);b.translate(-(g.Y+
g.oa)/2,-(g.ba+g.pa)/2);a.Ib[d.ad].J(b,{qe:d.id});b.restore();c.debug&&(b.fillStyle="black",b.textAlign="center",b.textBaseline="middle",b.fillText(c.debug,0,0))}c.js&&(c=new Function("ctx",c.js),b.save(),b.scale(f.width,f.height),b.beginPath(),c(b),b.restore())})}}});return b};function sg(a){this.Za=a&&a.nc?a.nc:null;this.u=a&&a.check?a.check:null;this.S=a&&a.wc?a.wc:null;this.w=a&&a.close?a.close:null;this.ca=a&&a.isConnected?a.isConnected:null;this.i=a&&a.isEnabled?a.isEnabled:null;this.ug=a&&a.Tf?a.Tf:null;this.l=a&&a.pf?a.pf:null;this.H=a&&a.getName?a.getName:null;this.fd=a&&a.fd?a.fd:"aseba";this.languages=a&&a.languages?a.languages:[this.fd];this.state=a&&a.state?a.state:null;this.ja=a&&a.ja?a.ja:{};this.$e=a&&a.$e?!0:!1;this.b=this.Ha=this.ma=null}x=sg.prototype;
x.isConnected=function(){return null==this.ca||this.ca()};x.isEnabled=function(a){return null!=this.Za&&0<=this.languages.indexOf(a)&&(null==this.i||this.i(a))};x.getName=function(){return null!=this.H?this.H():null};x.wc=function(a){this.S&&this.S(a)};x.close=function(){this.w&&this.w()};x.check=function(a,c,b){if(null==this.u||a===this.ma&&c===this.Ha)return this.b;var d=this;this.u(c,a,function(e){d.ma=a;d.Ha=c;e!==d.b&&(d.b=e,b(e))});return this.b};
x.nc=function(a,c){this.isEnabled(c)&&this.Za(c,a)};x.pf=function(a){return null!=this.ug&&0<=this.languages.indexOf(a)&&(null==this.l||this.l(a))};x.Tf=function(a,c){this.pf(c)&&this.ug(c,a)};function lc(a,c){function b(a,b,c,h){var g=document.createElement("div");null!=b?g.innerHTML=b:(g.textContent=a,g.style.font="bold 30px sans-serif",g.style.textAlign="left",g.style.padding="5px",g.style.paddingLeft="10px");g.style.position="absolute";g.style.width="32px";g.style.height="32px";g.style.top="0";g.style.cursor="default";c?(g.style.right=f.toString(10)+"px",f+=40):(g.style.left=e.toString(10)+"px",e+=40);g.addEventListener("click",function(){h()},!1);d.u.push(g)}this.w=a;this.b=document.createElement("div");
this.b.style.width="100%";this.b.style.height="100%";this.b.style.position="fixed";this.b.style.top="0";this.b.style.left="0";this.b.style.zIndex="1000";this.b.style.backgroundColor="rgba(1,1,1,0.5)";this.b.style.display="none";this.i=document.createElement("div");this.i.style.width="80%";this.i.style.height="80%";this.i.style.position="fixed";this.i.style.top="50%";this.i.style.left="50%";this.i.style.backgroundColor="white";this.b.appendChild(this.i);document.body.appendChild(this.b);a=document.createElement("div");
a.style.width="100%";a.style.height="100%";c&&c.scroll&&(a.style.overflowY="scroll");this.i.appendChild(a);this.l=document.createElement("div");this.l.style.backgroundColor="white";this.l.style.width="100%";this.l.style.height="100%";a.appendChild(this.l);this.u=[];var d=this,e=0,f=30;c&&c.fi||b("\u00d7",null,!1,function(){d.vc()});c&&c.th&&c.th.forEach(function(a){b(a.title,a.di,!0,a.Fa)});this.sd=c&&c.sd||null;this.rd=c&&c.rd||null}
lc.prototype.show=function(){this.u.forEach(function(a){this.i.appendChild(a)},this);this.l.innerHTML=this.w;this.b.style.display="block";Gc(this);this.sd&&this.sd()};lc.prototype.vc=function(){this.b.style.display="none";this.rd&&this.rd()};function Gc(a){var c=a.i.getBoundingClientRect();a.i.style.marginLeft=-c.width/2+"px";a.i.style.marginTop=-c.height/2+"px"};function tg(a,c,b){c=c.toLowerCase();switch(c){case "html":case "htm":if(b){c=/<img\s[^>]*src=['"](?!\w+:)([^'"]+)['"]/;for(var d=0;d<a.length;){var e=c.exec(a.slice(d));if(null==e)break;var f=e[1];d=d+e.index+e[0].indexOf(f);e=b(f);a=a.slice(0,d)+e+a.slice(d+f.length);d+=e.length}}return a;case "txt":return"<pre style='width: 100%; height: 100%; padding: 3em;'>"+a.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"</pre>";case "md":return c=new Va,c.i=b||null,"<div style='width: 100%; height: 100%; padding: 3em;'>"+
Xa(c,a.split("\n"))+"</div>";case "gif":case "jpg":case "jpeg":case "png":case "svg":return"<div style='display: table; height: 100%; width: 100%; overflow: hidden;'><div style='display: table-cell; vertical-align: middle; text-align: center;'>"+("<img src='data:"+ug[c]+";base64,"+btoa(a)+"' style='max-width:100%;max-height:100%;'>")+"</div></div>";default:return""}}
var ug={gif:"image/gif",htm:"text/html",html:"text/html",jpeg:"image/jpeg",jpg:"image/jpeg",md:"text/markdown",png:"image/png",svg:"image/svg+xml",txt:"text/plain"};function Oc(a,c,b){try{qb(a.j,c,function(a){if(0>this.Ka.indexOf(a))if(1===this.Ka.length)this.qb([a]);else{var b=this.Ka.slice();b[0<=b.indexOf("vpl")?b.indexOf("vpl"):0<=b.indexOf("src")?b.indexOf("src"):0]=a;this.qb(b)}this.Eg=!0;uc(this);0<=this.Ka.indexOf("vpl")&&this.aa.qa()},b)}catch(d){}}
function Qc(a,c){var b=/(\.[^.]*|)$/.exec(c.name)[0].slice(1).toLowerCase(),d=new window.FileReader;switch(b){case "aesl":case "vpl3":case "vpl3ui":case "json":return d.onload=function(d){d=d.target.result;var e=c.name,g=!1;"<"===d.trim()[0]?gg(a.j,d):(g="vpl3ui"===b,Oc(a,d,{gh:g}));g||(a.j.filename=e);a.aa.qa()},d.readAsText(c),!0;case "zip":return d.onload=function(b){b=b.target.result;var c=new vg;c.load(atob(b.slice(b.indexOf(",")+1)),function(){function b(d,e,f){return function(g){var h=wg(g),
k=xg(c,g,function(){var c=tg(e,wg(d),b(d,e,f));oc(a,c,f)});return k?"data:"+ug[h.toLowerCase()]+";base64,"+k:g}}jc(a,!0);a.ve&&Oc(a,a.ve);a.j.filename=null;uc(a);a.hg=null;var d=yg(c.u,zg),e=yg(c.u,Ag),f=yg(c.u,Bg),q=yg(c.u,Cg);0<e.length?Dg(c,e[0].filename,!1,function(b){/^[\s]*{/.test(b)?Oc(a,b):(gg(a.j,b),a.aa.qa());a.j.filename=e[0].filename;Me(a.aa)}):0<d.length&&Dg(c,d[0].filename,!1,function(b){Oc(a,b);Me(a.aa)});0<f.length&&Dg(c,f[0].filename,!0,function(c){c=atob(c);c=tg(c,wg(f[0].filename),
b(f[0].filename,c,!1));oc(a,c,!1)});0<q.length&&Dg(c,q[0].filename,!0,function(c){c=atob(c);c=tg(c,wg(q[0].filename),b(q[0].filename,c,!0));oc(a,c,!0);Me(a.aa)});H(a)})},d.readAsDataURL(c),!0}return!1}
function Eg(a,c){var b=/^[^.]+\.(.*)$/.exec(c.name);b=b?b[1]:"";var d=new window.FileReader;switch(b.toLowerCase()){case "svg":case "png":case "jpg":case "gif":return a.M&&("obstacle"===a.M.Mc?(d.onload=function(b){Fg(a,b.target.result)},d.readAsText(c)):(d.onload=function(b){b=b.target.result;var c=new Image;c.addEventListener("load",function(){Gg(a,c)});c.src=b},d.readAsDataURL(c))),!0}return!1}
function Hg(a,c){var b=/^[^.]+\.(.*)$/.exec(c.name);b=b?b[1]:"";var d=new window.FileReader;switch(b.toLowerCase()){case "wav":a.M&&(d.onload=function(b){a.M.ka.setFile(c.name,b.target.result)},d.readAsArrayBuffer(c))}};function Ig(a){return JSZip.apply(this,arguments)||this}Ig.prototype=aa(JSZip.prototype);Ig.prototype.constructor=Ig;if(fa)fa(Ig,JSZip);else for(var Jg in JSZip)if("prototype"!=Jg)if(Object.defineProperties){var Kg=Object.getOwnPropertyDescriptor(JSZip,Jg);Kg&&Object.defineProperty(Ig,Jg,Kg)}else Ig[Jg]=JSZip[Jg];Ig.b=JSZip.prototype;Ig.prototype.forEach=function(a){for(var c in this.files)if(c.slice(0,this.root.length)===this.root){var b=c.slice(this.root.length);/^[^\/]+\/?$/.test(b)&&a(b,this.files[c])}};
Ig.prototype.getEntries=function(){var a=[];this.forEach(function(c,b){a.push(b)});return a};Ig.prototype.getCompleteFileList=function(){var a=[],c;for(c in this.files)this.files[c].dir||a.push(c);return a};function vg(){this.i=null;this.H=[];this.b="";this.u=new Lg;this.w={};this.l={}}
vg.prototype.load=function(a,c){var b=this;this.i=new Ig;this.H=[];this.b="";var d=this;this.i.loadAsync(a).then(function(){b.b="";var a=b.i.getEntries();1===a.length&&a[0].dir&&(b.b=a[0].name);b.H=b.i.getCompleteFileList().map(function(a){return a.slice(b.b.length)});(a=d.i.file(b.b+Mg))?a.async("string").then(function(a){Ng(d.u,a,d.H);c&&c(b)}):c&&c(b)})};
function Dg(a,c,b,d){void 0!=(b?a.l:a.w)[c]?d&&d((b?a.l:a.w)[c]):a.i.file(a.b+c).async(b?"uint8array":"string").then(function(e){if(b){for(var f="",g=0;g<e.length;g++)f+=String.fromCharCode(e[g]);e=btoa(f)}(b?a.l:a.w)[c]=e;d(e)})}function xg(a,c,b){return void 0==a.l[c]?(Dg(a,c,!0,function(a){b&&b(a)}),null):a.l[c]}function wg(a){return/(\.[^.]*|)$/.exec(a)[0].slice(1)}function Lg(){this.files=[]}
function Ng(a,c,b){a.files=[];c=c.split("\n").map(function(a){return a.trim()});for(var d=0;d<c.length;d++)if(":"===c[d].slice(-1)){var e=Og;switch(c[d].slice(0,-1).trim().toLowerCase()){case "vpl3":e=Ag;break;case "ui":e=zg;break;case "program":e=Pg;break;case "attention":e=Qg;break;case "doc":e=Bg;break;case "statement":e=Cg}if(e!==Og)for(var f=/([-_\/.\p{Letter}0-9]+)(\s+\([^)]*\))?$/u;d+1<c.length;d++){var g=c[d+1];if(""!=g){g=f.exec(g);if(null==g)break;g=g[1];0<=b.indexOf(g)&&a.files.push(new Rg(g,
e))}}}}function yg(a,c){return a.files.filter(function(a){return a.type===c})}function Rg(a,c){this.filename=a;this.type=c}var Og=0,Ag=1,zg=2,Pg=3,Qg=4,Bg=5,Cg=6,Mg="manifest.txt";function Sg(a,c){var b=this;this.b=document.createElement("div");this.b.style.width="100%";this.b.style.height="100%";this.b.style.position="fixed";this.b.style.top="0";this.b.style.left="0";this.b.style.zIndex="1000";this.b.style.backgroundColor="rgba(1,1,1,0.5)";this.b.style.display="none";this.i=document.createElement("div");this.i.style.width="40em";this.i.style.position="fixed";this.i.style.top="50%";this.i.style.left="50%";this.i.style.backgroundColor="white";this.i.style.padding="2em";this.b.appendChild(this.i);
document.body.appendChild(this.b);var d=document.createElement("p");this.w=d;this.i.appendChild(d);d=document.createElement("table");d.style.width="100%";this.i.appendChild(d);var e=document.createElement("tr");d.appendChild(e);var f=document.createElement("td");e.appendChild(f);this.input=document.createElement("input");this.input.setAttribute("type","file");this.input.style.width="35em";f.appendChild(this.input);f=document.createElement("td");f.align="right";e.appendChild(f);e=document.createElement("input");
e.setAttribute("type","button");e.setAttribute("value",a.i.translate("OK"));e.addEventListener("click",function(){var a=b.input.files[0];a&&b.l(a);b.vc()},!1);f.appendChild(e);f.appendChild(document.createTextNode("\u00a0\u00a0"));e=document.createElement("input");e.setAttribute("type","button");e.setAttribute("value",a.i.translate("Cancel"));e.addEventListener("click",function(){b.vc()},!1);f.appendChild(e);f=document.createElement("div");f.style.position="absolute";f.style.width="32px";f.style.height=
"32px";f.style.top="0";f.style.left="0";f.textContent="\u00d7";f.style.font="bold 30px sans-serif";f.style.textAlign="left";f.style.padding="5px";f.style.paddingLeft="10px";f.addEventListener("click",function(){b.vc()},!1);d.appendChild(f);this.u=a.i;this.l=null;this.sd=c&&c.sd||null;this.rd=c&&c.rd||null}
Sg.prototype.show=function(a,c,b){this.w.textContent=this.u.translate(a);this.input.setAttribute("accept",c);this.l=b;this.b.style.display="block";a=this.i.getBoundingClientRect();this.i.style.marginLeft=-a.width/2+"px";this.i.style.marginTop=-a.height/2+"px";this.sd&&this.sd()};Sg.prototype.vc=function(){this.b.style.display="none";this.rd&&this.rd()};function Tg(a,c,b){this.b=a;this.l=c;this.sc=null;this.i=!1;this.sessionId=b;var d=this;setInterval(function(){null!=d.sc&&2<=d.sc.readyState&&(!1!==d.b.Bf&&(d.b.Bf=!1,H(d.b)),d.connect())},5E3)}function Ug(a,c,b,d){a=a.b.I;if(a.$(c)&&Rb(a,c)&&a.isEnabled(c))if(void 0!==b){d=a.find(c);var e;if(e=d)d.w?b===d.Pa()?e=!0:(d.Dd(void 0),e=b===d.Pa()):e=!1;e&&Sb(a,c)}else void 0!==d?(b=a.find(c))&&Tb(b,d)&&Sb(a,c):a.Dd(c)}
Tg.prototype.connect=function(){var a=this;this.sc=new WebSocket(this.l);this.sc.addEventListener("open",function(){a.b.Bf=!0;a.sc.send(JSON.stringify({sender:{type:"vpl",sessionid:a.sessionId,role:a.b.j.Zb?"teacher":"student"},type:"hello"}));window.addEventListener("unload",function(){a.sc.send(JSON.stringify({sender:{type:"vpl",sessionid:a.sessionId,role:a.b.j.Zb?"teacher":"student"},type:"bye"}))});H(a.b)});this.sc.addEventListener("message",function(c){try{var b=JSON.parse(c.data);"defaultfile"!==
b.type||a.b.zd||(b.type="file");window.vplListenToCom&&window.vplListenToCom(b);switch(b.type){case "cmd":Ug(a,b.data.cmd,b.data.selected,b.data.state);Me(a.b.aa);break;case "file":var d=b.data.content,e=b.data.base64||!1,f=/(\.[^.]*|)$/.exec(b.data.name||"")[0].slice(1).toLowerCase();switch(b.data.kind){case "vpl":e&&(d=btoa(d));/^[\s]*{/.test(d)?Oc(a.b,d,{gh:"vpl3ui"===f}):(gg(a.b.j,d),a.b.aa.qa());"vpl3ui"!==f&&(a.b.j.filename=b.data.name||null);Me(a.b.aa);break;case "aseba":e&&(d=btoa(d));a.b.Ga[a.b.la].Ma.nc(d,
"aseba");a.b.j.Vb=!1;break;case "about":kc(a.b,tg(e?atob(d):d,f));break;case "help":oc(a.b,tg(e?atob(d):d,f));break;case "settings":e&&(d=btoa(d));var g=JSON.parse(d);g.hasOwnProperty("volume")&&(a.b.j.volume=g.volume);break;case "statement":oc(a.b,tg(e?atob(d):d,f),!0);Me(a.b.aa);break;case "suspend":var k=a.b,l=tg(e?atob(d):d,f),h=k.Uc;h&&k.De&&k.De.vc();k.De=l?new lc(l,{fi:!0}):null;l&&h&&k.De.show()}break;case "robot":var q=b.data.robot,p=b.data.url||null,t=b.data.url||null,u=b.data.uuid||null,
w=b.data.pass||null;c=null;switch(q){case "thymio":p&&(c=Vg(a.b,{Th:p}),c.wc(c.fd));break;case "thymio-tdm":!t&&0<=a.b.la&&a.b.Ga[a.b.la].Ma.ja.rc&&(t=a.b.Ga[a.b.la].Ma.ja.rc);t&&(c=Wg(a.b,{rc:t,Nh:u,vh:w}),c.wc(c.fd));break;case "sim":c=Xg(a.b,{}),c.wc(c.fd)}c&&(Ug(a,"vpl:stop"),0<=this.la&&this.Ga[this.la].Ma.stop(),a.b.Ga=[{name:q,Ma:c}],a.b.la=0,Me(a.b.aa));break;default:Me(a.b.aa)}}catch(m){console.info(m)}});this.i||(Jc(this.b,function(c){a.log(c)}),this.i=!0)};
Tg.prototype.log=function(a){try{if("cmd"===a.type&&a.data&&0<=["vpl:run","vpl:save","vpl:upload"].indexOf(a.data.cmd)){var c=pb(this.b.j,{qd:!1,td:!0});this.sc.send(JSON.stringify({sender:{type:"vpl",sessionid:this.sessionId},type:"file",data:{name:this.b.j.filename,content:c},reason:a.data.cmd}))}this.sc.send(JSON.stringify({sender:{type:"vpl",sessionid:this.sessionId},type:"log",data:a||null}))}catch(b){}};function Zb(){this.b=[]}function $b(a){function c(a){0<b.b.length&&b.b[b.b.length-1].Fa(a)&&a.preventDefault()}var b=a;window.addEventListener("keydown",function(a){c(a)});window.addEventListener("message",function(a){a.origin===window.origin&&c(a.data)},!1)}function ec(a,c,b){a.b.push({Fa:c,Tg:!0===b});Yg(!0===b)}function mc(a,c){a.b.push({Fa:function(a){return"Escape"===a.key?(c(),!0):!1},Tg:!1});Yg(!1)}function Zg(a,c){var b=nc(a);ec(a,function(a){return b.Fa(a)||c(a)},b.Tg)}
function nc(a){Yg(1<a.b.length&&a.b[a.b.length-2].Tg);return a.b.pop()}function Yg(a){a?(null==$g&&(a=document.createElement("input"),a.setAttribute("style","width:0;height:0;position:absolute;left:-10pt;top:-10pt;"),$g=a,document.body.appendChild(a)),$g.focus()):null!=$g&&$g.blur()}var $g=null;function ic(a,c){this.w=a;this.v=c.mh||"";(this.Ec=c.Ec||"")&&this.Ec!==this.v.slice(-this.Ec.length)&&(this.Ec="");this.Rc=c.Rc;this.b=0;this.i=this.v.length-this.Ec.length;this.u=null;this.l=[];this.ca=c.display||function(){};this.H=c.finish||function(){};var b=this;ec(this.w.l,function(a){if(a.ctrlKey||a.metaKey)return!1;switch(a.key){case "Escape":b.finish(!1);break;case "Enter":b.finish(!0);break;case "ArrowLeft":b.i>b.b?(b.i=b.b,b.display()):0<b.b&&(b.b--,b.i=b.b,b.display());break;case "ArrowRight":b.i>
b.b?(b.b=b.i,b.display()):b.b<b.v.length-b.Ec.length&&(b.b++,b.i=b.b,b.display());break;case "Backspace":b.i>b.b?(b.v=b.v.slice(0,b.b)+b.v.slice(b.i),b.i=b.b,b.display()):0<b.b&&(b.v=b.v.slice(0,b.b-1)+b.v.slice(b.b),b.b--,b.i=b.b,b.display());break;case "Delete":b.i>b.b?(b.v=b.v.slice(0,b.b)+b.v.slice(b.i),b.i=b.b,b.display()):b.b<b.v.length-b.Ec.length&&(b.v=b.v.slice(0,b.b)+b.v.slice(b.b+1),b.display());break;default:/^\w{2,}$/.test(a.key)||(b.v=b.v.slice(0,b.b)+a.key+b.v.slice(b.i),b.b+=a.key.length,
b.i=b.b,b.display())}return!0},!0)}ic.prototype.display=function(){this.ca(this.v,this.b,this.i)};ic.prototype.finish=function(a){this.H(a?this.v:null);nc(this.w.l)};function cd(a,c,b){a.u=c;a.l=b};function hc(a,c){ic.call(this,a,c);nc(this.w.l);this.input=document.createElement("input");this.input.style.position="absolute";this.input.style.left="-1000px";this.input.style.top="-1000px";this.input.value=this.Ec?this.v.slice(0,-this.Ec.length):this.v;this.input.selectionStart=0;this.input.selectionEnd=this.input.value.length;var b=this;this.input.addEventListener("input",function(){b.v=b.input.value+b.Ec;b.b=b.input.selectionStart;b.i=b.input.selectionEnd;b.display()},!1);this.S=function(){b.b=
b.input.selectionStart;b.i=b.input.selectionEnd;b.display()};document.addEventListener("selectionchange",this.S,!1);this.input.addEventListener("change",function(){b.input&&b.finish(!0)},!1);document.body.appendChild(this.input);this.input.focus();ec(this.w.l,function(a){return"Escape"===a.key?(b.finish(!1),!0):!1})}hc.prototype=Object.create(ic.prototype);hc.prototype.constructor=hc;
hc.prototype.finish=function(a){this.H(a?this.input.value+this.Ec:null);document.removeEventListener("selectionchange",this.S,!1);a=this.input;this.input=null;document.body.removeChild(a);nc(this.w.l)};function ac(a){this.l=a;this.ma=0;this.S=1;this.Ha=0;this.ca=1;this.i=cc;this.H=this.u=this.b=0;this.Ra=cc;this.w=this.Ab=0}var cc="",Sd="tb1",Ud="tb2",Id="bl",Kd="br",Jd="blp",Ld="brp",I="r",Vd="ll",$d="lr",zd={Gi:cc,Mi:Sd,Li:Ud,pi:Id,si:Kd,ri:Jd,ti:Ld,Ii:I,Ei:Vd,Fi:$d};function ah(a){switch(a.i){case I:return a.l.j.j[a.b];case Id:return a.l.j.j[a.b].X[a.u];case Kd:return a.l.j.j[a.b].actions[a.u];default:return null}}
function bh(a){switch(a.i){case Jd:return a.l.j.j[a.b].X[a.u];case Ld:return a.l.j.j[a.b].actions[a.u];default:return null}}function ch(a){switch(a.i){case Vd:return Od(a.l,!1,a.b+a.S*a.u);case $d:return Od(a.l,!0,a.b+a.ca*a.u);default:return null}}function jd(a){switch(a.Ra){case I:return a.l.j.j[a.Ab];case Id:return a.l.j.j[a.Ab].X[a.w]||a.l.j.j[a.Ab];case Kd:return a.l.j.j[a.Ab].actions[a.w]||a.l.j.j[a.Ab];default:return null}}
function dh(a,c){if(c=c?a.l.yc:a.l.Jc){for(var b=0,d=0;d<c.length;d++)if(c[d]&&"!"!==c[d][0]&&hd(a.l,c[d])){var e=a.l.I.find(c[d]);(e.b||e.i)&&b++}return b}return 0}function Td(a){switch(a.i){case Sd:var c=a.l.Jc;break;case Ud:c=a.l.yc;break;default:return null}for(var b=a.b,d=0;d<c.length;d++)if(c[d]&&"!"!==c[d][0]&&hd(a.l,c[d])){var e=a.l.I.find(c[d]);if(e.b||e.i){if(0===b)return e;b--}}return null}
function Wd(a,c){var b=jd(a),d=a.l;b instanceof B&&(a.Ra===Id?"a"===c.type:"e"===c.type||"s"===c.type)&&(b=b.Gb,a.Ra=I);b instanceof Ja&&!(b instanceof Qa)?(c=new B(c,null,null),b.Yb(c,null,function(){d.j.yb()},function(){mb(d.j)})):b instanceof B&&(c=new B(c,null,null),b.Gb.Yb(c,{kd:a.Ra===Id,index:a.w},function(){d.j.yb()},function(){mb(d.j)}));jb(d.j)}function kd(a,c){if(c.b)c.b(a.l,!1);else{var b=jd(a);(b&&c.l?c.l(a.l,{data:b}):c.i)&&c.i(a.l,{data:b})}}
function fc(a){Zg(a.l.l,function(c){function b(){return a.l.j.j[a.b].X.length+(kb(a.l.j)?0:1)}function d(){return a.l.j.j[a.b].actions.length+1}function e(){var b=ah(a)||ch(a);b instanceof B?a.l.u=b.T.name:b instanceof y?a.l.u=b.name:a.l.u=null}if(a.l.W.wb)return!1;switch(c.key){case "Escape":switch(a.i){case Id:case Kd:a.Ra==a.i&&a.Ab==a.b&&a.w==a.u?a.Ra=cc:a.i=I;break;case Jd:a.i=Id;break;case Ld:a.i=Kd;break;default:a.i=cc,a.Ra=cc}e();H(a.l);return!0;case "Enter":switch(a.i){case cc:a.i=I;a.b=
0;a.Ra=I;a.Ab=0;break;case I:c=ah(a);c instanceof Qa?Sc(a.l,a.b):(a.i=Id,a.u=0);break;case Id:case Kd:c=ah(a);c instanceof B&&c.T.ha&&(a.i=a.i===Id?Jd:Ld,a.H=0);break;case Sd:case Ud:c=Td(a),null!=c&&kd(a,c)}e();H(a.l);return!0;case " ":switch(a.i){case Id:case Kd:a.Ra=a.i;a.Ab=a.b;a.w=a.u;break;case Jd:case Ld:var f=bh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.l&&c.l(f));break;case I:a.Ra=a.i;a.Ab=a.b;a.u=0;break;case Vd:case $d:c=ch(a),Wd(a,c)}e();H(a.l);return!0;case "Backspace":c=ah(a);switch(a.i){case I:case Id:case Kd:if(a.l.I.gb("vpl:trashcan",
{data:c})){a.l.I.pb("vpl:trashcan",{data:c});switch(a.i){case I:a.b>=a.l.j.j.length&&a.b--;break;case Id:0<a.u&&a.u+1>=b()&&a.u--;break;case Kd:0<a.u&&a.u+1>=d()&&a.u--}a.Ra=cc;e();H(a.l)}}return!0;case "ArrowRight":switch(a.i){case I:if(null===a.Ra||a.Ra===I)a.Ra=I,a.Ab=a.b;a.i=$d;a.b=0;a.u=0;break;case Vd:a.u<Math.floor(a.ma/a.S)-(a.b<a.ma%a.S?0:1)?a.u++:(a.i=I,a.b=0);break;case $d:a.u=Math.min(a.u+1,Math.floor(a.Ha/a.ca)-(a.b<a.Ha%a.ca?0:1));break;case Id:a.u+1>=b()?(a.i=Kd,a.u=0):a.u++;break;
case Kd:a.u<d()-1?a.u++:a.i=I;break;case Jd:case Ld:f=bh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.i&&c.i(f));break;case Sd:a.b=Math.min(a.b+1,dh(a,!1)-1);break;case Ud:a.b=Math.min(a.b+1,dh(a,!0)-1)}e();H(a.l);return!0;case "ArrowLeft":switch(a.i){case I:if(null===a.Ra||a.Ra===I)a.Ra=I,a.Ab=a.b;a.i=Vd;a.b=0;a.u=Math.ceil(a.ma/a.S)-1;break;case Vd:a.u=Math.max(a.u-1,0);break;case $d:0<a.u?a.u--:(a.i=I,a.b=0);break;case Id:0<a.u?a.u--:a.i=I;break;case Kd:0===a.u?(a.i=Id,a.u=b()-1):a.u--;break;case Jd:case Ld:f=
bh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.b&&c.b(f));break;case Sd:a.b=Math.max(a.b-1,0);break;case Ud:a.b=Math.max(a.b-1,0)}e();H(a.l);return!0;case "ArrowUp":switch(a.i){case I:0===a.b?0<dh(a,!1)&&(a.i=Sd,a.b=0):a.b=Math.max(a.b-1,0);break;case Id:case Kd:0===a.b?0<dh(a,!1)&&(a.i=Sd,a.b=0):(a.b=Math.max(a.b-1,0),a.u=Math.min(a.u,(a.i===Id?b():d())-1));break;case Vd:case $d:a.b=Math.max(a.b-1,0);break;case Jd:case Ld:f=bh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.i&&c.i(f));break;case Ud:a.i=
I,a.b=Math.max(a.l.j.j.length-1,0)}e();H(a.l);return!0;case "ArrowDown":switch(a.i){case I:a.b>=a.l.j.j.length-1?0<dh(a,!0)&&(a.i=Ud,a.b=0):a.b=Math.min(a.b+1,a.l.j.j.length-1);break;case Id:case Kd:a.b>=a.l.j.j.length-1?0<dh(a,!0)&&(a.i=Ud,a.b=0):(a.b=Math.min(a.b+1,a.l.j.j.length-1),a.l.j.j[a.b]instanceof Qa?a.i=I:a.u=Math.min(a.u,(a.i===Id?b():d())-1));break;case Vd:a.b=Math.min(a.b+1,(a.u<Math.floor(a.ma/a.S)?a.S:a.ma%a.S)-1);break;case $d:a.b=Math.min(a.b+1,(a.u<Math.floor(a.Ha/a.ca)?a.ca:a.Ha%
a.ca)-1);break;case Jd:case Ld:f=bh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.b&&c.b(f));break;case Sd:a.i=I,a.b=0}e();H(a.l);return!0;case "Tab":switch(a.i){case Jd:case Ld:f=bh(a),null!=f.T.ha&&(f=f.T.ha.controls.length,a.H=(a.H+(c.shiftKey?f-1:1))%f)}e();H(a.l);return!0}return!1})}
function yd(a,c,b){function d(a){return a.bottom-a.top>a.right-a.left?b<(a.top+a.bottom)/2:c>(a.left+a.right)/2}a=jd(a);if(a instanceof B){var e=a.T.ha;if(void 0!=e)for(var f=0;f<e.controls.length;f++){var g=e.controls[f];if(c>=g.left&&c<=g.right&&b>=g.top&&b<=g.bottom){g.u?g.u(a,(c-g.left)/(g.right-g.left),(b-g.top)/(g.bottom-g.top)):g.l?g.l(a):g.b&&!d(g)?g.b(a):g.i&&d(g)&&g.i(a);break}}}};var Ee=null;document.addEventListener("mousemove",function(a){null!==Ee&&(Ee(a,!1,!1),a.preventDefault())},!1);document.addEventListener("mouseup",function(a){null!==Ee&&(Ee(a,!0,!1),Ee=null,a.preventDefault())},!1);var Je=null;document.addEventListener("touchmove",function(a){null!==Ee&&(Je=a.targetTouches[0],Ee(Je,!1,!0),a.preventDefault());return!1},{capture:!1,passive:!1});document.addEventListener("touchend",function(a){null!==Ee&&(Ee(Je,!0,!0),Ee=null,a.preventDefault());return!1},!1);
function eh(a,c,b,d,e){var f=0<=a.indexOf("/")?a.replace(/\/[^/]*$/,"/"):"",g={},k=new XMLHttpRequest;k.addEventListener("load",function(){if(200===k.status){g[a]=k.responseText;var c=JSON.parse(k.responseText),h=b(c),q=h.length,p=!1;h.forEach(function(b){var h=new XMLHttpRequest;h.addEventListener("load",function(){200===h.status?(g[b]=h.responseText,q--,p||0!==q||d(c,g)):p||(p=!0,e("HTTP error "+h.status))});h.addEventListener("error",function(){p||(p=!0,e("XMLHttpRequest error for "+a))});h.open("GET",
f+b);h.send()})}else e("HTTP error "+k.status)});k.addEventListener("error",e);k.open("GET",a);k.send()}
function fh(a,c,b,d,e){function f(a){var b=document.getElementById(a);if(null==b)throw"Missing script element "+a;return b.textContent}try{var g=f(a),k=JSON.parse(g),l={};k.svgFilenames&&k.svgFilenames.forEach(function(a){g=f(a);l[a]=g});k.overlays&&k.overlays.forEach(function(a){g=f(a);l[a]=g});k.css&&k.css.forEach(function(a){g=f(a).trim();l[a]=g});if(k.doc)for(var h in k.doc)if(k.doc.hasOwnProperty(h))for(var q in k.doc[h])k.doc[h].hasOwnProperty(q)&&(g=f(k.doc[h][q]).trim(),l[k.doc[h][q]]=g);
d(k,l)}catch(p){e(p)}}function gh(a){var c=window.vplQueryOptions||"",b=/^[^?]*\?([^#]*)/.exec(document.location.href);b&&(c=c?b[1]+"&"+c:b[1]);if(c)for(c=c.split("&").map(function(a){return a.split("=").map(function(a){return decodeURIComponent(a)})}),b=0;b<c.length;b++)if(c[b][0]===a)return c[b][1];return""}
function hh(a){return(document.location.hash||"#").slice(1).split("&").map(function(a){return a.split("=").map(decodeURIComponent)}).reduce(function(a,b){a[b[0]]=b[1];return a},{})[a]||null}
function ih(a,c){void 0===window.vplTextFieldInputEvents&&(window.vplTextFieldInputEvents=0<=navigator.userAgent.indexOf("Android"));var b=[];a&&a.overlays&&a.overlays.forEach(function(c){try{var d=JSON.parse(a.de[c])}catch(z){console.error(z.message)}for(var e in d)if(d.hasOwnProperty(e))switch(e){case "blocks":case "blockList":case "aeslImportRules":case "buttons":case "widgets":a[e]=a[e]?a[e].concat(d[e]):d[e];break;case "toolbars":for(var f in d[e])d[e].hasOwnProperty(f)&&(a[e]=a[e]||{},a[e][f]=
d[e][f]);break;case "i18n":for(f in d[e])if(d[e].hasOwnProperty(f)){a[e]=a[e]||{};a[e][f]=a[e][f]||{};for(var g in d[e][f])d[e][f].hasOwnProperty(g)&&(a[e][f][g]=d[e][f][g])}break;case "help":b.push(d[e])}});var d=document.getElementById("programCanvas"),e=gh("role"),f=gh("shortcuts"),g=new Ub(d);f&&(g.W.l="true"===f);g.W.u=0<=gh("accessibility").split("+").indexOf("kbd");g.W.i=0<=gh("accessibility").split("+").indexOf("nodrag");g.wd=void 0==window.vplSimMaps?"ground,height,obstacles":"merged"===
window.vplSimMaps?null:window.vplSimMaps.split(",");window.vplApp=g;g.username=gh("user")||window.vplUsername||g.username;dc(g);a&&Lc&&(g.j.message=Lc(a),g.j.message&&window.console.info(g.j.message));a&&a.css&&(g.ia.H(),a.css.forEach(function(b){de(g.ia,b,a.de[b])}),g.ia.defineProperties());if(a&&a.i18n)for(var k in a.i18n)a.i18n.hasOwnProperty(k)&&Ua(g.i,k,a.i18n[k]);d=gh("uilanguage")||"en";g.i.language=d;g.Te=new Sg(g,g.W.l?{sd:function(){mc(g.l,function(){g.Te.vc()})},rd:function(){nc(g.l)}}:
null);window.vplStorageSetFunction&&(g.j.w=function(){var a=pb(window.vplApp.j);window.vplStorageSetFunction("program.vpl3",a)});k=void 0==a||a["hardcoded-gui"]||"classic"===gh("appearance");g.Sg="local"===gh("storage");g.we="false"!==gh("multiview");var l=gh("language");Be="true"===gh("cssdebug");var h=sc,q=gd,p=od;if(a){if(k)null!==a.blocks&&0<a.blocks.length&&(a.blocks||[]).forEach(function(a){var b=Ia(a.name);yf(a,b.Mb);a.typicalParamSet&&(b.df=a.typicalParamSet)});else if(null!==a.buttons&&0<
a.buttons.length&&(h=pg(a),q=qg(a)),null!==a.widgets&&0<a.widgets.length&&(p=rg(a)),null!==a.blocks&&0<a.blocks.length)try{Zf(a)}catch(ma){window.console&&window.console.error(ma)}if(a.blockList){var t=[];G.forEach(function(a){"h"===a.type&&t.push(a)});a.blockList.forEach(function(a){t.push(Ia(a))});G=t}a.aeslImportRules&&0<a.aeslImportRules.length&&(Ba=a.aeslImportRules.map(function(a){return{Sh:a.aeslName,Ta:a.condition||null,Wh:a.blockName,parameters:a.parameters||null,Lh:a.stringParam||!1}}));
a.miscSettings&&void 0!=a.miscSettings.advancedModeEnabled&&(eb=1==a.miscSettings.advancedModeEnabled);a.miscSettings&&void 0!=a.miscSettings.basicMultiEvent&&(bb=1==a.miscSettings.basicMultiEvent);a.miscSettings&&void 0!=a.miscSettings.advancedMultiEvent&&(db=1==a.miscSettings.advancedMultiEvent);a.miscSettings&&a.miscSettings.viewRelativeSizes&&(d=a.miscSettings.viewRelativeSizes,g.Ad={vpl:d.vpl||1,src:d.src||1,sim:d.sim||1})}d=gh("server");f=gh("session");var u="true"===gh("adv"),w="true"===gh("exp");
eb="true"===gh("advmode");var m=0,n=0,E="",r=gh("blur").trim()||"";/^\d+$/.test(r)&&(m=parseInt(r,10)/10);r=gh("grayscale")||"";/^\d+$/.test(r)&&(n=parseInt(r,10)/100);if(0<m||0<n)E="blur("+m.toFixed(1)+"px) grayscale("+n.toFixed(2)+")";m=1;n=0;r=!1;var v=null;r=gh("scale").trim()||"";/^\d+(\.\d*)?$/.test(r)&&(m=parseFloat(r));r=gh("rotation").trim()||"";/^-?\d+(\.\d*)?$/.test(r)&&(n=parseFloat(r)*Math.PI/180);r=gh("mirror").trim()||"";r="true"===r;if(1!==m||0!==n||r)v=[m*Math.cos(n)*(r?-1:1),m*Math.sin(n)*
(r?-1:1),-m*Math.sin(n),m*Math.cos(n),0,0];l||(l=0<=g.la?g.Ga[g.la].Ma.fd:"aseba");fb();ib(g.j,!0);g.j.We();m=gh("view");r=0===m.length?["vpl"]:m.split("+");n=gh("robot");if(0<=r.indexOf("sim")||"sim"===n)n="sim";n.replace(/[+;]/g,",").split(",").forEach(function(a){var b=null;switch(a){case "thymio":b=Vg(g);b.wc(l);break;case "thymio-tdm":b=Wg(g);b.wc(l);break;case "thymio-jws":b=jh(g);b.wc(l);break;case "sim":b=Xg(g,{dh:E,eh:v});b.wc(l);break;default:window.vplConnections&&window.vplConnections.hasOwnProperty(a)&&
(b=window.vplConnections[a](),b.wc(l))}b&&g.Ga.push({name:a,Ma:b})});g.la=0<g.Ga.length?0:-1;g.j.$e=0<=g.la&&g.Ga[g.la].Ma.$e;if(!Ea[l])throw"Unsupported language "+l;Sa(g.W,u?[]:["src:language"]);g.j.Bb=l;g.aa.ca=p;null!=g.b&&(g.b.ca=p);Nc(g);!k&&a&&a.toolbars&&(a.toolbars.vpl&&(g.Jc=a.toolbars.vpl),a.toolbars.vpl2&&(g.yc=a.toolbars.vpl2));g.j.he=h;g.j.bf=q;kg&&document.getElementById("editor")&&(g.O=new kg(g,g.j.ta,l),Ke(g.O.Ua,E),g.j.u=function(){return lg(g.O)?null:g.O.Bc()},g.j.H=function(a){Bc(g.O,
a)},g.O.Ua.ca=p,og(g),!k&&a&&a.toolbars&&a.toolbars.editor&&(g.O.Mg=a.toolbars.editor),g.O.he=h,g.O.bf=q,g.O.Zb="teacher"===e);null!=g.M&&(kh(g),!k&&a&&a.toolbars&&a.toolbars.simulator&&(g.M.Mg=a.toolbars.simulator),g.M.he=h,g.M.bf=q);E&&Ke(g.aa,E);Le(g.aa,v);document.getElementsByTagName("body")[0].addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"},!1);document.getElementsByTagName("body")[0].addEventListener("drop",function(a){a.stopPropagation();
a.preventDefault();a=a.dataTransfer.files;1===a.length&&(a=a[0],Qc(g,a)||Eg(g,a)||Hg(g,a))},!1);if(g.M){g.M.W=g.W;var C=new Image;C.addEventListener("load",function(){g.M.Of=C});C.src="data:image/svg+xml;base64,"+btoa('<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><defs><linearGradient id="gradient" x1="-1000" y1="0" x2="-800" y2="0" gradientUnits="userSpaceOnUse"><stop style="stop-color:#000;stop-opacity:1;" offset="0" /><stop style="stop-color:#000;stop-opacity:0;" offset="1" /></linearGradient></defs><g transform="translate(0,-308)"><rect style="fill:url(#gradient);stroke:none" width="319" height="687" x="-1027" y="336" transform="scale(-1,1)" /><path style="fill:none;stroke:#000;stroke-width:30;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" d="M 114,592 C 102,417 750,306 778,532 806,757 674,675 559,622 444,568 259,567 278,664 296,762 726,730 778,808 829,887 725,955 616,936 507,917 144,1083 129,837 Z" /></g></svg>');
var R=new Image;R.addEventListener("load",function(){g.M.Pf=R});R.src="data:image/svg+xml;base64,"+btoa('<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><defs><radialGradient id="gradient" cx="400" cy="650" fx="400" fy="650" r="230" gradientTransform="matrix(1.6,0,0,1.16,-113,-75)" gradientUnits="userSpaceOnUse"><stop style="stop-color:#000;stop-opacity:1;" offset="0" /><stop style="stop-color:#000;stop-opacity:0;" offset="1" /></radialGradient></defs><g transform="translate(0,-308)"><rect style="fill:url(#gradient);fill-opacity:1;stroke:none" width="939" height="650" x="54" y="357" /></g></svg>');
g.M.Qf='<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><g transform="translate(0,-308)"><path style="fill:none;stroke:#000;stroke-width:6;stroke-linecap:butt;stroke-linejoin:miter" d="M 172,928 137,420 763,371 905,688 708,981 Z" /><path style="fill:none;stroke:#949494;stroke-width:6;stroke-linecap:butt;stroke-linejoin:miter" d="m 402,754 168,91 101,-142" /><circle style="fill:none;stroke:#000;stroke-width:6" cx="531" cy="550" r="59" /></g></svg>'}jc(g,
!0);if(window.vplStorageGetFunction)window.vplStorageGetFunction("program.vpl3",function(a,b){try{b=b||{},a&&(g.j.filename=b.filename||"program.vpl3",g.j.readOnly=1==b.readOnly,g.j.Pe=void 0!=b.fixedFilename?1==b.fixedFilename:1==b.readOnly,1==b.customizationMode&&(g.W.wb=!0,g.W.hc="teacher"===e),qb(g.j,a,function(){uc(g);H(g)}),1==b.setAsNew&&g.I.Dd("vpl:teacher-setasnew"),g.zd=!0)}catch(Q){}});else if(g.Sg)try{var S=window.localStorage.getItem("program.vpl3");S&&qb(g.j,S,function(){uc(g);H(g)})}catch(ma){}"text"===
gh("view")?g.qb(["src"],{ta:!0}):(g.qb(["vpl"]),g.j.kh=w,g.j.Zb="teacher"===e?"t":"teacher1"===e?"custb":Za,H(g),g.O&&(document.getElementById("editor").textContent=g.j.Bc(g.j.Bb)));var Ga=["aseba","l2","asm","js","python"];g.O&&0<=Ga.indexOf(l)&&mg(g.O,function(){l=Ga[(Ga.indexOf(l)+1)%Ga.length];g.j.Bb=l;var a=g.j.Bc(l);return{language:l,code:a}});if(u&&g.O){var qa=new Jb(Kb);g.O.Oe=function(a,b){try{switch(a){case "aseba":var c=new Lb(qa,b);c.S=Mb;var d=Nb(c);return lh(b,d,c.oc);case "l2":return c=
new mh(qa,b),c.S=nh,d=Nb(c),lh(b,d,c.oc);case "asm":return d=oh(new ph(qa,b)),Ob(d);default:return null}}catch(Oa){return"; "+Oa}}}a&&a.fragments&&a.fragments["about.html"]&&kc(g,a.fragments["about.html"].replace(/UIROOT/g,c));a&&a.fragments&&a.fragments["help.html"]&&oc(g,a.fragments["help.html"].replace(/UIROOT/g,c));if(a&&a.help||0<b.length){g.w=new Va;a&&a.help&&g.w.add(a.help);g.ma={};if(a&&a.doc)for(var za in a.doc)a.doc.hasOwnProperty(za)&&a.de[a.doc[za]["doctemplate.html"]]&&(g.ma[za]=a.de[a.doc[za]["doctemplate.html"]]);
b.forEach(function(a){g.w.add(a)});uc(g)}a&&a.fragments&&a.fragments["vpl-export-html.css"]&&(g.S=a.fragments["vpl-export-html.css"]);Dc(g);Me(g.aa);window.addEventListener("resize",function(){Dc(g)},!1);g.M&&(g.M.Zb="teacher"===e);if("text"===m)g.qb(["src"],{ta:!0});else{c=["vpl","src","sim"];if(1>r.length||3<r.length||""===m)m="vpl";else for(S=0;S<r.length;S++){if(0>!c.indexOf(r[S])){m="vpl";break}for(za=0;za<S;za++)if(r[S]===r[za]){m="vpl";break}}g.qb(r)}Dc(g);d&&(window.vplCommandServer=new Tg(g,
d,f),window.vplCommandServer.connect(),window.vplSendToCom=function(a){window.vplCommandServer.sc.send(JSON.stringify({sender:{type:"vpl",sessionid:window.vplCommandServer.sessionId},type:"client",data:a||null}))})}
window.addEventListener("load",function(){if(qh&&Kb){var a=new qh;if(a.Pd!==Kb.maxVarSize)throw"internal: vm var size mismatch";if(a.Na.length!==Kb.variables.length)throw"internal: vm var count mismatch";for(var c=0;c<a.Na.length;c++)if(a.Na[c].name!==Kb.variables[c].name||a.Na[c].Z.length!==Kb.variables[c].size)throw"internal: vm var mismatch";if(a.Pc.length!==Kb.localEvents.length)throw"internal: vm ev count mismatch";for(c=0;c<a.Pc.length;c++)if(a.Pc[c].name!==Kb.localEvents[c].name)throw"internal: vm var mismatch";
if(a.Ub.length!==Kb.nativeFunctions.length)throw"internal: vm nat fun count mismatch";for(c=0;c<a.Pc.length;c++)if(a.Ub[c].name!==Kb.nativeFunctions[c].name)throw"internal: vm nat fun mismatch";}a=gh("ui")||"ui.json";c=null!=document.getElementById(a);var b=window.vplUIRoot?window.vplUIRoot:c?".":0<=a.indexOf("/")?a.replace(/\/[^/]*$/,""):".";(c?fh:eh)(a,b,function(a){var b=(a.svgFilenames||[]).concat(a.overlays||[]).concat(a.css||[]);if(a.doc)for(var c in a.doc)if(a.doc.hasOwnProperty(c))for(var d in a.doc[c])a.doc[c].hasOwnProperty(d)&&
b.push(a.doc[c][d]);return b},function(a,c){a.de={};a.Ib={};a.svgFilenames&&a.svgFilenames.forEach(function(b){a.de[b]=c[b];a.Ib[b]=new Mf(c[b])});a.overlays&&a.overlays.forEach(function(b){a.de[b]=c[b]});a.css&&a.css.forEach(function(b){a.de[b]=c[b]});if(a.doc)for(var d in a.doc)if(a.doc.hasOwnProperty(d))for(var e in a.doc[d])a.doc[d].hasOwnProperty(e)&&(a.de[a.doc[d][e]]=c[a.doc[d][e]]);ih(a,b)},function(a){window.console&&window.console.error(a);ih()})},!1);
window.vplIsProgramChanged=function(){return 0<window.vplApp.j.xd.Hc.length};window.vplGetProgramAsJSON=function(a){return pb(window.vplApp.j,a?{qd:!0,td:!1}:void 0)};window.vplGetUIAsJSON=function(){return pb(window.vplApp.j,{qd:!0,td:!1})};window.vplConvertToHTML=function(a,c){var b=window.vplApp;a=JSON.parse(a);nb(b.j,a);c=c?Rc(b,b.ia,!0):Pc(b,b.ia);b.j.ig();return c};window.vplConvertMDToHtml=function(a){return Xa(new Va,a.split("\n"))};
window.addEventListener("unload",function(){var a=pb(window.vplApp.j);try{window.vplStorageSetFunction?window.vplStorageSetFunction("program.vpl3",a):window.vplApp.Sg&&window.localStorage.setItem("program.vpl3",a)}catch(c){}},!1);function rh(){this.ee=1}rh.prototype.reset=function(){};rh.prototype.resetEventListeners=function(){};rh.prototype.set=function(){};rh.prototype.get=function(){return null};rh.prototype.setClientState=function(){};rh.prototype.getClientState=function(){return null};rh.prototype.addEventListener=function(){};rh.prototype.sendEvent=function(){};rh.prototype.start=function(){this.sendEvent("init",null)};rh.prototype.setTimer=function(){};rh.prototype.getTimer=function(){return-1};
rh.prototype.loadCode=function(){};rh.prototype.shouldRunContinuously=function(){return!1};rh.prototype.run=function(){};rh.prototype.suspend=function(){};rh.prototype.resume=function(){};function O(){this.ee=1;this.Ha={Y:-Infinity,oa:Infinity,ba:-Infinity,pa:Infinity};this.u=this.ca=0;this.r=70;this.b=[0,0];this.i=0;this.Xf=!1;this.files={};this.rb=120;this.tc=80;this.Ad=20;this.state={};this.S={};this.Za=null;this.zd={};this.l=[];this.ma={};this.Wc=!1;this.H=null;O.prototype.reset.call(this,0);O.prototype.resetEventListeners.call(this)}O.prototype=Object.create(rh.prototype);O.prototype.constructor=O;O.prototype.setPositionLimits=function(a,c,b,d){this.Ha={Y:a,oa:c,ba:b,pa:d}};
O.prototype.setFile=function(a,c){this.files[a]=c};
O.prototype.reset=function(a){this.u=this.ca=a;this.b=[0,0];this.i=0;this.state={"button.center":!1,"button.left":!1,"button.right":!1,"button.forward":!1,"button.backward":!1,"prox.ground.delta":[1,1],"prox.horizontal":[0,0,0,0,0,0,0],acc:[0,0,1],"motor.left":0,"motor.right":0,"leds.top":[0,0,0],"leds.bottom.left":[0,0,0],"leds.bottom.right":[0,0,0],"leds.circle":[0,0,0,0,0,0,0,0],sound:{}};this.Wc=!1;var c=this;this.S={"leds.circle":function(){c.Wc=!0},sound:function(a,d){function b(){if(!(g>=d.f.length)){c.H||
(c.H=new (window.AudioContext||window.webkitAudioContext));var a=c.H.createOscillator();a.type="sawtooth";a.frequency.value=d.f[g];var e=c.H.createGain();e.connect(c.H.destination);a.connect(e);a.start(0);var f=d.d[g]/50;e.gain.exponentialRampToValueAtTime(.01,c.H.currentTime+f);a.stop(c.H.currentTime+f);a.addEventListener("ended",b);g++}}if(d.hasOwnProperty("pcm")){if(a=c.files["P"+d.pcm+".wav"]){c.H||(c.H=new (window.AudioContext||window.webkitAudioContext));var f=c.H;f.decodeAudioData(a.slice(),
function(a){var b=f.createBufferSource();b.buffer=a;b.connect(f.destination);b.start(0)})}}else if(d.f){var g=0;b()}}};this.l=[];this.Uc=!1};O.prototype.resetEventListeners=function(){this.ma={}};O.prototype.enforcePositionLimits=function(){this.b=[Math.max(this.Ha.Y,Math.min(this.Ha.oa,this.b[0])),Math.max(this.Ha.ba,Math.min(this.Ha.pa,this.b[1]))]};O.prototype.setPosition=function(a,c){this.b=a;this.i=c;this.enforcePositionLimits();this.Za&&this.Za.call(this)};
O.prototype.set=function(a,c){this.state[a]=c;this.S[a]&&this.S[a](a,c)};O.prototype.get=function(a){return this.state[a]};O.prototype.setClientState=function(a,c){this.zd[a]=c};O.prototype.getClientState=function(a){a=this.zd[a];a instanceof Array&&(a=a.slice());return a};O.prototype.addEventListener=function(a,c){this.ma[a]=c};O.prototype.sendEvent=function(a,c){this.ma[a]&&this.ma[a].call(this,a,c);for(var b in this.ma)if(0===b.indexOf(a+"."))this.ma[b](a,c)};
O.prototype.setTimer=function(a,c,b,d){this.l[a]={name:c,next:this.u-this.ca+b,wh:d?b:-1}};O.prototype.getTimer=function(a){return void 0===this.l[a]||0>this.l[a].next?-1:this.ca+this.l[a]-this.u};O.prototype.loadCode=function(a,c){if("js"!==a)throw"unsupported language "+a;(new Function(c)).call(this)};
O.prototype.shouldRunContinuously=function(){if(this.Uc)return!1;if(0!==this.get("motor.left")||0!==this.get("motor.right"))return!0;for(var a=0;a<this.l.length;a++)if(this.l[a]&&0<this.l[a].next)return!0;return!1};function sh(a,c){return a.Xf?c*Math.sqrt(-2*Math.log(Math.random()))*Math.sin(2*Math.PI*Math.random()):0}
O.prototype.run=function(a,c){0===this.ca&&this.reset(a);1!==this.ee&&(this.ca-=(this.ee-1)*(a-this.u),this.u=this.ee*(this.u-a)+a);for(var b=Math.max(.01,(a-this.u)/10),d=this.b;!this.Uc&&this.u<a;){b=Math.min(b,a-this.u);var e=(100*this.get("motor.left")+sh(this,1))*b,f=(100*this.get("motor.right")+sh(this,1))*b;if(0!==e||0!=f){if(1E-6>Math.abs(e-f)||Math.abs(e-f)<1E-4*(Math.abs(e)+Math.abs(f)))this.b=[this.b[0]+.5*(e+f)*Math.cos(this.i),this.b[1]+.5*(e+f)*Math.sin(this.i)];else{var g=(e+f)*this.r/
(e-f);e=(f-e)/(2*this.r);this.b=[this.b[0]+g*(Math.sin(this.i)-Math.sin(this.i+e)),this.b[1]-g*(Math.cos(this.i)-Math.cos(this.i+e))];this.i+=e}this.enforcePositionLimits();this.Za&&this.Za.call(this)}this.u+=b;for(g=0;g<this.l.length;g++)this.l[g]&&0<this.l[g].next&&this.u>=this.ca+this.l[g].next+sh(this,.01)&&(this.l[g].next=0<=this.l[g].wh?this.l[g].next+this.l[g].wh:-1,this.sendEvent(this.l[g].name,null))}c&&c("l",d.concat(this.b))};O.prototype.suspend=function(){this.Uc=!0};
O.prototype.resume=function(a){this.Uc&&(this.ca+=a-this.u,this.u=a,this.Uc=!1)};var th="shift left;shift right;add;sub;mult;div;mod;bitor;bitxor;bitand;eq;ne;gt;ge;lt;le;or;and".split(";");function uh(a,c){function b(a){return 32784<=a?a-65536:a}function d(a){return 2048<=a?a-4096:a}var e=[],f=a[0];if(0<a.length){if(1!==f%2||f>a.length)throw"Bad event table";e.push({ic:0,ce:a.slice(0,1),Zf:-1,v:"dc "+a[0]})}for(var g=[],k=1;k<f;k+=2)g.push({id:a[k],ic:a[k+1]}),e.push({ic:k,ce:a.slice(k,k+2),Zf:-1,v:"dc 0x"+a[k].toString(16)+", "+a[k+1]});for(k=f;k<a.length;k++){f={ic:k,ce:a.slice(k,k+1),Zf:a[k]>>>12};if(!c)for(var l=0;l<g.length;l++)if(g[l].ic===k){f.id="onevent_"+g[l].id.toString(16);
break}l=a[k];switch(l>>>12){case 0:f.v="stop";break;case 1:f.v="push.s "+((l&4095)-(l&2048?4096:0));break;case 2:f.ce=a.slice(k,k+2);f.v="push "+b(a[++k]);break;case 3:f.v="load "+(l&4095);break;case 4:f.v="store "+(l&4095);break;case 5:f.ce=a.slice(k,k+2);f.v="load.ind "+(l&4095)+" size="+a[++k];break;case 6:f.ce=a.slice(k,k+2);f.v="store.ind "+(l&4095)+" size="+a[++k];break;case 7:case 8:switch(l){case 28672:f.v="neg";break;case 28673:f.v="abs";break;case 28674:f.v="bitnot";break;case 28675:f.v=
"not ; not implemented";break;case 32768:f.v="sl";break;case 32769:f.v="asr";break;case 32770:f.v="add";break;case 32771:f.v="sub";break;case 32772:f.v="mult";break;case 32773:f.v="div";break;case 32774:f.v="mod";break;case 32775:f.v="bitor";break;case 32776:f.v="bitxor";break;case 32777:f.v="bitand";break;case 32778:f.v="eq";break;case 32779:f.v="ne";break;case 32780:f.v="gt";break;case 32781:f.v="ge";break;case 32782:f.v="lt";break;case 32783:f.v="le";break;case 32784:f.v="or";break;case 32785:f.v=
"and";break;default:throw"Unknown instruction "+l.toString(16);}break;case 9:f.v="jump "+(k+d(l&4095));break;case 10:f.ce=a.slice(k,k+2);f.v=(l&256?l&512?"dont.":"do.":"")+"jump."+(l&256?"when":"if")+".not "+th[l&31]+" "+(k+b(a[k+1]));k++;break;case 11:f.v="emit id="+(l&4095)+" data="+b(a[k+1])+" count="+b(a[k+2]);k+=2;break;case 12:f.v="callnat "+(l&4095);break;case 13:f.v="callsub "+(l&4095);break;case 14:f.v="ret";break;default:throw"Unknown instruction "+l.toString(16);}e.push(f)}return e}
function Ob(a,c){var b=uh(a).map(function(b){var d=b.ic.toString(10);d="    ".slice(d.length-1)+d;var f=b.ce.map(function(a){a=a.toString(16);return"000".slice(a.length-1)+a}).join(" ");f+="     ".slice(f.length-4);return(b.id?b.id+":\n":"")+(c?"    ":d+"  "+f+"  ")+b.v+(b.ic===a[0]-2||0===b.Zf||14===b.Zf?"\n":"")}).join("\n");0===b.length&&(b="; empty");return b};function lh(a,c,b){function d(a){var b=e[a].ic.toString(10);b="    ".slice(b.length-1)+b;var c=e[a].ce.map(function(a){a=a.toString(16);return"000".slice(a.length-1)+a}).join(" ");c+="     ".slice(c.length-4);f+=(e[a].id?e[a].id+":\n":"")+b+"  "+c+"  "+e[a].v+"\n";e.splice(a,1)}var e=uh(c,!0);a=a.split("\n");b=b.slice().sort(function(a,b){return a.ic-b.ic});b=[new vh(-1,-1,-1,0)].concat(b).concat(new vh(Infinity,Infinity,Infinity,c.length));var f="";for(c=0;c<a.length;c++){for(var g=!1,k=0;k<b.length-
1;)if(b[k].line<=c){for(var l=b[k].ic;l<b[k+1].ic;l++)for(var h=0;h<e.length;)e[h].ic===l?(!g&&0<c&&(f+="\n"),g=!0,d(h)):h++;b.splice(k,1)}else k++;g&&(f+="\n");f+=a[c]+"\n"}for(h=0;h<e.length;)d(h);return f};function Jb(a){this.name=a.name;this.b=a.maxVarSize;this.Na=[];for(var c=this.Ya=0;c<a.variables.length;c++)this.Na.push(new wh(a.variables[c].name,a.variables[c].size,[1],this.Ya,xh)),this.Ya+=a.variables[c].size;this.Ub=a.nativeFunctions.map(function(a,c){return{id:c,name:a.name,F:a.args}});this.Pc=a.localEvents.map(function(a){return{name:a.name}})}function yh(a,c){for(var b=0;b<a.Ub.length;b++)if(a.Ub[b].name===c)return a.Ub[b];return null}
function zh(a,c){for(var b=0;b<a.Na.length;b++)if(a.Na[b].name===c)return a.Na[b];return null}function Ah(a,c){if("init"===c)return 65535;for(var b=0;b<a.Pc.length;b++)if(a.Pc[b].name===c)return 65534-b;throw"unknown local event "+c;}function Lb(a,c){this.rb=Bh;this.Xg=!1;this.Aa=a;this.i=c;this.w=c.length;this.K=0;this.line=1;this.Sa=0;this.G=[];this.o=0;this.b=[];this.$g=[];this.S=[];this.H={};this.ib=[];this.Ha=[];this.Jb=this.tc=this.Aa.b;this.zg=!1;this.Xa=0;this.Ad=[];this.oc=[]}
function Ch(a,c){for(var b=0;b<a.Ad.length;b++)if(a.Ad[b].name===c)return a.Ad[b];return null}function wh(a,c,b,d,e){this.name=a;this.size=c;this.A=b;this.offset=d;this.resultType=e}wh.prototype.Zd=function(a,c){return[12288|this.offset+(c||0)]};wh.prototype.Vf=function(a,c){return[16384|this.offset+(c||0)]};wh.prototype.sf=function(){return[20480|this.offset,this.size]};wh.prototype.wg=function(){return[24576|this.offset,this.size]};
Lb.prototype.Ih=function(){for(;this.K<this.w;)if(" "===this.i[this.K]||"\t"===this.i[this.K])this.K++,this.Sa++;else if("\n"===this.i[this.K])this.K++,this.Sa=0,this.line++;else if("\r"===this.i[this.K])this.K++;else if("#*"===this.i.slice(this.K,this.K+2))for(this.K+=2,this.Sa+=2;this.K<this.w&&"*#"!==this.i.slice(this.K-2,this.K);)"\n"===this.i[this.K]?(this.Sa=0,this.line++):"\r"!==this.i[this.K]&&this.Sa++,this.K++;else if("#"===this.i[this.K])for(;this.K<this.w&&"\n"!==this.i[this.K];)this.K++,
this.Sa++;else break};function Dh(a,c){a.Ha.push(c.length-1)}function Eh(a,c,b){if(0===a.Ha.length)throw"internal";void 0===b&&(b=c.length);a=a.Ha.pop();c[a]=36864===c[a]?c[a]+(b-a&4095):b-a+1&65535}Lb.prototype.Wc=function(a,c,b,d,e){var f;a:{for(f=0;f<this.ib.length;f++)if(this.ib[f].name===a){f=!0;break a}for(f=0;f<this.Aa.Na.length;f++)if(this.Aa.Na[f].name===a){f=!0;break a}f=!1}if(f)throw'duplicate variable declaration "'+a+'"';this.ib.push(new wh(a,c,b,d,e))};
function Fh(a,c){for(var b=a.ib.length-1;0<=b;b--)if(a.ib[b].name===c.name)return a.ib[b];for(b=0;b<a.Aa.Na.length;b++)if(a.Aa.Na[b].name===c.name)return a.Aa.Na[b];throw"unknown variable "+c.name+" "+U(c.head);}function Gh(a,c){for(var b=0;b<a.S.length;b++)if(a.S[b].name===c)return a.S[b];return null}function Hh(a,c){a.Jb-=c;return a.Jb}Lb.prototype.Za=function(){return[]};var Ih="== != <= >= |= ^= &= *= /= %= += -= <<= >>= ++ -- ( ) [ ] - ~ * / % + << >> & ^ | > < = , : abs and callsub call const do elseif else emit end for if in not onevent or return step sub then var when while".split(" ");
function Jh(a,c,b){this.fe=a;this.Nd=c;this.Ld=b}function U(a){return"line "+a.Nd.toString()+" col "+a.Ld.toString()}function Kh(a,c,b,d){Jh.call(this,a,c,b);this.n=d}Kh.prototype=Object.create(Jh.prototype);Kh.prototype.constructor=Kh;function Lh(a,c,b,d){Jh.call(this,a,c,b);this.n=d}Lh.prototype=Object.create(Kh.prototype);Lh.prototype.constructor=Lh;function Mh(a,c,b,d){Jh.call(this,a,c,b);this.name=d}Mh.prototype=Object.create(Jh.prototype);Mh.prototype.constructor=Mh;
function Nh(a,c,b,d){Jh.call(this,a,c,b);this.name=d}Nh.prototype=Object.create(Jh.prototype);Nh.prototype.constructor=Nh;
Lb.prototype.og=function(a){for(;;){a:{var c=(c=a)||Ih;this.Ih();if(this.K>=this.w)var b=null;else{for(var d=0;d<c.length;d++)if(b=c[d].length,this.i.slice(this.K,this.K+b)===c[d]&&!/[a-zA-Z0-9_.]{2}/.test(this.i.slice(this.K+b-1,this.K+b+1))){c=new Nh(this.K,this.line,this.Sa,c[d]);this.K+=b;this.Sa+=b;b=c;break a}b=0;if("0x"===this.i.slice(this.K,this.K+2)){for(this.K+=2;this.K+b<this.w&&/[0-9a-fA-F]/.test(this.i[this.K+b]);)b++;if(0===b)throw"hexadecimal number syntax error";c=parseInt(this.i.slice(this.K,
this.K+b),16);c=new Kh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=2+b}else if("0b"===this.i.slice(this.K,this.K+2)){for(this.K+=2;this.K+b<this.w&&/[01]/.test(this.i[this.K+b]);)b++;if(0===b)throw"binary number syntax error";c=parseInt(this.i.slice(this.K,this.K+b),2);c=new Kh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=2+b}else if(/[0-9]/.test(this.i[this.K])){for(;this.K+b<this.w&&/[0-9]/.test(this.i[this.K+b]);)b++;if(this.Xg&&this.K+b<this.w&&"."===this.i[this.K+b]){for(b++;this.K+b<this.w&&
/[0-9]/.test(this.i[this.K+b]);b++);c=parseFloat(this.i.slice(this.K,this.K+b));c=new Lh(this.K,this.line,this.Sa,c)}else c=parseInt(this.i.slice(this.K,this.K+b),10),c=new Kh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=b}else if(/[a-zA-Z_]/.test(this.i[this.K])){for(;this.K+b<this.w&&/[a-zA-Z0-9_.]/.test(this.i[this.K+b]);)b++;if(0===b)throw"name syntax error";c=new Mh(this.K,this.line,this.Sa,this.i.slice(this.K,this.K+b));this.K+=b;this.Sa+=b}else throw"syntax error line "+this.line.toString()+
" col "+this.Sa.toString();b=c}}if(null===b)break;this.G.push(b)}};function vh(a,c,b,d){this.Kh=a;this.line=c;this.Sa=b;this.ic=d}function Oh(a,c,b){(c=c.head||c.children[0]&&c.children[0].head)&&a.oc.push(new vh(c.fe,c.Nd,c.Ld,void 0===b?a.Xa:b))}function V(a){this.head=a;this.children=[];this.nb=0;this.resultType=Ph;this.Nb=!0}function Qh(a,c){for(var b=0;b<a.length;b++)a[b]=a[b].L(c)}V.prototype.L=function(){return this};V.prototype.Wa=function(a){this.children.forEach(function(c){c.Wa(a)})};
V.prototype.w=function(a){this.Wa(a);for(var c=0;c<this.children.length;c++)this.children[c]=this.children[c].w(a);return this};function Rh(a,c){V.call(this,a);this.n=void 0===c?this.head.n:c;this.resultType=xh}Rh.prototype=Object.create(V.prototype);Rh.prototype.constructor=Rh;Rh.prototype.Wa=function(){this.nb=1};function Sh(a){a&=65535;return 32768<=a?a-65536:a}function Th(a,c){Rh.call(this,a,c);this.resultType=Uh}Th.prototype=Object.create(Rh.prototype);Th.prototype.constructor=Th;
function Vh(a){V.call(this,a);this.name=a.name;this.b=!1}Vh.prototype=Object.create(V.prototype);Vh.prototype.constructor=Vh;Vh.prototype.Wa=function(a){a.H.hasOwnProperty(this.name)?(this.nb=1,this.resultType=a.H[this.name].resultType):(a=Fh(a,this),this.nb=a.size,this.resultType=a.resultType)};Vh.prototype.L=function(a){return a.H.hasOwnProperty(this.name)?a.H[this.name].resultType===Uh?new Th(this.head,a.H[this.name].Z):new Rh(this.head,a.H[this.name].Z):this};
function Wh(a){var c=new Vh(a.head);c.resultType=a.resultType;c.b=!0;return c}var Ph="?",xh="n",Uh="fx";function Xh(a,c,b,d){V.call(this,a);this.type=c;this.resultType=b?b.resultType:Ph;this.La=b;this.children=d||[]}Xh.prototype=Object.create(V.prototype);Xh.prototype.constructor=Xh;
Xh.prototype.Wa=function(a){V.prototype.Wa.call(this,a);for(var c=1,b=0;b<this.children.length;b++)if(1===c)c=this.children[b].nb;else if(1!==this.children[b].nb&&this.children[b].nb!==c)throw"incompatible sizes "+U(this.head);this.nb=c;this.La&&this.La.za&&(this.resultType=this.La.za(a,this,this.children.map(function(a){return a.resultType})))};Xh.prototype.L=function(a){this.children=this.children.map(function(c){return c.L(a)});return this.La&&this.La.L?this.La.L(this,a):this};
Xh.prototype.w=function(a){var c=V.prototype.w.call(this,a);if(c.type===W&&c.La.priority===Yh&&(c.children[1]instanceof Zh||c.children[1]instanceof Vh&&1!==c.children[1].nb)){var b=c.children[0];if(!(b instanceof Vh)||c.Nb)throw"bad array assignment "+U(c.head);for(var d=c.children[1],e=new $h(c.head),f=0;f<d.nb;f++){var g=b;1<d.nb&&(g=new ai(b.head,[new Rh(b.head,f)]),g.resultType=b.resultType);if(d instanceof Zh)var k=d.children[f];else k=new ai(d.head,[new Rh(b.head,f)]),k.resultType=d.resultType;
g=new Xh(c.head,c.type,c.La,[g,k]);g.resultType=b.resultType;g.Nb=!1;g=g.L(a);e.children.push(g)}return e}return c};function ai(a,c){Vh.call(this,a);this.children=c}ai.prototype=Object.create(Vh.prototype);ai.prototype.constructor=ai;ai.prototype.Wa=function(a){V.prototype.Wa.call(this,a);a=Fh(a,this);this.nb=1;this.resultType=a.resultType};function bi(a){for(var c=0;c<a.children.length;c++)if(!(a.children[c]instanceof Rh))return!1;return!0}
function ci(a,c){for(var b=0,d=1,e=0;e<a.children.length;e++){if(!(a.children[e]instanceof Rh))throw"internal";b+=d*a.children[e].n;d*=c.A[e]}return b}function Zh(a){V.call(this,a);this.A=[]}Zh.prototype=Object.create(V.prototype);Zh.prototype.constructor=Zh;Zh.prototype.Wa=function(a){this.nb=this.children.length;this.children[0]&&(this.children.forEach(function(c){c.Wa(a)}),this.resultType=this.children[0].resultType)};function X(a,c){V.call(this,a);this.type=c||di;this.ma=!1;this.ab=[null]}
X.prototype=Object.create(V.prototype);x=X.prototype;x.constructor=X;x.Ag=function(){throw"internal";};x.yh=function(){};x.Ah=function(){throw"internal";};x.zh=function(){};x.Ae=function(){};function ei(a,c){c.Jb=c.tc;Oh(c,a)}var di=1;function fi(a,c){this.b=a;this.ya=c}fi.prototype.B=function(){return"internal"};function gi(a,c){X.call(this,a,2);this.re=c}gi.prototype=Object.create(X.prototype);gi.prototype.constructor=gi;gi.prototype.L=function(a){Qh(this.children,a);return this};
gi.prototype.Ag=function(){return this};function hi(a,c){X.call(this,a,2);this.Mh=c}hi.prototype=Object.create(X.prototype);hi.prototype.constructor=hi;hi.prototype.L=function(a){Qh(this.children,a);return this};hi.prototype.Ag=function(){return this};function ii(a){X.call(this,a)}ii.prototype=Object.create(X.prototype);ii.prototype.constructor=ii;function ji(a,c,b){X.call(this,a);this.b=c;this.Z=b;this.resultType=b.resultType}ji.prototype=Object.create(X.prototype);ji.prototype.constructor=ji;
function ki(a,c,b,d,e){X.call(this,a);this.S=c.name;this.resultType=b;this.b=d||null;this.size=-1;this.A=[];this.offset=-1;e&&this.children.push(e)}ki.prototype=Object.create(X.prototype);ki.prototype.constructor=ki;ki.prototype.Wa=function(a){this.children[0]&&(V.prototype.Wa.call(this,a),this.resultType=this.children[0].children[1].resultType)};ki.prototype.L=function(a){Qh(this.children,a);return this};function li(a){X.call(this,a.head);this.children.push(a)}li.prototype=Object.create(X.prototype);
li.prototype.constructor=li;li.prototype.L=function(a){Qh(this.children,a);return this};function $h(a){X.call(this,a)}$h.prototype=Object.create(X.prototype);$h.prototype.constructor=$h;$h.prototype.L=function(a){Qh(this.children,a);return this};function mi(a,c){X.call(this,a,3);this.b=[c];this.i=[];this.l=[]}mi.prototype=Object.create(X.prototype);x=mi.prototype;x.constructor=mi;x.Wa=function(a){this.b.forEach(function(c){c.Wa(a)});this.i.forEach(function(c){c.forEach(function(b){b.Wa(a)})})};
x.L=function(a){Qh(this.b,a);this.i.forEach(function(c){Qh(c,a)});return this};x.Ah=function(a){if(this.i.length>=this.b.length)throw"multiple else "+U(a.head);a instanceof ni&&this.b.push(a.Ta);this.i.push(this.children);this.l.push(a);this.children=[];this.ab.push(a.ab[0])};
x.Ae=function(a,c){this.i.push(this.children);this.children=[];this.l.push(c);for(a=0;a<this.b.length;)if(this.b[a]instanceof Rh)if(0===this.b[a].n)this.b.splice(a,1),this.i.splice(a,1),this.l.splice(a,1);else{this.b.splice(a);this.i.splice(a+1);break}else a++};function ni(a,c){X.call(this,a,4);this.Ta=c}ni.prototype=Object.create(X.prototype);ni.prototype.constructor=ni;ni.prototype.L=function(a){this.Ta=this.Ta.L(a);Qh(this.children,a);return this};function oi(a){X.call(this,a,4)}oi.prototype=Object.create(X.prototype);
oi.prototype.constructor=oi;function pi(a,c){X.call(this,a,3);this.Ta=c}pi.prototype=Object.create(X.prototype);pi.prototype.constructor=pi;pi.prototype.Wa=function(a){V.prototype.Wa.call(this,a);this.Ta.Wa(a)};pi.prototype.L=function(a){this.Ta=this.Ta.L(a);Qh(this.children,a);return this};function qi(a,c){X.call(this,a,3);this.Ta=c;this.b=[]}qi.prototype=Object.create(X.prototype);qi.prototype.constructor=qi;qi.prototype.Wa=function(a){V.prototype.Wa.call(this,a);this.Ta.Wa(a)};
qi.prototype.L=function(a){this.Ta=this.Ta.L(a);Qh(this.children,a);return this};qi.prototype.Ae=function(a,c){this.Ta instanceof Rh&&(0===this.Ta.n&&(this.children=[]),this.Ta=null);this.b.push(c)};function ri(a,c,b,d,e){X.call(this,a,3);this.l=new Vh(c);this.children.push(b);this.children.push(d);this.b=e||null;this.i=[]}ri.prototype=Object.create(X.prototype);ri.prototype.constructor=ri;ri.prototype.Wa=function(a){V.prototype.Wa.call(this,a);this.b&&this.b.Wa(a)};
ri.prototype.L=function(a){this.b&&(this.b=this.b.L(a));Qh(this.children,a);return this};ri.prototype.Ae=function(a,c){this.i.push(c)};function si(a,c,b){X.call(this,a);this.name=c;this.children=b}si.prototype=Object.create(X.prototype);si.prototype.constructor=si;si.prototype.L=function(a){Qh(this.children,a);return this};function ti(a,c){X.call(this,a);this.name=c}ti.prototype=Object.create(X.prototype);ti.prototype.constructor=ti;
function ui(a,c,b){X.call(this,a);this.re=c;b&&this.children.push(b)}ui.prototype=Object.create(X.prototype);ui.prototype.constructor=ui;ui.prototype.Wa=function(a){if(this.children[0]){V.prototype.Wa.call(this,a);var c=this.children[0],b=Ch(a,this.re);if((c instanceof Vh?Fh(a,c).size:c.nb)!==b.size)throw'Incompatible data size in "emit" '+U(this.head);}};function vi(a){X.call(this,a,5)}vi.prototype=Object.create(X.prototype);vi.prototype.constructor=vi;var Yh=30,W=1;
function Y(a,c,b){this.name=a;this.type=c;this.priority=b&&b.priority||0;this.resultType=b&&b.resultType||(b&&b.za?Ph:xh);this.za=b&&b.za||null;this.L=b&&b.L||null;this.P=b&&b.P||[];this.B=b&&b.B||null}function wi(a,c){for(var b=[],d=0;d<a.children.length;d++){if(!(a.children[d]instanceof Rh))return a;b.push(a.children[d].n)}return new Rh(a.head,Sh(c(b)))}
var Bh=[new Y("--",0,{priority:150}),new Y("++",0,{priority:150}),new Y("-",0,{priority:150,L:function(a){return wi(a,function(a){return-a[0]})},P:[28672]}),new Y("~",0,{priority:150,L:function(a){return wi(a,function(a){return~a[0]})},P:[28674]}),new Y("abs",0,{priority:150,L:function(a){return wi(a,function(a){return Math.abs(a[0])})},P:[28673]}),new Y("not",0,{priority:150,resultType:"b",L:function(a){return wi(a,function(a){return 0==a[0]?1:0})},P:[4096,32778]}),new Y("size",0,{priority:150,L:function(a,
c){var b=0<a.children[0].nb?a.children[0].nb:a.children[0]instanceof Zh?a.children[0].children.length:-1;if(0>b&&a.children[0]instanceof Vh)for(var d=c.ib.length-1;0<=d;d--)if(c.ib[d].name===a.children[0].name){b=c.ib[d].size;break}return 0<b?new Rh(a.head,b):a}}),new Y("--",2,{priority:150}),new Y("++",2,{priority:150}),new Y("+=",W,{priority:Yh}),new Y("-=",W,{priority:Yh}),new Y("*=",W,{priority:Yh}),new Y("/=",W,{priority:Yh}),new Y("%=",W,{priority:Yh}),new Y("<<=",W,{priority:Yh}),new Y(">>=",
W,{priority:Yh}),new Y("&=",W,{priority:Yh}),new Y("|=",W,{priority:Yh}),new Y("^=",W,{priority:Yh}),new Y("*",W,{priority:140,L:function(a){return wi(a,function(a){return a[0]*a[1]})},P:[32772]}),new Y("/",W,{priority:140,L:function(a){return wi(a,function(a){return Math.trunc(a[0]/a[1])})},P:[32773]}),new Y("%",W,{priority:140,L:function(a){return wi(a,function(a){return a[0]%a[1]})},P:[32774]}),new Y("+",W,{priority:130,L:function(a){return wi(a,function(a){return a[0]+a[1]})},P:[32770]}),new Y("-",
W,{priority:130,L:function(a){return wi(a,function(a){return a[0]-a[1]})},P:[32771]}),new Y("<<",W,{priority:120,L:function(a){return wi(a,function(a){return a[0]<<a[1]})},P:[32768]}),new Y(">>",W,{priority:120,L:function(a){return wi(a,function(a){return a[0]>>a[1]})},P:[32769]}),new Y("==",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]===a[1]?1:0})},P:[32778]}),new Y("!=",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]!==a[1]?1:0})},
P:[32779]}),new Y("<",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]<a[1]?1:0})},P:[32782]}),new Y("<=",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]<=a[1]?1:0})},P:[32783]}),new Y(">",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]>a[1]?1:0})},P:[32780]}),new Y(">=",W,{priority:80,resultType:"b",L:function(a){return wi(a,function(a){return a[0]>=a[1]?1:0})},P:[32781]}),new Y("&",W,{priority:110,L:function(a){return wi(a,
function(a){return a[0]&a[1]})},P:[32777]}),new Y("|",W,{priority:90,L:function(a){return wi(a,function(a){return a[0]|a[1]})},P:[32775]}),new Y("^",W,{priority:100,L:function(a){return wi(a,function(a){return a[0]^a[1]})},P:[32776]}),new Y("and",W,{priority:60,resultType:"b",L:function(a){return wi(a,function(a){return a[0]&&a[1]?1:0})},P:[32785]}),new Y("or",W,{priority:50,resultType:"b",L:function(a){return wi(a,function(a){return a[0]||a[1]?1:0})},P:[32784]}),new Y("=",W,{priority:Yh})];
function xi(a,c,b){for(var d=0;d<a.rb.length;d++)if(a.rb[d].type===b&&a.rb[d].name===c)return a.rb[d];return null}function yi(a,c,b){return a.G[a.o+c]instanceof b}function Z(a,c,b){return a.G[a.o+c]instanceof Nh&&a.G[a.o+c].name===b}x=Lb.prototype;x.oh=function(a){return new Xh(a,4,null)};
function zi(a,c){c=c||10;if(yi(a,0,Lh)){var b=new Th(a.G[a.o]);a.o++}else if(yi(a,0,Kh))b=new Rh(a.G[a.o]),a.o++;else if(yi(a,0,Mh))Z(a,1,"(")?(b=a.oh(a.G[a.o]),a.o++,Z(a,1,")")?a.o+=2:b.children=Ai(a)):(b=new Vh(a.G[a.o]),a.o++);else if(Z(a,0,"(")){a.o++;b=zi(a,20);if(!Z(a,0,")"))throw"subexpression in expression "+U(a.G[a.o]);a.o++}else if(Z(a,0,"[")){b=new Zh(a.G[a.o]);a.o++;var d=[];for(var e=0,f=0,g=0;;){d.push(zi(a,25));0===g&&f++;g++;if(1<f&&g>e)throw"non-rectangular array "+U(a.G[a.o]);g>
e&&(e=g);if(yi(a,0,Nh))if(a.o++,"]"===a.G[a.o-1].name)break;else if(","===a.G[a.o-1].name)continue;else if(";"===a.G[a.o-1].name){e=g;g=0;continue}throw"array "+U(a.G[a.o-1]);}for(g=0;g<e;g++)for(var k=0;k<f;k++)b.children.push(d[k*e+g])}else if(yi(a,0,Nh)&&(d=xi(a,a.G[a.o].name,0)))b=new Xh(a.G[a.o],0,d),a.o++,b.children.push(zi(a,150)),d.za&&(b.resultType=d.za(a,b,[b.children[0].resultType]));else if(yi(a,0,Nh)&&(d=xi(a,a.G[a.o].name,3)))b=new Xh(a.G[a.o],3,d),a.o++;else{if(a.o<a.G.length)throw"unexpected token in expression "+
U(a.G[a.o]);throw"unexpected end of file";}for(;yi(a,0,Nh);)if((d=xi(a,a.G[a.o].name,2))&&d.priority>=c)b=new Xh(a.G[a.o],2,d,[b]),a.o++;else if((d=xi(a,a.G[a.o].name,W))&&(c===Yh?d.priority>=c:d.priority>c))b=new Xh(a.G[a.o],W,d,[b]),a.o++,b.children.push(zi(a,d.priority)),d.za&&(b.resultType=d.za(a,b,b.children.map(function(a){return a.resultType})));else if("["===a.G[a.o].name){if(!(b instanceof Vh))throw"unexpected indexing";d=b.resultType;e=Ai(a,!0);b=new ai(b.head,e);b.resultType=d}else break;
return b}function Ai(a,c){var b=[];if(!Z(a,0,c?"[":"("))throw"left "+(c?"bracket":"parenthesis")+" expected";for(a.o++;;){var d=zi(a,25);b.push(d);if(!yi(a,0,Nh))throw"syntax error in arguments";if(Z(a,0,c?"]":")")){a.o++;break}else if(Z(a,0,","))a.o++;else throw"syntax error in arguments "+U(a.G[a.o]);}return b}
x.uh=function(){if(this.o>=this.G.length)throw"no more tokens";if(this.G[this.o]instanceof Nh){var a=this.G[this.o];switch(a.name){case "const":if(!yi(this,1,Mh)||!Z(this,2,"="))throw'syntax error for "const" '+U(a);var c=this.G[this.o+1];this.o+=3;var b=zi(this);b=b.L(this);if(!(b instanceof Rh))throw"non-constant expression in constant definition "+U(this.G[this.o]);return[new ji(a,c.name,b)];case "var":if(!yi(this,1,Mh))throw'unexpected token after "var" '+U(a);c=this.G[this.o+1];this.o+=2;if(yi(this,
0,Nh))switch(this.G[this.o].name){case "[":if(Z(this,1,"]")){this.o+=2;if(!Z(this,0,"="))throw"missing size or initial value in array declaration"+U(this.G[this.o-2]);b=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(c)]);this.o++;b.children.push(zi(this));b.resultType=b.children[1].resultType;b.Nb=!1;var d=new Xh(new Nh(b.head.fe,b.head.Nd,b.head.Ld,"size"),0,xi(this,"size",0),[b.children[1]]);return[new ki(a,c,b.resultType,[d],b)]}this.o++;d=zi(this);if(!Z(this,0,"]"))throw"array size syntax error"+
U(this.G[this.o]);this.o++;return Z(this,0,"=")?(b=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(c)]),this.o++,b.children.push(zi(this)),b.resultType=b.children[1].resultType,b.Nb=!1,b=b.L(this),[new ki(a,c,b.resultType,[d],b)]):[new ki(a,c,Ph,[d])];case "=":return b=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(c)]),this.o++,b.children.push(zi(this)),b.resultType=b.children[1].resultType,b.Nb=!1,b=b.L(this),[new ki(a,c,b.resultType,null,b)]}return[new ki(a,c,Ph)];case "if":case "elseif":this.o++;
b=zi(this);if(!Z(this,0,"then"))throw'"then" expected after "if" statement '+U(this.G[this.o]);this.o++;return["if"===a.name?new mi(a,b):new ni(a,b)];case "when":this.o++;b=zi(this);if(!Z(this,0,"do"))throw'"do" expected after "when" statement '+U(this.G[this.o]);this.o++;return[new pi(a,b)];case "while":this.o++;b=zi(this);if(!Z(this,0,"do"))throw'"do" expected after "while" statement '+U(this.G[this.o]);this.o++;return[new qi(a,b)];case "for":if(!yi(this,1,Mh)||!Z(this,2,"in"))throw'"for" syntax error '+
U(a);c=this.G[this.o+1];this.o+=3;b=zi(this);if(!Z(this,0,":"))throw'range expected in "for" statement '+U(this.G[this.o]);this.o++;d=zi(this);var e=null;Z(this,0,"step")&&(this.o++,e=zi(this));if(!Z(this,0,"do"))throw'"do" expected after "for" statement '+U(this.G[this.o]);this.o++;return[new ri(a,c,b,d,e)];case "end":return this.o++,[new vi(a)];case "call":if(!yi(this,1,Mh))throw'"call" syntax error '+U(a);c=this.G[this.o+1];this.o+=2;return Z(this,0,"(")?[new si(a,c.name,Ai(this))]:[new si(a,c.name,
[])];case "callsub":if(!yi(this,1,Mh))throw'"callsub" syntax error '+U(a);c=this.G[this.o+1];this.o+=2;return[new ti(a,c.name)];case "else":return this.o++,[new oi(a)];case "emit":if(!yi(this,1,Mh))throw'"emit" syntax error '+U(a);c=this.G[this.o+1];this.o+=2;b=Ch(this,c.name);if(null==b)throw"Unknown user event "+c.name+" "+U(a);return 0<b.size?(b=zi(this),[new ui(a,c.name,b)]):[new ui(a,c.name)];case "onevent":if(!yi(this,1,Mh))throw'unexpected token after "onevent" '+U(a);c=this.G[this.o+1];this.o+=
2;return[new gi(a,c.name)];case "return":return this.o++,[new ii(a)];case "sub":if(!yi(this,1,Mh))throw'unexpected token after "sub" '+U(a);c=this.G[this.o+1];this.o+=2;return[new hi(a,c.name)]}}b=zi(this);b instanceof Xh&&(b.Nb=!1);b=b.L(this);return[new li(b)]};x.Ch=function(){};x.Bh=function(){};
x.Cf=function(a){if(a instanceof ji){a.Z=a.Z.L(this);if(!(a.Z instanceof Rh))throw"constant definition "+U(a.head);this.H[a.b]={Z:a.Z.n,resultType:a.Z.resultType}}else a instanceof ki&&(a.size=1,a.A=[],a.b&&(a.b=a.b.map(function(c){c=c.L(this);if(!(c instanceof Rh)||0>=c.n)throw"array variable size "+U(a.head);a.size*=c.n;a.A.push(c.n);return c},this)),a.offset=this.Ya,a.children[0]&&(a.resultType=a.children[0].resultType),this.Ya+=a.size,this.Wc(a.S,a.size,a.A,a.offset,a.resultType))};x.Be=function(){};
x.Ia=function(){};x.getContext=function(){return null};x.ah=function(){this.Ya=this.Aa.Ya;for(var a=0;a<this.b.length;a++)this.Cf(this.b[a])};function Bi(a,c,b){switch(c.type){case 3:b.push(a.getContext());a.Ia(c.ab[0]);break;case 4:a.Ia(c.ab[0]);break;case 5:a.Ia(b.pop())}}
function Ci(a){function c(){if(1<f.length){var a=f[f.length-1].head;throw"unterminated "+a.name+" "+U(a);}b.l.push(f[0])}var b=a,d=[];a.ah();a.Be();d=[];a.b.forEach(function(a){Bi(this,a,d);a.Wa(this)},a);a.Be();d=[];for(var e=0;e<a.b.length;e++)Bi(a,a.b[e],d),a.b[e]=a.b[e].L(a);a.Be();d=[];for(e=0;e<a.b.length;e++)Bi(a,a.b[e],d),a.b[e]=a.b[e].w(a);a.l=[];var f=[new gi(null,"init")];a.Be();for(e=0;e<a.b.length;e++)switch(a.b[e].type){case di:a.b[e].Ae(a,a.b[e]);f[f.length-1].children.push(a.b[e]);
break;case 2:a.Ia(a.b[e].ab[0]);c();f=[a.b[e].Ag()];break;case 3:a.Ia(a.b[e].ab[0]);a.b[e].yh(a);f.push(a.b[e]);break;case 4:a.Ia(a.b[e].ab[0]);f[f.length-1].Ah(a.b[e]);break;case 5:if(2>f.length)throw"unexpected end "+U(a.b[e].head);a.Ia(a.b[e].ab[0]);f[f.length-1].zh(a.b[e]);var g=f.pop();a.Ia(a.b[e].ab[a.b[e].ab.length-1]);g.Ae(a,a.b[e]);f[f.length-1].children.push(g);break;default:throw"not implemented "+a.b[e].type;}c()}x.Dh=function(){};x.lh=function(){return null};
V.prototype.B=function(a){for(var c=[],b=a.Xa,d=0;d<this.children.length;d++)c=c.concat(this.children[d].B(a)),a.Xa=b+c.length;return c};function Di(a){return-2048<=a&&2048>a?[4096|a&4095]:[8192,a&65535]}Rh.prototype.B=function(){return this.Nb?Di(this.n):[]};Vh.prototype.B=function(a){return this.b?[]:a.H.hasOwnProperty(this.name)?Di(a.H[this.name].Z):Fh(a,this).Zd(a)};
Xh.prototype.B=function(a){function c(c,d,e,f){function g(c,g){f===b.Dg&&(h=h.concat(c.Zd(a,g)));e&&(h=h.concat(c.Zd(a,g)));h=h.concat(d.B(a)).concat(a.Za(d.resultType,c.resultType)).concat(c.Vf(a,g));f===b.yf&&(h=h.concat(c.Zd(a,g)))}var h=[];if(c instanceof ai){var k=Fh(a,c);if(bi(c)){c=ci(c,k);if(c>=k.size)throw"index out of range";g(k,c)}else if(f!==b.jg||e){var l=Hh(a,1);h=h.concat(Ei(c,a)).concat(16384|l);f===b.Dg&&(h=h.concat(12288|l).concat(k.sf(a)));e&&(h=h.concat(12288|l).concat(k.sf(a)));
h=h.concat(d.B(a)).concat(a.Za(d.resultType,k.resultType)).concat(12288|l).concat(k.wg(a));f===b.yf&&(h=h.concat(12288|l).concat(k.sf(a)))}else h=h.concat(d.B(a)).concat(a.Za(d.resultType,k.resultType)).concat(Ei(c,a)).concat(k.wg(a))}else if(c instanceof Vh)k=Fh(a,c),g(k);else throw"bad assignment";return h}var b={jg:0,yf:1,Dg:2},d=this.head.name;switch(d){case "=":return c(this.children[0],this.children[1],!1,this.Nb?b.yf:b.jg);case "++":case "--":if(!(this.children[0]instanceof Vh))throw"invalid operand "+
U(this.head);var e=d[0],f=xi(a,e,W);e=new Xh(new Nh(this.head.fe,this.head.Nd,this.head.Ld,e),W,f,[Wh(this.children[0]),new Rh(new Kh(this.head.fe,this.head.Nd,this.head.Ld,1))]);f.za&&(d=Fh(a,this.children[0]),e.resultType=f.za(a,e,[d.resultType,xh]));return c(this.children[0],e,!0,this.Nb?0===this.type?b.yf:b.Dg:b.jg);default:if(this.type===W&&this.La.priority===Yh){if(!(this.children[0]instanceof Vh))throw"invalid operand "+U(this.head);e=d.slice(0,-1);f=xi(a,e,W);e=new Xh(new Nh(this.head.fe,
this.head.Nd,this.head.Ld,e),W,f,[Wh(this.children[0]),this.children[1]]);f.za&&(d=Fh(a,this.children[0]),e.resultType=f.za(a,e,[d.resultType,this.children[1].resultType]));return c(this.children[0],e,!0,this.Nb?b.yf:b.jg)}if(this.La&&this.La.B)return this.La.B(this,a);switch(this.type){case 0:return V.prototype.B.call(this,a).concat(this.La.P);case W:return V.prototype.B.call(this,a).concat(this.La.P);case 3:return this.La.P;case 4:f=a.lh(this);if(null!==f)return f;e=Gh(a,d);if(null!=e){if(e.Gd!==
this.children.length)throw"wrong number of arguments";f=[];d=Hh(a,e.Gd+(e.Ue||0));for(var g=0;g<this.children.length;g++)f=f.concat(this.children[g].B(a)),f=f.concat(16384|d+g);return f=f.concat(e.Mb(a,a.Aa,this.children.map(function(a){return a.resultType}),d))}throw"unknown function "+d+" "+U(this.head);default:throw"internal";}}};
function Fi(a,c,b){return a instanceof Xh&&2===a.children.length?a.children[0].B(c).concat(a.children[1].B(c)).concat([40960|(b?256:0)|a.La.P[0]&255,0]):a.B(c).concat(4096,40960|(b?256:0)|th.indexOf("ne"),0)}function Ei(a,c){var b=Fh(c,a);if(a.children.length>b.A.length)throw"too many indices"+U(a.head);for(var d=[],e=1,f=0;f<a.children.length;f++)d=d.concat(a.children[f].B(c)),0<f&&(d=d.concat(4096|e,32772,32770)),e*=b.A[f];return d}
ai.prototype.B=function(a){if(this.b)return[];var c=Fh(a,this);if(bi(this)){var b=ci(this,c);if(b>=c.size)throw"index out of range "+U(this.head);return c.Zd(a,b)}return Ei(this,a).concat(c.sf(a))};Zh.prototype.B=function(){throw"internal";};X.prototype.B=function(){throw"internal";};gi.prototype.B=function(a){var c=a.getContext();ei(this,a);a.Ia(this.ab[0]);var b="init"===this.re?a.$g:[];a.Xa+=b.length;b=b.concat(V.prototype.B.call(this,a)).concat(0);a.Ia(c);return b};
hi.prototype.B=function(a){var c=a.getContext();ei(this,a);a.Ia(this.ab[0]);var b=V.prototype.B.call(this,a).concat(57344);a.Ia(c);return b};ji.prototype.B=function(a){ei(this,a);return[]};ki.prototype.B=function(a){ei(this,a);return 0===this.children.length?[]:V.prototype.B.call(this,a)};li.prototype.B=function(a){ei(this,a);return this.children[0].B(a)};$h.prototype.B=function(a,c){ei(this,a);var b=[];this.children.forEach(function(d){b=b.concat(d.B(a,c))});return b};
mi.prototype.B=function(a){var c=a.getContext();ei(this,a);for(var b=a.Xa,d=[],e=0,f=0;f<this.b.length;f++)a.Xa=b+d.length,0<f&&Oh(a,this.l[f-1]),d=d.concat(Fi(this.b[f],a)),a.Xa=b+d.length,Dh(a,d),a.Ia(this.ab[f]),this.i[f].forEach(function(c){d=d.concat(c.B(a));a.Xa=b+d.length}),a.Ia(c),f+1<this.i.length?(d=d.concat(36864),Eh(a,d),Dh(a,d),e++):Eh(a,d);a.Xa=b+d.length;this.i.length>this.b.length&&(Oh(a,0<this.b.length?this.l[this.b.length-1]:this,a.Xa+d.length),a.Ia(this.ab[this.b.length]),this.i[this.b.length].forEach(function(c){d=
d.concat(c.B(a));a.Xa=b+d.length}));for(;0<e--;)Eh(a,d);a.Ia(c);return d};pi.prototype.B=function(a){var c=a.getContext();ei(this,a);var b=a.Xa,d=Fi(this.Ta,a,!0);Dh(a,d);a.Ia(this.ab[0]);this.children.forEach(function(c){a.Xa=b+d.length;d=d.concat(c.B(a))});Eh(a,d);a.Ia(c);return d};
qi.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();ei(this,a);var b=a.Xa,d=[];null!=this.Ta&&(d=Fi(this.Ta,a));Dh(a,d);a.Ia(this.ab[0]);this.children.forEach(function(c){a.Xa=b+d.length;d=d.concat(c.B(a))});a.Xa=b+d.length;Oh(a,this.b[0]);d=d.concat(36864|-d.length&4095);Eh(a,d);a.Ia(c);return d};
ri.prototype.B=function(a){var c=a.getContext();ei(this,a);var b=a.Xa,d=this.children[0].B(a),e=Fh(a,this.l);d=d.concat(e.Vf(a));var f=d.length;d=d.concat(e.Zd(a)).concat(this.children[1].B(a)).concat(40975,0);Dh(a,d);a.Ia(this.ab[0]);for(var g=2;g<this.children.length;g++)a.Xa=b+d.length,d=d.concat(this.children[g].B(a));a.Xa=b+d.length;Oh(a,this.i[0]);d=d.concat(e.Zd(a));d=this.b?d.concat(this.b.B(a)):d.concat(Di(1));d=d.concat(32770,e.Vf(a),36864|f-d.length-2&4095);Eh(a,d);a.Ia(c);return d};
si.prototype.B=function(a){ei(this,a);var c=yh(a.Aa,this.name);if(!c)throw'native function "'+this.name+'" not found';if(this.children.length!==c.F.length)throw'wrong number of arguments for native function "'+this.name+'"';for(var b=[],d=[],e=[],f=this.children.length-1;0<=f;f--){var g=this.children[f];if(0>c.F[f])if(void 0==d[-c.F[f]-1])d[-c.F[f]-1]=g.nb;else{if(d[-c.F[f]-1]!==g.nb)throw'argument size mismatch in native function "'+this.name+'"';}else 0===c.F[f]&&e.push(g.nb);if(g instanceof ai)b=
b.concat(Di(Fh(a,g).offset)).concat(Ei(g,a)).concat(32770);else if(g instanceof Vh)b=b.concat(Di(Fh(a,g).offset));else{for(var k=Hh(a,g.nb),l=0;l<g.nb;l++)b=b.concat((g instanceof Zh?g.children[l]:g).B(a)),b=b.concat(16384|k+l);b=b.concat(Di(k))}}for(f=e.length-1;0<=f;f--)b=Di(e[f]).concat(b);for(f=d.length-1;0<=f;f--)void 0!==d[f]&&(b=Di(d[f]).concat(b));return b=b.concat(49152|c.id)};ii.prototype.B=function(a){ei(this,a);return[(a.zg?14:0)<<12]};function Gi(a,c){fi.call(this,a,c)}Gi.prototype=Object.create(fi.prototype);
Gi.prototype.constructor=Gi;Gi.prototype.B=function(){var a=this.ya.name;if(void 0===this.b.zd[a])throw'unknown function "'+a+'" '+U(this.ya.head);return 53248|this.b.zd[a]};ti.prototype.B=function(a){ei(this,a);return[new Gi(a,this)]};
ui.prototype.B=function(a){ei(this,a);var c=Ch(a,this.re);if(0===c.size)return[45056|c.id,0,0];var b=this.children[0],d=[];if(b instanceof Vh)var e=Fh(a,b).offset;else{e=Hh(a,b.nb);for(var f=0;f<b.nb;f++)d=d.concat((b instanceof Zh?b.children[f]:b).B(a)),d=d.concat(16384|e+f)}return d=d.concat(45056|c.id,e,b.nb)};function Hi(a,c){c=c||0;for(var b=0;b<a.length;b++)a[b]instanceof fi&&(a[b]=a[b].B(c+b))}
Lb.prototype.B=function(){this.Ha=[];this.Be();this.oc=[];var a=this.l.map(function(a){this.Xa=0;this.Ia(a.ab[0]);this.zg=a instanceof hi;this.oc=[];return{ie:a.B(this,!0),mapping:this.oc}},this);if(0<this.Ha.length)throw"internal";for(var c=0,b=0;b<this.l.length;b++)this.l[b]instanceof gi&&c++;this.zd={};var d=[],e=[1+2*c];this.oc=[];for(b=0;b<this.l.length;b++)this.oc=this.oc.concat(a[b].mapping.map(function(a){return new vh(a.Kh,a.line,a.Sa,a.ic+1+2*c+d.length)})),this.l[b]instanceof gi?(e=e.concat(Ah(this.Aa,
this.l[b].re),1+2*c+d.length),d=d.concat(a[b].ie)):this.l[b]instanceof hi&&(this.zd[this.l[b].Mh]=1+2*c+d.length,d=d.concat(a[b].ie));Hi(d,1+2*c);return e.concat(d)};function Nb(a){a.og();a.Ch();a.o=0;for(a.b=[];a.o<a.G.length;)a.b=a.b.concat(a.uh());a.Bh();Ci(a);a.Dh();return a.B()};function Ii(a,c,b){void 0===b&&(b=1);return{name:a,Gd:b,Ue:1,rf:function(a){return null!=yh(a,c)},Mb:function(a,e,f,g){a=yh(e,c);e=[4097];for(f=0;f<b;f++)e=e.concat([4096|g+b-1-f]);return e=e.concat([4096|g+b,49152|a.id,12288|g+b])}}}var Mb=[Ii("min","math.min",2),Ii("max","math.max",2),Ii("clamp","math.clamp",3),Ii("muldiv","math.muldiv",3),Ii("atan2","math.atan2",2),Ii("sin","math.sin"),Ii("cos","math.cos"),Ii("sqrt","math.sqrt"),Ii("rand","math.rand",0)];function mh(a,c){Lb.call(this,a,c);this.Xg=!0;this.rb=Ji;this.Fb=100;this.Ph=[];this.Uf=[];this.Zg=[];this.labels=[[]];this.Yg=[];this.Sb=!1;this.label=null;this.ca=Ph;this.ma=[]}mh.prototype=Object.create(Lb.prototype);mh.prototype.constructor=mh;var Ki="== != <= >= |= ^= &= *= /= %= += -= <<= >>= ++ -- ( ) [ ] - ~ ! * / % + << >> && || & ^ | > < = , ? : { } ; bool break case const continue default do else emit false fixed for goto if int onevent return size switch true void when while".split(" ");
function Li(a,c,b){return b[0]}function Mi(a,c,b){for(a=0;a<b.length;a++)switch(b[a]){case Ph:case Uh:return b[a];case "v":throw"cannot use void result in expression";}return xh}function Ni(a,c,b){if(!(a instanceof Zh)&&a.resultType!==c&&a.resultType!==Ph){if("v"===a.resultType)throw"cannot use void result "+U(a.head);if(c=Oi(c))a=new Xh(new Nh(a.head.fe,a.head.Nd,a.head.Ld,c),0,xi(b,c,0),[a]),a=a.L(b)}return a}function Pi(a,c){a.children[1]=Ni(a.children[1],a.resultType,c);return a}
mh.prototype.Za=function(a,c){if(a===Ph||c===Ph)throw"internal";if("v"===a)throw"bad conversion from void";switch(a){case xh:case "b":switch(c){case Uh:return[4196,32772]}break;case Uh:switch(c){case xh:case "b":return[4196,32773]}}return[]};function Qi(a,c,b){var d=[];a.forEach(function(a){d=a instanceof Th&&c===xh?d.concat(Di(Math.trunc(a.n))):a instanceof Rh&&a.resultType===xh&&c===Uh?d.concat(Di(a.n*b.Fb)):d.concat(a.B(b)).concat(b.Za(a.resultType,c))});return d}
function Ri(a,c,b,d){var e=Hh(a,4);return(c instanceof V?c.B(a):Di(c)).concat(16384|e).concat(b instanceof V?b.B(a):Di(b)).concat(16384|e+1).concat(d instanceof V?d.B(a):Di(d)).concat([16384|e+2,4097,4096|e+2,4096|e+1,4096|e,4096|e+3,49152|yh(a.Aa,"math.muldiv").id,12288|e+3])}
function Si(a,c,b,d){for(var e=!1,f=[],g=0;g<a.children.length;g++){if(a.children[g]instanceof Th)e=!0;else if(!(a.children[g]instanceof Rh))return a;f.push(a.children[g].n)}b=(e&&d?d:b)(f);d=a.La.resultType;a.La.za&&(d=a.La.za(c,a,a.children.map(function(a){return a.resultType})));switch(d){case xh:case "b":return new Rh(a.head,Sh(b));case Uh:return new Th(a.head,b);default:throw"internal";}}
var Ji=[new Y("--",0,{priority:150,za:Li}),new Y("++",0,{priority:150,za:Li}),new Y("-",0,{priority:150,za:Li,L:function(a,c){return Si(a,c,function(a){return-a[0]})},P:[28672]}),new Y("~",0,{priority:150,L:function(a,c){return Si(a,c,function(a){return~a[0]})},P:[28674]}),new Y("!",0,{priority:150,resultType:"b",L:function(a,c){return Si(a,c,function(a){return 0==a[0]?1:0})},P:[4096,32778]}),new Y("bool",0,{priority:150,resultType:"b",L:function(a,c){return Si(a,c,function(a){return 0!=a[0]?1:0})},
P:[],B:function(a,c){c=a.children[0].B(c);"b"!==a.children[0].resultType&&(c=c.concat(4096,32779));return c}}),new Y("fixed",0,{priority:150,resultType:Uh,L:function(a,c){return Si(a,c,function(a){return a[0]})},P:[],B:function(a,c){var b=a.children[0].B(c);a.children[0].resultType!==Uh&&(b=b.concat(4096|c.Fb,32772));return b}}),new Y("int",0,{priority:150,L:function(a,c){return Si(a,c,function(a){return a[0]})},P:[],B:function(a,c){var b=a.children[0].B(c);a.children[0].resultType===Uh&&(b=b.concat(4096|
c.Fb,32773));return b}}),new Y("size",0,{priority:150,L:function(a,c){var b=0<a.children[0].nb?a.children[0].nb:a.children[0]instanceof Zh?a.children[0].children.length:-1;if(0>b&&a.children[0]instanceof Vh)for(var d=c.ib.length-1;0<=d;d--)if(c.ib[d].name===a.children[0].name){b=c.ib[d].size;break}return 0<b?new Rh(a.head,b):a}}),new Y("--",2,{priority:150,za:Li}),new Y("++",2,{priority:150,za:Li}),new Y("+=",W,{priority:Yh,za:Li,L:Pi}),new Y("-=",W,{priority:Yh,za:Li}),new Y("*=",W,{priority:Yh,
za:Li}),new Y("/=",W,{priority:Yh,za:Li}),new Y("%=",W,{priority:Yh,za:Li}),new Y("<<=",W,{priority:Yh}),new Y(">>=",W,{priority:Yh}),new Y("&=",W,{priority:Yh}),new Y("|=",W,{priority:Yh}),new Y("^=",W,{priority:Yh}),new Y("*",W,{priority:140,za:Mi,P:[32772],L:function(a,c){return Si(a,c,function(a){return a[0]*a[1]})},B:function(a,c){var b=a.children[1].resultType===Uh,d=[];a.children[0].resultType===Uh&&b?d=d.concat(Ri(c,a.children[0],a.children[1],c.Fb)):(a.children.forEach(function(a){d=d.concat(a.B(c))}),
d=d.concat(a.La.P));return d}}),new Y("/",W,{priority:140,za:Mi,P:[32773],L:function(a,c){return Si(a,c,function(b){if(0===b[1])throw"division by 0 "+U(a.head);return Math.trunc(b[0]/b[1])},function(b){if(0===b[1])throw"division by 0 "+U(a.head);return b[0]/b[1]})},B:function(a,c){var b=a.children[1].resultType===Uh,d=[];a.children[0].resultType===Uh?b?d=d.concat(Ri(c,a.children[0],c.Fb,a.children[1])):(a.children.forEach(function(a){d=d.concat(a.B(c))}),d=d.concat(a.La.P)):b?d=d.concat(Ri(c,a.children[0],
c.Fb*c.Fb,a.children[1])):(a.children.forEach(function(a){d=d.concat(a.B(c))}),d=d.concat(a.La.P));return d}}),new Y("%",W,{priority:140,za:Mi,L:function(a,c){return Si(a,c,function(b){if(0===b[1])throw"division by 0 "+U(a.head);return b[0]%b[1]})},P:[32774],B:function(a,c){return Qi(a.children,a.resultType,c).concat(a.La.P)}}),new Y("+",W,{priority:130,za:Mi,L:function(a,c){return Si(a,c,function(a){return a[0]+a[1]})},P:[32770],B:function(a,c){return Qi(a.children,a.resultType,c).concat(a.La.P)}}),
new Y("-",W,{priority:130,za:Mi,L:function(a,c){return Si(a,c,function(a){return a[0]-a[1]})},P:[32771],B:function(a,c){return Qi(a.children,a.resultType,c).concat(a.La.P)}}),new Y("<<",W,{priority:120,L:function(a,c){return Si(a,c,function(a){return a[0]<<a[1]})},P:[32768],B:function(a,c){return a.children[0].B(c).concat(Qi(a.children.slice(1),xh,c)).concat(a.La.P)}}),new Y(">>",W,{priority:120,L:function(a,c){return Si(a,c,function(a){return a[0]>>a[1]})},P:[32769],B:function(a,c){return a.children[0].B(c).concat(Qi(a.children.slice(1),
xh,c)).concat(a.La.P)}}),new Y("==",W,{priority:80,resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]===a[1]?1:0})},P:[32778],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),new Y("!=",W,{priority:80,resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]!==a[1]?1:0})},P:[32779],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),
new Y("<",W,{priority:80,resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]<a[1]?1:0})},P:[32782],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),new Y("<=",W,{priority:80,resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]<=a[1]?1:0})},P:[32783],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),new Y(">",W,{priority:80,
resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]>a[1]?1:0})},P:[32780],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),new Y(">=",W,{priority:80,resultType:"b",L:function(a,c){return Si(a,c,function(a){return a[0]>=a[1]?1:0})},P:[32781],B:function(a,c){var b=a.children.map(function(a){return a.resultType});return Qi(a.children,Mi(c,a,b),c).concat(a.La.P)}}),new Y("&",W,{priority:110,L:function(a,c){return Si(a,
c,function(a){return a[0]&a[1]})},P:[32777]}),new Y("|",W,{priority:90,L:function(a,c){return Si(a,c,function(a){return a[0]|a[1]})},P:[32775]}),new Y("^",W,{priority:100,L:function(a,c){return Si(a,c,function(a){return a[0]^a[1]})},P:[32776]}),new Y("&&",W,{priority:60,za:Li,L:function(a,c){return Si(a,c,function(a){return a[0]&&a[1]?1:0})},P:[32785],B:function(a,c){var b=a.children[0].B(c).concat([16384|c.Sc,12288|c.Sc,4096,40960|th.indexOf("eq"),4,12288|c.Sc,36864]);Dh(c,b);a=Ni(a.children[1],
a.children[0].resultType,c).L(c);b=b.concat(a.B(c));Eh(c,b);return b}}),new Y("||",W,{priority:50,za:Li,L:function(a,c){return Si(a,c,function(a){return a[0]||a[1]?1:0})},P:[32784],B:function(a,c){var b=a.children[0].B(c).concat([16384|c.Sc,12288|c.Sc,4096,40960|th.indexOf("ne"),4,12288|c.Sc,36864]);Dh(c,b);a=Ni(a.children[1],a.children[0].resultType,c).L(c);b=b.concat(a.B(c));Eh(c,b);return b}}),new Y("?",W,{priority:40,za:function(a,c,b){return b[1]},L:function(a){if(!(a.children[1]instanceof Xh)||
0==a.children[1].La||":"!==a.children[1].La.name)throw"missing else part in conditional expression "+U(a.head);return a.children[0]instanceof Rh?a.children[1].children[a.children[0].n?0:1]:a},B:function(a,c){var b=Fi(a.children[0],c);Dh(c,b);b=b.concat(a.children[1].children[0].B(c)).concat(36864);Eh(c,b);Dh(c,b);b=b.concat(a.children[1].children[1].B(c));Eh(c,b);return b}}),new Y(":",W,{priority:41,za:Li,L:function(a,c){a.children[1]=Ni(a.children[1],a.children[0].resultType,c);return a},B:function(a){throw"unexpected colon outside conditional expression "+
U(a.head);}}),new Y("=",W,{priority:Yh,za:Li,L:Pi}),new Y(",",W,{priority:25,za:function(a,c){return c[1]},L:function(a){a.children[0].Nb=!1;return a}}),new Y("false",3,{resultType:"b",L:function(a,c){return Si(a,c,function(){return 0})},P:[4096]}),new Y("true",3,{resultType:"b",L:function(a,c){return Si(a,c,function(){return 1})},P:[4097]})];x=mh.prototype;
x.Ih=function(){for(;this.K<this.w;)if(" "===this.i[this.K]||"\t"===this.i[this.K])this.K++,this.Sa++;else if("\n"===this.i[this.K])this.K++,this.Sa=0,this.line++;else if("\r"===this.i[this.K])this.K++;else if("/*"===this.i.slice(this.K,this.K+2))for(this.K+=2,this.Sa+=2;this.K<this.w&&"*/"!==this.i.slice(this.K-2,this.K);)"\n"===this.i[this.K]?(this.Sa=0,this.line++):"\r"!==this.i[this.K]&&this.Sa++,this.K++;else if("//"===this.i.slice(this.K,this.K+2))for(;this.K<this.w&&"\n"!==this.i[this.K];)this.K++,
this.Sa++;else break};x.og=function(a){return Lb.prototype.og.call(this,a||Ki)};x.Ch=function(){this.G.forEach(function(a,c){a instanceof Nh&&("def"===a.name||0<=["int","bool","fixed","void"].indexOf(a.name))&&this.G[c+1]instanceof Mh&&this.G[c+2]instanceof Nh&&"("===this.G[c+2].name&&this.Ph.push(this.G[c+1].name)},this)};
function Ti(a,c){switch(a.name){case "var":case "def":return c||xh;case "void":return"v";case "int":return xh;case "bool":return"b";case "fixed":return Uh;default:throw"internal";}}function Oi(a){switch(a){case xh:return"int";case Uh:return"fixed";case "b":return"bool";default:return""}}function Ui(a){return Z(a,0,"int")||Z(a,0,"bool")||Z(a,0,"fixed")}
x.uh=function(){function a(){var a=[];for(this.o++;;){d=this.G[this.o];this.o++;if(!yi(this,0,Nh))throw"syntax error "+U(b);switch(this.G[this.o].name){case "[":if(Z(this,1,"]")){this.o+=2;if(!Z(this,0,"="))throw"missing size or initial value in array declaration"+U(this.G[this.o-2]);e=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(d)]);this.o++;e.children.push(zi(this,25));e.resultType=Ti(b,e.children[1].resultType);e.children[1].Wa(this);e.Nb=!1;var c=new Xh(new Nh(this.G[this.o].fe,this.G[this.o].Nd,
this.G[this.o].Ld,"size"),0,xi(this,"size",0),[e.children[1]]);a.push(new ki(b,d,e.resultType,[c],e))}else c=Ai(this,!0),Z(this,0,"=")?(e=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(d)]),this.o++,e.children.push(zi(this,25)),e.resultType=Ti(b,e.children[1].resultType),e.Nb=!1,a.push(new ki(b,d,e.resultType,c,e))):a.push(new ki(b,d,Ti(b),c));break;case "=":e=new Xh(this.G[this.o],W,xi(this,"=",W),[new Vh(d)]);this.o++;e.children.push(zi(this,25));e.resultType=Ti(b,e.children[1].resultType);e.Nb=
!1;e=e.L(this);a.push(new ki(b,d,e.resultType,null,e));break;default:a.push(new ki(b,d,Ti(b)))}if(Z(this,0,","))this.o++;else{if(Z(this,0,";"))return this.o++,a;throw"missing semicolon "+U(this.G[this.o]);}}}function c(){var a=Ti(b);d=this.G[this.o+1];this.o+=3;var c=[];if(!Z(this,0,")"))for(;;){var e=xh;Ui(this)&&(e=Ti(this.G[this.o]),this.o++);if(!yi(this,0,Mh))throw"bad function definition argument "+U(this.G[this.o]);var f=this.G[this.o].name,g=[],k=!1;this.o++;Z(this,0,"[")&&(k=!0,g=Ai(this,
!0));c.push({name:f,type:e,ai:g,size:1,A:[],od:k});if(Z(this,0,","))this.o++;else if(Z(this,0,")"))break;else throw"syntax error in function definition "+U(this.G[this.o]);}this.o++;if(!Z(this,0,"{"))throw"block expected after function header "+U(this.G[this.o]);this.o++;return new Vi(b,d.name,a,c)}if(this.o>=this.G.length)throw"no more tokens";var b=this.G[this.o];if(this.G[this.o]instanceof Nh)switch(b.name){case "const":if(!yi(this,1,Mh)||!Z(this,2,"="))throw'syntax error for "const" '+U(b);var d=
this.G[this.o+1];this.o+=3;var e=zi(this,25);e=e.L(this);if(!(e instanceof Rh))throw"non-constant expression in constant definition "+U(this.G[this.o]);if(!Z(this,0,";"))throw"missing semicolon "+U(b);this.o++;return[new ji(b,d.name,e)];case "int":case "bool":case "fixed":if(!yi(this,1,Mh))throw'unexpected token after "'+b.name+'" '+U(b);return Z(this,2,"(")?[c.call(this)]:a.call(this);case "void":return[c.call(this)];case "if":this.o++;var f=Ai(this);if(1!==f.length)throw'bad condition in "if" statement '+
U(this.G[this.o]);var g=new mi(b,f[0]);Z(this,0,"{")?this.o++:g.ma=!0;return[g];case "when":this.o++;f=Ai(this);if(1!==f.length)throw'bad condition in "when" statement '+U(this.G[this.o]);if(!Z(this,0,"{"))throw'block expected after "when" statement '+U(this.G[this.o]);this.o++;return[new pi(b,f[0])];case "switch":this.o++;f=Ai(this);if(1!==f.length)throw'bad expression in "switch" statement '+U(this.G[this.o]);if(!Z(this,0,"{"))throw'block expected after "switch" statement '+U(this.G[this.o]);this.o++;
return[new Wi(b,f[0])];case "case":this.o++;e=zi(this);if(!Z(this,0,":"))throw'missing colon after "case" '+U(this.G[this.o]);this.o++;return[new Xi(b,e)];case "default":if(!Z(this,1,":"))throw'missing colon after "default" '+U(this.G[this.o]);this.o+=2;return[new Xi(b,null)];case "goto":if(!yi(this,1,Mh))throw'missing label after "goto" '+U(this.G[this.o]);d=this.G[this.o+1];this.o+=2;return[new Yi(b,d.name)];case "while":this.o++;f=Ai(this);if(1!==f.length)throw'bad condition in "while" statement '+
U(this.G[this.o]);if(Z(this,0,";"))return this.o++,[new Zi(b,f[0])];if(!Z(this,0,"{"))throw'block expected after "while" statement '+U(this.G[this.o]);this.o++;return[new $i(b,f[0])];case "do":if(!Z(this,1,"{"))throw'block expected after "do" statement '+U(this.G[this.o]);this.o+=2;return[new aj(b)];case "for":if(!Z(this,1,"("))throw'"for" syntax error '+U(b);this.o+=2;d=null;var k=xh;if(Z(this,0,";"))e=null;else{if(Z(this,0,"var")||Ui(this)){if(!yi(this,1,Mh))throw'bad variable declaration in "for" statement '+
U(this.G[this.o]);k=Ti(this.G[this.o]);this.o++;d=this.G[this.o]}e=zi(this);if(!Z(this,0,";"))throw'semicolon expected in "for" statement '+U(this.G[this.o]);}this.o++;if(Z(this,0,";"))g=null;else if(g=zi(this),!Z(this,0,";"))throw'semicolon expected in "for" statement '+U(this.G[this.o]);this.o++;if(Z(this,0,")"))f=null;else if(f=zi(this),!Z(this,0,")"))throw'semicolon expected in "for" statement '+U(this.G[this.o]);this.o++;if(!Z(this,0,"{"))throw'block expected after "for" statement '+U(this.G[this.o]);
this.o++;return[new bj(b,d,k,e,g,f)];case ";":return this.o++,[new cj(b)];case "{":return this.o++,[new dj(b)];case "}":this.o++;if(Z(this,0,"else")){this.o++;if(Z(this,0,"if")){this.o++;f=Ai(this);if(1>f.length)throw'empty condition in "if" statement '+U(this.G[this.o]);1<f.length&&(g=new $h(b),g.children=f.slice(0,-1).map(function(a){a instanceof Xh&&(a.Nb=!1);return a}),f=f.slice(-1));if(!Z(this,0,"{"))throw'block expected after "if" statement '+U(this.G[this.o]);this.o++;return[new ni(b,f[0])]}if(!Z(this,
0,"{"))throw'block expected after "else" statement '+U(this.G[this.o]);this.o++;return[new oi(b)]}return[new vi(b)];case "else":throw'unexpected "else" '+U(this.G[this.o]);case "onevent":if(!yi(this,1,Mh))throw'unexpected token after "onevent" '+U(b);if(!Z(this,2,"{"))throw'block expected after "onevent" statement '+U(this.G[this.o]);d=this.G[this.o+1];this.o+=3;return[new ej(b,d.name)];case "return":this.o++;Z(this,0,";")?e=null:e=zi(this);if(!Z(this,0,";"))throw"missing semicolon "+U(b);this.o++;
return[new fj(b,e)];case "break":d=null;yi(this,1,Mh)&&(d=this.G[this.o+1],this.o++);if(!Z(this,1,";"))throw"missing semicolon "+U(b);this.o+=2;return[new gj(b,!1,d?d.name:null)];case "continue":d=null;yi(this,1,Mh)&&(d=this.G[this.o+1],this.o++);if(!Z(this,1,";"))throw"missing semicolon "+U(b);this.o+=2;return[new gj(b,!0,d?d.name:null)]}if(yi(this,0,Mh)&&Z(this,1,"(")&&(d=this.G[this.o],yh(this.Aa,d.name)))return this.o++,[new si(b,d.name,Ai(this))];if(yi(this,0,Mh)&&Z(this,1,":"))return d=this.G[this.o],
this.o+=2,[new hj(b,d.name)];e=zi(this);e.Nb=!1;if(!Z(this,0,";"))throw"missing semicolon "+(this.o<this.G.length?U(this.G[this.o]):"eof");this.o++;e=e.L(this);return[new li(e)]};
x.Cf=function(a){if(a instanceof Vi){for(var c=0;c<a.F.length;c++)a.F[c].size=1,a.F[c].A=a.F[c].ai.map(function(b){b=b.L(this);if(!(b instanceof Rh))throw"non-constant expression in argument dimension "+U(b.head);if(0>=b.n||Math.round(b.n)!==b.n)throw"bad value for argument dimension "+U(b.head);a.F[c].size*=b.n;return b.n},this),this.Wc(a.F[c].name,a.F[c].size,a.F[c].A,this.Ya,a.F[c].type,a.F[c].od),this.Ya+=a.F[c].od?1:a.F[c].size;a.ab[1]={ib:this.ib.slice(),labels:this.labels.slice()}}else a instanceof
bj?a.ca&&(this.Wc(a.ca.name,1,[1],this.Ya,a.Ha),this.Ya+=1,a.ab[1]={ib:this.ib.slice(),labels:this.labels.slice()}):Lb.prototype.Cf.call(this,a)};x.Be=function(){this.ib=this.Zg;this.labels=this.Yg};x.Ia=function(a){a&&(this.ib=a.ib,this.labels=a.labels)};x.getContext=function(){return{ib:this.ib,labels:this.labels.slice()}};function ij(a,c,b,d,e,f,g){wh.call(this,a,c,b,d,e);this.Sb=f;this.od=g||!1}ij.prototype=Object.create(wh.prototype);x=ij.prototype;x.constructor=ij;
x.Zd=function(a,c){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,20480|(c||0),a.Aa.b]:[12288|a.u,20480|this.offset+(c||0),a.Aa.b]:[12288|this.offset+(c||0)]};x.Vf=function(a,c){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,24576|(c||0),a.Aa.b]:[12288|a.u,24576|this.offset+(c||0),a.Aa.b]:[16384|this.offset+(c||0)]};x.sf=function(a){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,32770,20480,a.Aa.b]:[12288|a.u,32770,20480|this.offset,a.Aa.b]:[20480|this.offset,this.size]};
x.wg=function(a){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,32770,24576,a.Aa.b]:[12288|a.u,32770,24576|this.offset,a.Aa.b]:[24576|this.offset,this.size]};mh.prototype.Wc=function(a,c,b,d,e,f){this.ib.push(new ij(a,c,b,d,e,this.Sb,f))};function jj(a){Xh.call(this,a,4,null)}jj.prototype=Object.create(Xh.prototype);jj.prototype.constructor=jj;x=mh.prototype;
x.oh=function(a){var c=new jj(a,this.Sb,this.Ya);c.La={za:function(b,c){var d;a:{for(d=0;d<b.Uf.length;d++)if(b.Uf[d].vg===a.name){d=b.Uf[d];break a}d=null}return d?d.resultType:(d=Gh(b,a.name))&&d.za?d.za(b,d,c):xh}};return c};
x.ah=function(){this.Ya=this.Aa.Ya;this.Sb=!1;for(var a=[],c=0;c<this.b.length;c++){if(0<=[vi,ni,oi].indexOf(this.b[c].constructor)){if(0===a.length)throw"unexpected end of block "+U(this.b[c].head);var b=a.pop();this.Ya=b.Ya;this.Sb=b.Sb;b.ji.ab[0]={ib:this.ib.slice(),labels:this.labels.slice()};this.ib.splice(b.mi);this.labels.pop();0===a.length&&(this.ca=Ph)}0<=[mi,pi,Wi,$i,dj,bj,ej,Vi,ni,oi].indexOf(this.b[c].constructor)&&(a.push({Ya:this.Ya,Sb:this.Sb,mi:this.ib.length,ji:this.b[c]}),this.labels.push([]),
this.b[c]instanceof Vi&&(this.Sb=!0,this.ca=this.b[c].resultType,this.Ya=0));this.Cf(this.b[c]);if(this.b[c]instanceof hj){b=this.b[c].label;for(var d=this.labels.length-1,e=0;e<this.labels[d].length;e++)if(this.labels[d][e].label===b)throw'duplicate label "'+b+'"';this.labels[d].push({label:b})}}this.Zg=this.ib.slice();this.Yg=this.labels};
x.Bh=function(){for(var a=1;a<this.b.length;)this.b[a]instanceof Zi&&this.b[a-1]instanceof vi?this.b.splice(a-1,1):a++;this.b.forEach(function(a){a instanceof Vi&&(this.Uf.push(a),this.ca=a.resultType)},this);for(a=0;a<this.b.length-1;a++)this.b[a]instanceof hj&&(this.b[a+1]instanceof $i?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof aj?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof bj?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof Wi&&(this.b[a+1].label=this.b[a].label))};
x.Dh=function(){for(var a=0;a<this.b.length;a++)(this.b[a]instanceof ej||this.b[a]instanceof Vi)&&this.l.push(this.b[a])};function kj(a,c){for(var b=a.length-1;0<=b;b--)for(var d=a[b].length-1;0<=d;d--)if(a[b][d].label===c)return a[b][d];return null}
x.B=function(){this.Ha=[];this.Be();this.oc=[];this.Sc=this.Jb=this.tc=this.Aa.b-2;this.u=this.Sc+1;this.$g=[];var a=this.l.map(function(a){this.Xa=0;this.Ia(a.ab[0]);this.zg=a instanceof hi||a instanceof Vi;this.Sb=a instanceof Vi;this.oc=[];a=a.B(this,!0);Hi(a);return{ie:a,mapping:this.oc}},this);if(0<this.Ha.length)throw"internal";for(var c=0,b=0;b<this.l.length;b++)this.l[b]instanceof gi&&c++;var d=[],e={},f=[];this.oc=[];for(b=0;b<this.l.length;b++){var g=1+2*c+f.length;this.l[b]instanceof ej||
this.l[b]instanceof gi?(d.push({id:Ah(this.Aa,this.l[b].re),offset:f.length}),f=f.concat(a[b].ie)):this.l[b]instanceof hi?(e[this.l[b].Mh]=f.length,f=f.concat(a[b].ie)):this.l[b]instanceof Vi&&(e[this.l[b].vg]=f.length,f=f.concat(a[b].ie));this.oc=this.oc.concat(a[b].mapping.map(function(a){return new vh(a.Kh,a.line,a.Sa,a.ic+g)}))}a=[1+2*d.length];for(b=0;b<d.length;b++)a=a.concat(d[b].id,1+2*d.length+d[b].offset);for(b=0;b<f.length;b++)if("string"===typeof f[b]){if(void 0===e[f[b]])throw lj(f[b]),
'unknown function "'+f[b]+'"';f[b]=53248|e[f[b]]+a.length}return a.concat(f)};
x.lh=function(a){for(var c=a.head.name,b=0;b<this.l.length;b++)if(this.l[b]instanceof Vi&&this.l[b].vg===c){if(a.children.length!==this.l[b].F.length)throw"wrong number of arguments "+U(a.head);c=a.Nb?[c,12288|this.Sc]:[c];this.Sb?0<this.Ya&&(c=[12288|this.u,4096|this.Ya,32770,16384|this.u].concat(c).concat(12288|this.u,4096|this.Ya,32771,16384|this.u)):c=[4096|this.Ya,16384|this.u].concat(c);for(var d=[],e=0;e<a.children.length;e++){if(this.l[b].F[e].size!==a.children[e].nb)throw"incompatible size "+
U(a.children[e].head);if(this.l[b].F[e].od){if(!(a.children[e]instanceof Vh))throw"variable reference expected "+U(a.children[e].head);if(this.l[b].F[e].type!==a.children[e].resultType)throw"variable reference type mismatch "+U(a.children[e].head);}if(this.l[b].F[e].od){var f=Fh(this,a.children[e]);d=d.concat(f.Sb?f.od?[12288|this.u,20480|f.offset,this.Aa.b]:[12288|this.u,4096|f.offset,32770]:[4096|f.offset]).concat(this.Sb?[12288|this.u,24576|e+this.Ya,this.Aa.b]:16384|e+this.Ya)}else a.children[e]=
Ni(a.children[e],this.l[b].F[e].type,this).L(this),d=d.concat(a.children[e].B(this)).concat(this.Za(a.children[e].resultType,this.l[b].F[e].type)).concat(this.Sb?[12288|this.u,24576|e+this.Ya,this.Aa.b]:16384|e+this.Ya)}return d.concat(c)}return null};function mj(a){a=a.trim();if(""===a)return!1;var c=["#","//","/*"].map(function(b){b=a.indexOf(b);return 0>b?a.length:b}).sort(function(a,c){return a-c})[0];return c<a.length?"#"!==a[c]:/[;{]/.test(a)}
Th.prototype.B=function(a){return Di(Math.round(this.n*a.Fb))};function dj(a){X.call(this,a,3)}dj.prototype=Object.create(X.prototype);dj.prototype.constructor=dj;dj.prototype.L=function(a){Qh(this.children,a);return this};dj.prototype.B=function(a){var c=a.getContext();ei(this,a);a.Ia(this.ab[0]);var b=V.prototype.B.call(this,a);a.Ia(c);return b};function cj(a){X.call(this,a)}cj.prototype=Object.create(X.prototype);cj.prototype.constructor=cj;cj.prototype.B=function(){return[]};
function $i(a,c){qi.call(this,a,c);this.label=null}$i.prototype=Object.create(qi.prototype);$i.prototype.constructor=$i;$i.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();ei(this,a);var b=[],d=a.Xa;a.ma.push({});null!=this.Ta&&(b=Fi(this.Ta,a));Dh(a,b);a.Ia(this.ab[0]);this.children.forEach(function(c){a.Xa=d+b.length;b=b.concat(c.B(a))});b=b.concat(36864|-b.length&4095);Eh(a,b);nj(b,0,b.length,this.label);a.ma.pop();a.Ia(c);return b};
function aj(a){X.call(this,a,3);this.label=this.Ta=null}aj.prototype=Object.create(X.prototype);aj.prototype.constructor=aj;aj.prototype.zh=function(a){if(!(a instanceof Zi))throw'unexpected closing statement for "do"';this.Ta=a.Ta};
aj.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();ei(this,a);var b=[],d=a.Xa;a.ma.push({});a.Ia(this.ab[0]);this.children.forEach(function(c){a.Xa=d+b.length;b=b.concat(c.B(a))});null!=this.Ta&&(b=b.concat(Fi(new Xh(new Nh(this.Ta.head.fe,this.Ta.head.Nd,this.Ta.head.Ld,"not"),0,xi(a,"!",0),[this.Ta]),a)),Dh(a,b),Eh(a,b,0));nj(b,0,b.length,this.label);a.ma.pop();a.Ia(c);return b};function Zi(a,c){X.call(this,a,5);this.Ta=c}Zi.prototype=Object.create(X.prototype);
Zi.prototype.constructor=Zi;function bj(a,c,b,d,e,f){X.call(this,a,3);d&&(d.Nb=!1);f&&(f.Nb=!1);this.ca=c;this.Ha=b;this.i=d;this.b=e;this.l=f;this.label=null;this.S=[]}bj.prototype=Object.create(X.prototype);x=bj.prototype;x.constructor=bj;x.Wa=function(a){V.prototype.Wa.call(this,a);this.i&&this.i.Wa(a);this.b&&this.b.Wa(a);this.l&&this.l.Wa(a)};x.L=function(a){this.i&&(this.i=this.i.L(a));this.b&&(this.b=this.b.L(a));this.l&&(this.l=this.l.L(a));Qh(this.children,a);return this};
x.Ae=function(a,c){this.S.push(c)};
x.B=function(a){var c=a.getContext();ei(this,a);a.Ia(this.ab[1]);var b=a.Xa,d=this.i?this.i.B(a):[];a.ma.push({});var e=d.length;this.b&&(d=d.concat(Fi(this.b,a)),Dh(a,d));a.Ia(this.ab[0]);for(var f=0;f<this.children.length;f++)a.Xa=b+d.length,d=d.concat(this.children[f].B(a));a.Ia(this.ab[1]);f=d.length;a.Xa=b+d.length;Oh(a,this.S[0]);this.l&&(d=d.concat(this.l.B(a)));d=d.concat(36864|e-d.length&4095);this.b&&Eh(a,d);nj(d,f,d.length,this.label);a.ma.pop();a.Ia(c);return d};
function gj(a,c,b){X.call(this,a);this.H=c;this.label=b}gj.prototype=Object.create(X.prototype);gj.prototype.constructor=gj;function oj(a,c){fi.call(this,a,c)}oj.prototype=Object.create(fi.prototype);oj.prototype.constructor=oj;function nj(a,c,b,d){for(var e=0;e<a.length;e++)if(a[e]instanceof oj){var f=a[e].ya.label;if(null==f||f===d)a[e]=a[e].ya.H?36864|c-e&4095:36864|b-e&4095}}
function lj(a){if(a instanceof oj){var c=a.ya.label;if(null!=c)throw"unknown "+(a.ya.H?"continue":"break")+' label "'+c+'"'+U(a.ya.head);throw'unexpected "'+(a.ya.H?"continue":"break")+'" '+U(a.ya.head);}}gj.prototype.B=function(a){if(0===a.ma.length)throw(this.H?'"continue"':'"break"')+" outside loop "+U(this.head);ei(this,a);return[new oj(a,this)]};function Wi(a,c){X.call(this,a,3);this.u=c;this.label=null}Wi.prototype=Object.create(X.prototype);Wi.prototype.constructor=Wi;
Wi.prototype.B=function(a){var c=a.Xa,b=this.u.B(a).concat(16384|a.Sc),d=a.getContext();a.Ia(this.ab[0]);var e=!(this.children[0]instanceof Xi);e&&(b=b.concat(36864),Dh(a,b));a.ma.push({});for(var f=!1,g=0;g<this.children.length;)if(a.Xa=c+b.length,this.children[g]instanceof Xi){for(var k=[],l=!1;g<this.children.length&&this.children[g]instanceof Xi;){if(null!=this.children[g].u){var h=this.children[g].u.L(a);if(!(h instanceof Rh))throw'non-constant expression in "case" '+U(this.children[g].head);
k.push(h.n)}else l=!0;g++}l?e&&(Eh(a,b),e=!1):(1===k.length?(f&&(b=b.concat(36869)),e&&Eh(a,b),b=b.concat(12288|a.Sc).concat(Di(k[0])).concat(40960|th.indexOf("eq"),0)):(f&&(b=b.concat(36864|4*k.length+1)),e&&Eh(a,b),k.forEach(function(c,d){b=b.concat(12288|a.Sc).concat(Di(c)).concat(40960|th.indexOf("ne"),4*(k.length-d)-1)}),b=b.concat(36864)),Dh(a,b),e=!0);f=!0}else b=b.concat(this.children[g].B(a)),f=!(this.children[g]instanceof gj)&&!(this.children[g]instanceof fj),g++;nj(b,-1,b.length,this.label);
a.ma.pop();a.Ia(d);return b};function Xi(a,c){X.call(this,a);this.u=c}Xi.prototype=Object.create(X.prototype);Xi.prototype.constructor=Xi;Xi.prototype.B=function(){throw(this.u?'"case"':'"default"')+" outside switch "+U(this.head);};function hj(a,c){X.call(this,a);this.label=c}hj.prototype=Object.create(X.prototype);hj.prototype.constructor=hj;hj.prototype.B=function(a){a.label=this.label;kj(a.labels,this.label).Rh=a.Xa;return[]};function Yi(a,c){X.call(this,a);this.label=c}Yi.prototype=Object.create(X.prototype);
Yi.prototype.constructor=Yi;function pj(a,c,b){fi.call(this,a,c);this.labels=b}pj.prototype=Object.create(fi.prototype);pj.prototype.constructor=pj;pj.prototype.B=function(a){var c=kj(this.labels,this.ya.label);if(null===c)throw'unknown label "'+this.ya.label+'" '+U(this.ya.head);return 36864|c.Rh-a&4095};Yi.prototype.B=function(a){return[new pj(a,this,a.labels.slice())]};function ej(a,c){X.call(this,a,3);this.re=c}ej.prototype=Object.create(X.prototype);ej.prototype.constructor=ej;
ej.prototype.L=function(a){Qh(this.children,a);return this};ej.prototype.B=function(a,c){if(c){c=a.getContext();ei(this,a);a.Ia(this.ab[0]);var b=V.prototype.B.call(this,a).concat(0);a.Ia(c);return b}return[]};function Vi(a,c,b,d){X.call(this,a,3);this.vg=c;this.resultType=b;this.F=d}Vi.prototype=Object.create(X.prototype);Vi.prototype.constructor=Vi;Vi.prototype.yh=function(a){a.ca=this.resultType};Vi.prototype.L=function(a){Qh(this.children,a);return this};
Vi.prototype.B=function(a,c){if(c){c=a.getContext();ei(this,a);a.Ia(this.ab[0]);var b=V.prototype.B.call(this,a).concat(57344);a.Ia(c);return b}return[]};function fj(a,c){X.call(this,a);c&&this.children.push(c)}fj.prototype=Object.create(X.prototype);fj.prototype.constructor=fj;
fj.prototype.Ae=function(a){if(a.ca===Ph)throw'"return" outside function definition '+U(this.head);if("v"===a.ca&&0<this.children.length)throw"unexpected return value in void function "+U(this.head);if("v"!==a.ca&&0===this.children.length)throw"missing return value in non-void function "+U(this.head);0<this.children.length&&(this.children[0]=Ni(this.children[0],a.ca,a).L(a))};
fj.prototype.B=function(a){ei(this,a);var c=[];0<this.children.length&&(c=this.children[0].B(a).concat(a.Za(this.children[0].resultType,a.ca)).concat(16384|a.Sc));return c.concat(57344)};var nh=[{name:"abs",Gd:1,za:function(a,c){return c[0]},rf:function(){return!0},Mb:function(a,c,b,d){return[12288|d,28673]}},{name:"atan2",Gd:2,Ue:1,za:function(){return Uh},rf:function(a){return null!=yh(a,"math.atan2")},Mb:function(a,c,b,d){return(b[0]===Uh&&b[1]!==Uh?[12288|d+1,4096|a.Fb,32772,16384|d+1]:b[0]!==Uh&&b[1]===Uh?[12288|d,4096|a.Fb,32772,16384|d]:[]).concat([4097,4096|d+1,4096|d,4096|d+2,49152|yh(c,"math.atan2").id,12288|d+2,4096|Math.floor(32768/(a.Fb*Math.PI)),32773])}},{name:"cos",
Gd:1,Ue:1,za:function(){return Uh},rf:function(a){return null!=yh(a,"math.cos")},Mb:function(a,c,b,d){return[12288|d,4096|Math.round(32767/((b[0]===Uh?a.Fb:1)*Math.PI)),32772,16384|d,4097,4096|d,4096|d+1,49152|yh(c,"math.cos").id,12288|d+1,4096|Math.floor(32768/a.Fb),32773]}},Ii("rand","math.rand",0),{name:"random",Gd:0,Ue:1,za:function(){return Uh},rf:function(a){return null!=yh(a,"math.rand")},Mb:function(a,c,b,d){return[4097,4096|d,49152|yh(c,"math.rand").id,12288|d,28673,4096|Math.floor(32768/
a.Fb),32773]}},{name:"stop",Gd:0,za:function(){return"v"},Mb:function(){return[0]}},{name:"sin",Gd:1,Ue:1,za:function(){return Uh},rf:function(a){return null!=yh(a,"math.sin")},Mb:function(a,c,b,d){return[12288|d,4096|Math.round(32767/((b[0]===Uh?a.Fb:1)*Math.PI)),32772,16384|d,4097,4096|d,4096|d+1,49152|yh(c,"math.sin").id,12288|d+1,4096|Math.floor(32768/a.Fb),32773]}},{name:"sqrt",Gd:1,Ue:6,za:function(){return Uh},Mb:function(a,c,b,d){c=Di(b[0]===Uh?a.Fb:a.Fb*a.Fb);return[4096|a.Fb,16384|d+1,4106,
16384|d+2,12288|d,16384|d+4].concat(c).concat([16384|d+5,12288|d+1,16384|d+6,4097,4096|d+6,4096|d+5,4096|d+4,4096|d+3,49152|yh(a.Aa,"math.muldiv").id,12288|d+3,12288|d+1,32770,4098,32773,16384|d+1,12288|d+2,4097,32771,16384|d+2,12288|d+2,4096,40960|th.indexOf("le"),-(23+c.length)&65535,12288|d+1])}}];var Kb={name:"thymio-II",maxVarSize:620,variables:[{name:"_id",size:1},{name:"event.source",size:1},{name:"event.args",size:32},{name:"_fwversion",size:2},{name:"_productId",size:1},{name:"buttons._raw",size:5},{name:"button.backward",size:1},{name:"button.left",size:1},{name:"button.center",size:1},{name:"button.forward",size:1},{name:"button.right",size:1},{name:"buttons._mean",size:5},{name:"buttons._noise",size:5},{name:"prox.horizontal",size:7},{name:"prox.comm.rx._payloads",size:7},{name:"prox.comm.rx._intensities",
size:7},{name:"prox.comm.rx",size:1},{name:"prox.comm.tx",size:1},{name:"prox.ground.ambiant",size:2},{name:"prox.ground.reflected",size:2},{name:"prox.ground.delta",size:2},{name:"motor.left.target",size:1},{name:"motor.right.target",size:1},{name:"_vbat",size:2},{name:"_imot",size:2},{name:"motor.left.speed",size:1},{name:"motor.right.speed",size:1},{name:"motor.left.pwm",size:1},{name:"motor.right.pwm",size:1},{name:"_integrator",size:2},{name:"acc",size:3},{name:"leds.top",size:3},{name:"leds.bottom.left",
size:3},{name:"leds.bottom.right",size:3},{name:"leds.circle",size:8},{name:"temperature",size:1},{name:"rc5.address",size:1},{name:"rc5.command",size:1},{name:"mic.intensity",size:1},{name:"mic.threshold",size:1},{name:"mic._mean",size:1},{name:"timer.period",size:2},{name:"acc._tap",size:1},{name:"sd.present",size:1}],localEvents:[{name:"button.backward"},{name:"button.left"},{name:"button.center"},{name:"button.forward"},{name:"button.right"},{name:"buttons"},{name:"prox"},{name:"prox.comm"},{name:"tap"},
{name:"acc"},{name:"mic"},{name:"sound.finished"},{name:"temperature"},{name:"rc5"},{name:"motor"},{name:"timer0"},{name:"timer1"}],nativeFunctions:[{name:"_system_reboot",args:[]},{name:"_system_settings_read",args:[1,1]},{name:"_system_settings_write",args:[1,1]},{name:"_system_settings_flash",args:[]},{name:"math.copy",args:[-1,-1]},{name:"math.fill",args:[-1,1]},{name:"math.addscalar",args:[-1,-1,1]},{name:"math.add",args:[-1,-1,-1]},{name:"math.sub",args:[-1,-1,-1]},{name:"math.mul",args:[-1,
-1,-1]},{name:"math.div",args:[-1,-1,-1]},{name:"math.min",args:[-1,-1,-1]},{name:"math.max",args:[-1,-1,-1]},{name:"math.clamp",args:[-1,-1,-1,-1]},{name:"math.dot",args:[1,-1,-1,1]},{name:"math.stat",args:[-1,1,1,1]},{name:"math.argbounds",args:[-1,1,1]},{name:"math.sort",args:[-1]},{name:"math.muldiv",args:[-1,-1,-1,-1]},{name:"math.atan2",args:[-1,-1,-1]},{name:"math.sin",args:[-1,-1]},{name:"math.cos",args:[-1,-1]},{name:"math.rot2",args:[2,2,1]},{name:"math.sqrt",args:[-1,-1]},{name:"math.rand",
args:[-1]},{name:"_leds.set",args:[1,1]},{name:"sound.record",args:[1]},{name:"sound.play",args:[1]},{name:"sound.replay",args:[1]},{name:"sound.system",args:[1]},{name:"leds.circle",args:[1,1,1,1,1,1,1,1]},{name:"leds.top",args:[1,1,1]},{name:"leds.bottom.left",args:[1,1,1]},{name:"leds.bottom.right",args:[1,1,1]},{name:"sound.freq",args:[1,1]},{name:"leds.buttons",args:[1,1,1,1]},{name:"leds.prox.h",args:[1,1,1,1,1,1,1,1]},{name:"leds.prox.v",args:[1,1]},{name:"leds.rc",args:[1]},{name:"leds.sound",
args:[1]},{name:"leds.temperature",args:[1,1]},{name:"sound.wave",args:[142]},{name:"prox.comm.enable",args:[1]},{name:"sd.open",args:[1,1]},{name:"sd.write",args:[-1,1]},{name:"sd.read",args:[-1,1]},{name:"sd.seek",args:[1,1]},{name:"_rf.nodeid",args:[1]},{name:"_poweroff",args:[]}]};function ph(a,c){this.Aa=a;this.b=c}function qj(a){var c={};a.Aa.Na.forEach(function(a){c[a.name]=a.offset});c._userdata=a.Aa.Ya;c._topdata=a.Aa.b;c["_ev.init"]=65535;a.Aa.Pc.forEach(function(a,d){c["_ev."+a.name]=65534-d});a.Aa.Ub.forEach(function(a){c["_nf."+a.name]=a.id});return c}
function oh(a){for(var c=a.b.split("\n"),b=[],d=qj(a),e=0;2>e;e++){b=[];var f=null;c.forEach(function(a,c){var g=/^\s*(;.*)?$/.exec(a);if(!g)if(g=/^\s*([\w_.]+:)\s*(;.*)?$/i.exec(a))f=g[1].slice(0,-1),d[f]=b.length;else if(g=/^\s*([\w_.]+:)?\s*([a-z0-9.]+)([-+a-z0-9\s._,=]*)(;.*)?$/i.exec(a)){if(g[1]&&(f=g[1].slice(0,-1),d[f]=b.length),a=g[2],g=g[3].trim(),a){var h=0<g.length?g.split(",").map(function(a){return a.trim().split(/\s+/)}):[];h=[].concat.apply([],h);g=rj[a];if(void 0==g)throw'Unknown instruction "'+
a+'" (line '+(c+1).toString(10)+")";if(-1!==g.fc&&(g.fc||0)!=h.length)throw"Wrong number of arguments (line "+(c+1).toString(10)+")";void 0!==g.code?b=b.concat(g.code):g.$b&&(a=h.map(function(a){/^[a-z]+=/.test(a)&&(a=a.replace(/^[a-z]+=/,""));return/^(0x[0-9a-f]+|[0-9]+)$/i.test(a)?parseInt(a,0):a}),b=b.concat(g.$b(b.length,a,f,d,e,c+1)));f&&d[f]!==b.length&&(f=null)}}else throw"Syntax error (line "+(c+1).toString(10)+")";},a)}return b}
function sj(a,c,b,d){function e(e){if(!b)return 0;if(/^(0x[0-9a-f]+|[0-9]+)$/i.test(e))return parseInt(e,0);if(!c.hasOwnProperty(e))throw'Unknown symbol "'+a+'" (line '+d.toString(10)+")";return c[e]}if("string"===typeof a){for(var f=0,g=!1,k=0;k<a.length;){var l=/^(\+|-|[._a-z0-9]+)/i.exec(a.slice(k));if(null==l)throw"Syntax error (line "+d.toString(10)+")";switch(l[0]){case "+":g=!1;break;case "-":g=!0;break;default:f+=g?-e(l[0]):e(l[0])}k+=l[0].length}return f}return a}
var rj={dc:{fc:-1,$b:function(a,c,b,d,e,f){return c.map(function(a){a=sj(a,d,1===e,f);return a&65535})}},equ:{fc:1,$b:function(a,c,b,d,e,f){if(!b)throw'No label for pseudo-instruction "equ" (line '+f.toString(10)+")";d&&(d[b]=sj(c[0],d,1===e,f));return[]}},stop:{code:[0]},"push.s":{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(2048<=a||2048<-a)throw"Small integer overflow (line "+f.toString(10)+")";return[4096|a&4095]}},push:{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(32768<=a||
32768<-a)throw"Integer overflow (line "+f.toString(10)+")";return[8192,a&65535]}},load:{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";return[12288|a&4095]}},store:{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";return[16384|a&4095]}},"load.ind":{fc:2,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+
f.toString(10)+")";c=sj(c[1],d,1===e,f);if(0>c||65536<=c)throw"Array size overflow (line "+f.toString(10)+")";return[20480|a&4095,c&65535]}},"store.ind":{fc:2,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";c=sj(c[1],d,1===e,f);if(0>c||65536<=c)throw"Array size overflow (line "+f.toString(10)+")";return[24576|a&4095,c&65535]}},neg:{code:[28672]},abs:{code:[28673]},bitnot:{code:[28674]},not:{$b:function(a,c,b,d,e,f){throw"Unary not not implemented in the VM (line "+
f.toString(10)+")";}},sl:{code:[32768]},asr:{code:[32769]},add:{code:[32770]},sub:{code:[32771]},mult:{code:[32772]},div:{code:[32773]},mod:{code:[32774]},bitor:{code:[32775]},bitxor:{code:[32776]},bitand:{code:[32777]},eq:{code:[32778]},ne:{code:[32779]},gt:{code:[32780]},ge:{code:[32781]},lt:{code:[32782]},le:{code:[32783]},or:{code:[32784]},and:{code:[32785]},jump:{fc:1,$b:function(a,c,b,d,e,f){c=sj(c[0],d,1===e,f);if(2048<=c-a||2048<a-c)throw"Jump too far (line "+f.toString(10)+")";return[36864|
c-a&4095]}},"jump.if.not":{fc:2,$b:function(a,c,b,d,e,f){b=rj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+c[0]+'" for jump.if.not (line '+f.toString(10)+")";c=sj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[40960|b.code[0]&255,c-a&65535]}},"do.jump.when.not":{fc:2,$b:function(a,c,b,d,e,f){b=rj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+
c[0]+'" for do.jump.when.not (line '+f.toString(10)+")";c=sj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[41216|b.code[0]&255,c-a&65535]}},"do.jump.always":{fc:2,$b:function(a,c,b,d,e,f){b=rj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+c[0]+'" for do.jump.always (line '+f.toString(10)+")";c=sj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[41728|
b.code[0]&255,c-a&65535]}},emit:{fc:3,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Event id out of range (line "+f.toString(10)+")";b=sj(c[1],d,1===e,f);if(0>b||65536<=b)throw"Address out of range (line "+f.toString(10)+")";c=sj(c[2],d,1===e,f);if(0>c||65536<=c)throw"Size out of range (line "+f.toString(10)+")";return[45056|a&4095,b&65535,c&65535]}},callnat:{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Native call id out of range (line "+f.toString(10)+
")";return[49152|a&4095]}},callsub:{fc:1,$b:function(a,c,b,d,e,f){a=sj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Subroutine address out of range (line "+f.toString(10)+")";return[53248|a&4095]}},ret:{code:[57344]}};function tj(a,c,b){this.id=a;this.u=c;if(b instanceof ArrayBuffer)this.i=b;else if(b){for(a=c=0;a<b.length;a++)c="string"===typeof b[a]?c+(1+b[a].length):c+2;c=new ArrayBuffer(c);for(var d=new DataView(c),e=a=0;a<b.length;a++)if("string"===typeof b[a]){d.setUint8(e++,b[a].length);for(var f=0;f<b[a].length;f++)d.setUint8(e++,b[a].charCodeAt(f))}else 32768>b[a]?d.setInt16(e,b[a],!0):d.setUint16(e,b[a],!0),e+=2;this.i=c}else this.i=new ArrayBuffer(0)}
function uj(a){function c(a){for(var c=[],d=0,e=0;e<a.length;e++)if(a[e]){for(var f=b.getUint8(d),g="",t=0;t<f;t++)g+=String.fromCharCode(b.getUint8(d+1+t));c.push(g);d+=1+f}else c.push(b.getUint16(d,!0)),d+=2;return c}var b=new DataView(a.i);switch(a.id){case vj:var d=c([!0,!1,!1,!1,!1,!1,!1,!1]);a.nodeName=d[0];a.Me=d[2];a.Ze=d[3];a.Pd=d[4];break;case wj:d=c([!1,!0]);a.Ya=d[0];a.S=d[1];break;case xj:d=c([!0,!0]);break;case yj:var e=[!0,!0,!1];d=c(e);a.functionName=d[0];a.w=d[2];for(var f=0;f<a.w;f++)e.push(!1),
e.push(!0);d=c(e);a.ja=[];for(f=0;f<a.w;f++)a.ja.push({size:d[3+2*f]-(d[3+2*f]&32768?65536:0),name:d[4+2*f]});break;case zj:b.getUint16(0,!0);a.Ic=[];for(f=2;f<b.byteLength;f+=2)a.Ic.push(b.getUint16(f,!0));break;case Aj:a.b=b.getUint16(0,!0);f=b.getUint16(2,!0);a.flags={flags:f,Bi:0!==(f&1),Ki:0!==(f&2),Ci:0!==(f&4)};break;case Bj:a.b=b.getUint16(2,!0);a.result=b.getUint16(4,!0);break;case Cj:a.l=b.getUint16(0,!0);b.getUint16(2,!0);d=[];for(f=4;f<b.byteLength;f+=2)d.push(b.getUint16(f,!0));a.ie=
d;break;case Dj:case Ej:case Fj:case Gj:case Hj:case Ij:case Jj:a.l=b.getUint16(0,!0);break;case Kj:case Lj:a.l=b.getUint16(0,!0);a.b=b.getUint16(2,!0);break;case Mj:a.l=b.getUint16(0,!0);b.getUint16(2,!0);b.getUint16(4,!0);break;case Nj:a.l=b.getUint16(0,!0);b.getUint16(2,!0);d=[];for(f=4;f<b.byteLength;f+=2)d.push(b.getUint16(f,!0));break;case Oj:a.version=b.getUint16(0,!0)}}
function Pj(a){var c=new ArrayBuffer(6+a.i.byteLength),b=new DataView(c);b.setUint16(0,a.i.byteLength,!0);b.setUint16(2,a.u,!0);b.setUint16(4,a.id,!0);(new Uint8Array(c)).set(new Uint8Array(a.i),6);return c}tj.prototype.sb=function(){var a=new tj(this.id,this.u,this.i);uj(a);return a};tj.prototype.toString=function(){var a=Qj[this.id]||"0x"+this.id.toString(16);a+=" from "+this.u.toString(10);0<=this.l&&(a+=" to "+this.l.toString());return a};
var vj=36864,wj=36865,xj=36866,yj=36867,zj=36869,Aj=36874,Bj=36875,Cj=40961,Ej=40962,Fj=40963,Gj=40964,Hj=40965,Ij=40966,Jj=40967,Kj=40968,Lj=40969,Dj=40970,Mj=40971,Nj=40972,Oj=40977,Qj={36864:"description",36865:"namedVariableDescription",36866:"localEventDescription",36867:"nativeFunctionDescription",36869:"variables",36874:"executionStateChanged",36876:"nodePresent",40960:"getDescription",40961:"setBytecode",40962:"reset",40963:"run",40964:"pause",40965:"step",40966:"stop",40967:"getExecutionState",
40968:"breakpointSet",40969:"breakpointClear",40970:"breakpointClearAll",40971:"getVariables",40972:"setVariables",40976:"getNodeDescription",40977:"listNodes"};function Rj(a){this.xe=a&&a.xe||54321;this.Na=a&&a.Na||[];this.Pc=a&&a.Pc||[];this.Ub=a&&a.Ub||[];this.Me=a&&a.Me||500;this.Ze=a&&a.Ze||200;this.Pd=a&&a.Pd||200;a=[];for(var c=0,b=0;b<this.Na.length;b++)this.Na[b].offset=c,a=a.concat(this.Na[b].Z),c+=this.Na[b].Z.length;for(;a.length<this.Pd;)a.push(0);this.Ic=a;this.P=[];this.b=0;this.i=!1;this.l=!0;this.u=!1;this.stack=[];this.S=[];this.write=this.w=this.H=null}
Rj.prototype.sb=function(){var a=new Rj({xe:this.xe,Na:this.Na,Pc:this.Pc,Ub:this.Ub,Me:this.Me,Ze:this.Ze,Pd:this.Pd});a.Me=this.Me;a.Ze=this.Ze;a.Pd=this.Pd;a.P=this.P.slice();a.b=this.b;a.i=this.i;a.l=this.l;a.u=this.u;a.stack=this.stack.slice();a.S=this.S.slice();return a};
function Sj(a,c,b){if(a.H)for(var d=0;d<a.Na.length;d++)if(a.Na[d].offset+a.Na[d].Z.length>c&&a.Na[d].offset<c+b.length)for(var e=0;e<a.Na[d].Z.length;e++)0<=a.Na[d].offset+e-c&&a.Na[d].offset+e-c<b.length&&a.H(a.Na[d].name,e,b[a.Na[d].offset+e-c],a.Ic[a.Na[d].offset+e],a.Ic.slice(a.Na[d].offset,a.Na[d].offset+a.Na[d].Z.length));b.forEach(function(a,b){this.Ic[c+b]=a},a)}
function Tj(a,c){a:{if(0<a.P.length)for(var b=1;b<a.P[0];b+=2)if(a.P[b]==c){c=a.P[b+1];break a}c=null}null!==c&&(a.i&&(b=new tj(36872,a.xe,[a.b]),a.write&&a.write(Pj(b))),a.b=c,a.i=!0)}function Uj(a){a.i=!1;a.l=!0;a.u=!1;if(0<a.P.length)for(var c=a.P[0];c<a.P.length;){var b=a.P[c];10==b>>>12&&(a.P[c]&=-513);c+=[1,1,2,1,1,2,2,1,1,1,2,3,1,1,1,1][b>>>12]}a.stack=[];for(c=0;c<a.Ic.length;c++)a.Ic[c]=0;a.ca&&a.ca();Tj(a,65535)}
function Vj(a){function c(a){return 32768<=a?a-65536:a}function b(a){switch(a){case 28672:d.stack.push(-d.stack.pop());break;case 28673:d.stack.push(Math.abs(d.stack.pop()));break;case 28674:d.stack.push(~d.stack.pop());break;case 32768:a=d.stack.pop();d.stack.push(c(d.stack.pop()<<a&65535));break;case 32769:a=d.stack.pop();d.stack.push(d.stack.pop()>>a);break;case 32770:d.stack.push(c(d.stack.pop()+d.stack.pop()&65535));break;case 32771:a=d.stack.pop();d.stack.push(c(d.stack.pop()-a&65535));break;
case 32772:d.stack.push(c(d.stack.pop()*d.stack.pop()&65535));break;case 32773:a=d.stack.pop();d.stack.push(c(Math.trunc(d.stack.pop()/a)&65535));break;case 32774:a=d.stack.pop();d.stack.push(c(d.stack.pop()%a&65535));break;case 32775:d.stack.push(c((d.stack.pop()|d.stack.pop())&65535));break;case 32776:d.stack.push(c((d.stack.pop()^d.stack.pop())&65535));break;case 32777:d.stack.push(c(d.stack.pop()&d.stack.pop()&65535));break;case 32778:d.stack.push(d.stack.pop()===d.stack.pop()?1:0);break;case 32779:d.stack.push(d.stack.pop()!==
d.stack.pop()?1:0);break;case 32780:a=d.stack.pop();d.stack.push(d.stack.pop()>a?1:0);break;case 32781:a=d.stack.pop();d.stack.push(d.stack.pop()>=a?1:0);break;case 32782:a=d.stack.pop();d.stack.push(d.stack.pop()<a?1:0);break;case 32783:a=d.stack.pop();d.stack.push(d.stack.pop()<=a?1:0);break;case 32784:a=d.stack.pop();d.stack.push(d.stack.pop()||a?1:0);break;case 32785:a=d.stack.pop();d.stack.push(d.stack.pop()&&a?1:0);break;default:throw"unknown op 0x"+a.toString(16);}}var d=a,e=a.P[a.b],f=e&4095;
switch(e>>>12){case 0:a.i=!1;break;case 1:a.stack.push(2048<=f?f-4096:f);break;case 2:a.b++;a.stack.push(c(a.P[a.b]));break;case 3:a.stack.push(a.Ic[f]);break;case 4:Sj(a,f,[a.stack.pop()]);break;case 5:a.b++;e=a.P[a.b];var g=a.stack.pop();if(g>=e)throw"out of bounds";a.stack.push(a.Ic[f+g]);break;case 6:a.b++;e=a.P[a.b];g=a.stack.pop();if(g>=e)throw"Index out of bounds";Sj(a,f+g,[a.stack.pop()]);break;case 9:a.b+=(2048<=f?f-4096:f)-1;break;case 10:var k=e&256;b(32768|e&255);f=0!=a.stack.pop();a.b++;
g=c(a.P[a.b]);if(k){k=a.b-1;if(e&512||!f)a.b+=g-2;a.P[k]=f?a.P[k]|512:a.P[k]&-513}else f||(a.b+=g-2);break;case 11:g=a.P[a.b+1];e=a.P[a.b+2];e=a.Ic.slice(g,g+e);a.b+=2;null(f,e);break;case 12:if(0>f||f>=a.Ub.length)throw"Native call index out of bounds";var l=a.Ub[f].ja.map(function(){return{p:this.stack.pop()}},a),h=[];a.Ub[f].ja.forEach(function(a,b){l[b].Hh=0===a.size?this.stack.pop():a.size},a);a.Ub[f].ja.forEach(function(a){0>a.size&&void 0===h[-a.size]&&(h[-a.size]=0)},a);h=h.map(function(a){return void 0!==
a?this.stack.pop():a},a);a.Ub[f].ja.forEach(function(a,b){0>a.size&&(l[b].Hh=h[-a.size])},a);var q=l.map(function(a){return this.Ic.slice(a.p,a.p+a.Hh)},a);e=!1;a.w&&(e=a.w(a.Ub[f].name,a,q));e||a.Ub[f].Fa(a,q);l.forEach(function(a,b){Sj(this,a.p,q[b])},a);break;case 13:a.stack.push(a.b+1);a.b=f-1;break;case 14:a.b=a.stack.pop()-1;break;case 15:throw"op 0x"+e.toString(16)+" (reserved) not implemented";default:b(e)}a.b++}Rj.prototype.nc=function(){for(;this.i&&(Vj(this),!this.l););};function qh(a){function c(a){a&=65535;return 32768<=a?a-65536:a}Rj.call(this,{xe:a,Na:[{name:"_id",Z:[0]},{name:"event.source",Z:[0]},{name:"event.args",Z:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"_fwversion",Z:[0,0]},{name:"_productId",Z:[0]},{name:"buttons._raw",Z:[0,0,0,0,0]},{name:"button.backward",Z:[0]},{name:"button.left",Z:[0]},{name:"button.center",Z:[0]},{name:"button.forward",Z:[0]},{name:"button.right",Z:[0]},{name:"buttons._mean",Z:[0,0,0,0,0]},{name:"buttons._noise",
Z:[0,0,0,0,0]},{name:"prox.horizontal",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx._payloads",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx._intensities",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx",Z:[0]},{name:"prox.comm.tx",Z:[0]},{name:"prox.ground.ambiant",Z:[0,0]},{name:"prox.ground.reflected",Z:[0,0]},{name:"prox.ground.delta",Z:[0,0]},{name:"motor.left.target",Z:[0]},{name:"motor.right.target",Z:[0]},{name:"_vbat",Z:[0,0]},{name:"_imot",Z:[0,0]},{name:"motor.left.speed",Z:[0]},{name:"motor.right.speed",Z:[0]},
{name:"motor.left.pwm",Z:[0]},{name:"motor.right.pwm",Z:[0]},{name:"_integrator",Z:[0,0]},{name:"acc",Z:[0,0,0]},{name:"leds.top",Z:[0,0,0]},{name:"leds.bottom.left",Z:[0,0,0]},{name:"leds.bottom.right",Z:[0,0,0]},{name:"leds.circle",Z:[0,0,0,0,0,0,0,0]},{name:"temperature",Z:[0]},{name:"rc5.address",Z:[0]},{name:"rc5.command",Z:[0]},{name:"mic.intensity",Z:[0]},{name:"mic.threshold",Z:[0]},{name:"mic._mean",Z:[0]},{name:"timer.period",Z:[0,0]},{name:"acc._tap",Z:[0]},{name:"sd.present",Z:[0]}],Pc:[{name:"button.backward",
description:"Backward button state changed"},{name:"button.left",description:"Left button state changed"},{name:"button.center",description:"Center button state changed"},{name:"button.forward",description:"Forward button state changed"},{name:"button.right",description:"Right button state changed"},{name:"buttons",description:"Buttons values updated"},{name:"prox",description:"Proximity values updated"},{name:"prox.comm",description:"Data received on the proximity communication"},{name:"tap",description:"Tap detected"},
{name:"acc",description:"Accelerometer values updated"},{name:"mic",description:"Microphone above threshold"},{name:"sound.finished",description:"Sound playback finished"},{name:"temperature",description:"Temperature value updated"},{name:"rc5",description:"RC5 message received"},{name:"motor",description:"Motor timer"},{name:"timer0",description:"Timer 0"},{name:"timer1",description:"Timer 1"}],Ub:[{name:"_system_reboot",ja:[],Fa:function(){}},{name:"_system_settings_read",ja:[],Fa:function(){}},
{name:"_system_settings_write",ja:[],Fa:function(){}},{name:"_system_settings_flash",ja:[],Fa:function(){}},{name:"math.copy",ja:[],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=c[1][a]}},{name:"math.fill",ja:[],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=c[1][0]}},{name:"math.addscalar",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=c(d[1][a]+d[2][0])}},{name:"math.add",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",
size:-1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=c(d[1][a]+d[2][a])}},{name:"math.sub",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=c(d[1][a]-d[2][a])}},{name:"math.mul",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=c(d[1][a]*d[2][a])}},{name:"math.div",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=
c(Math.trunc(d[1][a]/d[2][a]))}},{name:"math.min",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=Math.min(c[1][a],c[2][a])}},{name:"math.max",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=Math.max(c[1][a],c[2][a])}},{name:"math.clamp",ja:[{name:"r",size:-1},{name:"x",size:-1},{name:"low",size:-1},{name:"high",size:-1}],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=
Math.min(Math.max(c[1][a],c[2][a]),c[3][a])}},{name:"math.dot",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1},{name:"shift",size:1}],Fa:function(a,c){for(var b=a=0;b<c[0].length;b++)a+=c[1][b]*c[2][b];c[0][0]=a/Math.pow(2,c[3][0])}},{name:"math.stat",ja:[{name:"x",size:-1},{name:"min",size:1},{name:"max",size:1},{name:"mean",size:1}],Fa:function(a,c){a=0;c[1][0]=32767;c[2][0]=-32768;for(var b=0;b<c[0].length;b++)c[1][0]=Math.min(c[1][0],c[0][b]),c[2][0]=Math.max(c[2][0],c[0][b]),a+=
c[0][b];c[3][0]=a/c[0].length}},{name:"math.argbounds",ja:[{name:"x",size:-1},{name:"argmin",size:1},{name:"argmax",size:1}],Fa:function(a,c){a=-Infinity;for(var b=Infinity,d=0;d<c[0].length;d++)c[0][d]<b&&(b=c[0][d],c[1][0]=d),c[0][d]>a&&(a=c[0][d],c[2][0]=d)}},{name:"math.sort",ja:[{name:"x",size:-1}],Fa:function(a,c){c[0].sort(function(a,b){return a-b})}},{name:"math.muldiv",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1},{name:"c",size:-1}],Fa:function(a,d){for(a=0;a<d[0].length;a++)d[0][a]=
c(d[1][a]*d[2][a]/d[3][a])}},{name:"math.atan2",description:"Atan2",ja:[{name:"r",size:-1},{name:"y",size:-1},{name:"x",size:-1}],Fa:function(a,c){c[2].forEach(function(a,b){c[0][b]=Math.round(32767*Math.atan2(c[1][b],a)/Math.PI)})}},{name:"math.sin",description:"Sine",ja:[{name:"r",size:-1},{name:"theta",size:-1}],Fa:function(a,c){c[1].forEach(function(a,b){c[0][b]=Math.round(32767*Math.sin(a*Math.PI/32768))})}},{name:"math.cos",description:"Cosine",ja:[{name:"r",size:-1},{name:"theta",size:-1}],
Fa:function(a,c){c[1].forEach(function(a,b){c[0][b]=Math.round(32767*Math.cos(a*Math.PI/32768))})}},{name:"math.rot2",ja:[{name:"r",size:2},{name:"v",size:2},{name:"theta",size:1}]},{name:"math.sqrt",description:"Square root",ja:[{name:"r",size:-1},{name:"x",size:-1}],Fa:function(a,c){c[1].forEach(function(a,b){c[0][b]=0<a?Math.floor(Math.sqrt(a)):0})}},{name:"math.rand",description:"Pseudo-random number",ja:[{name:"r",size:-1}],Fa:function(a,c){for(a=0;a<c[0].length;a++)c[0][a]=Math.floor(65535.9999*
Math.random())-32768}},{name:"_leds.set",ja:[{name:"led",size:1},{name:"br",size:1}],Fa:function(){}},{name:"sound.record",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.play",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.replay",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.system",description:"Start playing system sound",ja:[{name:"n",size:1}],Fa:function(){}},{name:"leds.circle",description:"Set circular leds",ja:[{name:"l0",size:1},{name:"l1",size:1},{name:"l2",size:1},{name:"l3",
size:1},{name:"l4",size:1},{name:"l5",size:1},{name:"l6",size:1},{name:"l7",size:1}],Fa:function(a,c){a.state["leds.circle"]=c.map(function(a){return a[0]});a.Hd&&a.Hd("leds.circle")}},{name:"leds.top",description:"Set top RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],Fa:function(a,c){a.state["leds.top"]=c.map(function(a){return a[0]});a.Hd&&a.Hd("leds.top")}},{name:"leds.bottom.left",description:"Set bottom-left RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],
Fa:function(a,c){a.state["leds.bottom.left"]=c.map(function(a){return a[0]});a.Hd&&a.Hd("leds.bottom.left")}},{name:"leds.bottom.right",description:"Set bottom-right RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],Fa:function(a,c){a.state["leds.bottom.right"]=c.map(function(a){return a[0]});a.Hd&&a.Hd("leds.bottom.right")}},{name:"sound.freq",description:"Play frequency",ja:[{name:"Hz",size:1},{name:"ds",size:1}],Fa:function(a,c){console.info(c)}},{name:"leds.buttons",description:"Set buttons leds",
ja:[{name:"led 0",size:1},{name:"led 1",size:1},{name:"led 2",size:1},{name:"led 3",size:1}]},{name:"leds.prox.h",description:"Set horizontal proximity leds",ja:[{name:"led 0",size:1},{name:"led 1",size:1},{name:"led 2",size:1},{name:"led 3",size:1},{name:"led 4",size:1},{name:"led 5",size:1},{name:"led 6",size:1},{name:"led 7",size:1}]},{name:"leds.prox.v",description:"Set vertical proximity leds",ja:[{name:"led 0",size:1},{name:"led 1",size:1}]},{name:"leds.rc",description:"Set rc led",ja:[{name:"led",
size:1}]},{name:"leds.sound",description:"Set sound led",ja:[{name:"led",size:1}]},{name:"leds.temperature",description:"Set ntc led",ja:[{name:"red",size:1},{name:"blue",size:1}]},{name:"sound.wave",description:"Set the primary wave of the tone generator",ja:[{name:"wave",size:142}],Fa:function(){}},{name:"prox.comm.enable",description:"Enable or disable the proximity communication",ja:[{name:"state",size:1}]},{name:"sd.open",description:"Open a file on the SD card",ja:[{name:"number",size:1},{name:"status",
size:1}]},{name:"sd.write",description:"Write data to the opened file",ja:[{name:"data",size:-1},{name:"written",size:1}]},{name:"sd.read",description:"Read data from the opened file",ja:[{name:"data",size:-1},{name:"read",size:1}]},{name:"sd.seek",description:"Seek the opened file",ja:[{name:"position",size:1},{name:"status",size:1}]},{name:"_rf.nodeid"},{name:"_poweroff"}],Pd:620});this.state={};this.Hd=null}qh.prototype=Object.create(Rj.prototype);qh.prototype.constructor=qh;function Wj(){O.call(this);this.Jb=!0;this.w=new qh(9999);var a=this;this.w.Hd=function(c){a.S[c]&&a.S[c](c,a.w.state[c])};this.w.H=function(c,b,d,e,f){switch(c){case "leds.circle":e=f.slice();e[b]=d;a.S[c]&&a.S[c](c,e);break;case "timer.period":a.setTimer(b,"timer"+b.toString(10),.001*d,!0)}};this.w.w=function(c,b,d){switch(c){case "sound.play":return a.S.sound("sound",{pcm:d[0][0]}),!0}return!1};this.Aa=new Jb(Kb)}Wj.prototype=Object.create(O.prototype);Wj.prototype.constructor=Wj;
Wj.prototype.reset=function(a){O.prototype.reset.call(this,a);Uj(this.w);this.setTimer(20,"prox",.1,!0);this.setTimer(21,"acc",.0625,!0);this.setTimer(22,"buttons",.05,!0);this.setTimer(23,"temperature",1,!0)};function Xj(a,c){c=zh(a.Aa,c);return null==c?null:a.w.Ic.slice(c.offset,c.offset+c.size)}function Yj(a,c,b){var d=zh(a.Aa,c);if(null==d)throw"Unknown VM variable "+c;if(b.length!==d.size)throw"Bad size for variable "+c;Array.prototype.splice.apply(a.w.Ic,[d.offset,d.size].concat(b))}
Wj.prototype.set=function(a,c){if(this.Jb){O.prototype.set.call(this,a,c);switch(a){case "button.backward":case "button.left":case "button.center":case "button.forward":case "button.right":Yj(this,a,[c?1:0]);break;case "prox.ground.delta":Yj(this,"prox.ground.delta",c.map(function(a){return 2E3*a}));break;case "prox.horizontal":Yj(this,"prox.horizontal",c.map(function(a){return 4E3*a}));break;case "acc":Yj(this,"acc",c.map(function(a){return 22*a}));break;default:throw"Unknown variable "+a;}this.S[a]&&
this.S[a](a,c)}else O.prototype.set.call(this,a,c)};
Wj.prototype.get=function(a){if(this.Jb)switch(a){case "leds.top":return Xj(this,"leds.top").map(function(a){return 32<=a?1:0>=a?0:a/32});case "leds.bottom.left":return Xj(this,"leds.bottom.left").map(function(a){return 32<=a?1:0>=a?0:a/32});case "leds.bottom.right":return Xj(this,"leds.bottom.right").map(function(a){return 32<=a?1:0>=a?0:a/32});case "leds.circle":return Xj(this,"leds.circle").map(function(a){return 16<=a?1:0});case "motor.left":return Xj(this,"motor.left.target")[0]/200;case "motor.right":return Xj(this,
"motor.right.target")[0]/200;default:return O.prototype.get.call(this,a)}else return O.prototype.get.call(this,a)};Wj.prototype.sendEvent=function(a,c){if(this.Jb){if(null!=c)throw"Event arguments not implemented";a=Ah(this.Aa,a);Tj(this.w,a);Zj(this)}else O.prototype.sendEvent.call(this,a,c)};
Wj.prototype.loadCode=function(a,c){"js"===a?(O.prototype.loadCode.call(this,a,c),this.Jb=!1):("asm"===a?(c=new ph(this.Aa,c),c=oh(c)):(c=(a=mj(c))?new mh(this.Aa,c):new Lb(this.Aa,c),c.S=a?nh:Mb,c=Nb(c)),a=this.w,a.P.splice.apply(a.P,[0,c.length].concat(c)),Uj(this.w),Zj(this),this.Jb=!0)};function Zj(a){for(var c=0;2E3>c&&a.w.i;c++)Vj(a.w)};function Xg(a,c){a.b=new Xb(a.Jb,{ia:a.ia});a.b.Za=function(){null!==a.H&&(a.H=null,ak(a))};var b=null;return new sg({nc:function(c,e){var d=a.M;d.ka.loadCode(c,e);null!==b&&clearInterval(b);d.ka.start(bk());b=setInterval(function(){d.ka.run(bk(),function(a,b){ck(d,a,b)})},10);d.ka.Uc=d.paused;ak(a)},wc:function(){var b=new Wj;b=new dk(a.b,b);c&&c.dh&&Ke(a.b,c.dh);c&&c.eh&&(a.b.transform=c.eh);a.M=b},getName:function(){return"Simulator"},fd:"js",languages:["js","aseba","l2","asm"]})};function ek(){this.b=[]}ek.prototype.add=function(a){this.b.push(a)};ek.prototype.J=function(a){this.b.forEach(function(c){c.J(a)})};function fk(){}fk.prototype.b=function(){throw"internal";};fk.prototype.J=function(){};function gk(a,c,b){this.x=a;this.y=c;this.i=b}gk.prototype=Object.create(fk.prototype);gk.prototype.constructor=gk;
gk.prototype.b=function(a,c,b){for(var d=Infinity,e=this.x.length,f=0;f<(this.i?this.x.length:this.x.length-1);f++){var g=this.x[(f+1)%e],k=this.y[(f+1)%e],l=[Math.cos(b),g-this.x[f],Math.sin(b),k-this.y[f]];g=[g-a,k-c];k=l[0]*l[3]-l[1]*l[2];l=[(l[3]*g[0]-l[1]*g[1])/k,(l[0]*g[1]-l[2]*g[0])/k];d=Math.min(d,0<=l[1]&&1>=l[1]&&0<l[0]?l[0]:Infinity)}return d};
gk.prototype.J=function(a){a.save();a.beginPath();a.moveTo(this.x[0],this.y[0]);for(var c=1;c<this.x.length;c++)a.lineTo(this.x[c],this.y[c]);this.i&&a.closePath();a.stroke();a.restore()};function hk(a,c,b){this.x=a;this.y=c;this.r=b}hk.prototype=Object.create(fk.prototype);hk.prototype.constructor=hk;
hk.prototype.b=function(a,c,b){var d=(this.x-a)*Math.cos(b)+(this.y-c)*Math.sin(b);a=(a-this.x)*Math.sin(b)+(this.y-c)*Math.cos(b);a=this.r*this.r-a*a;if(0>a)return Infinity;a=Math.sqrt(a);return 0>d+a?Infinity:0>d-a?d+a:d-a};hk.prototype.J=function(a){a.save();a.beginPath();a.arc(this.x,this.y,this.r,0,2*Math.PI);a.stroke();a.restore()};function ik(a,c){this.width=a;this.height=c}
function dk(a,c){var b=this;this.W=new Ra;this.ka=c;this.S=this.cg=this.paused=this.Ye=!1;this.Mc=jk;this.b=new ik(10*this.ka.rb,7.07*this.ka.rb);c=this.ka.rb;this.ka.setPositionLimits(-this.b.width/2+c,this.b.width/2-c,-this.b.height/2+c,this.b.height/2-c);this.Of=this.uc=null;this.i=document.createElement("canvas");this.u=document.createElement("canvas");this.xg=!1;this.Pf=this.Rb=null;this.l=document.createElement("canvas");this.w=new ek;this.Qe=!1;this.Qf=this.ca=null;kk(this);this.ka.Za=function(){lk(b);
mk(b);nk(b)};this.H=a;this.H.state={};this.ma=!1}var jk="ground";dk.prototype.We=function(){this.W.b=[]};function ok(a){var c=a.u.getContext("2d");c.filter="blur("+(a.u.width/300).toFixed(1)+"px)";c.fillStyle="white";c.fillRect(0,0,a.u.width,a.u.height);c.drawImage(a.i,0,0)}
function pk(a){var c=a.M;if(c.uc){c.i.width=c.uc.width;c.i.height=c.uc.height;var b=c.i.getContext("2d");b.fillStyle="white";b.fillRect(0,0,c.uc.width,c.uc.height);b.drawImage(c.uc,0,0,c.uc.width,c.uc.height)}else c.i.width=c.H?c.H.width:800,c.i.height=c.i.width*c.b.height/c.b.width,b=c.i.getContext("2d"),b.fillStyle="white",b.fillRect(0,0,c.i.width,c.i.height);c.u.width=c.i.width;c.u.height=c.i.height;c.xg=!1;ok(c);Cc(a)}
function ck(a,c,b){if(a.cg){var d=a.i.getContext("2d");d.save();d.translate(a.i.width/2,a.i.height/2);d.scale(a.i.width/a.b.width,-a.i.height/a.b.height);d.beginPath();switch(c){case "l":d.moveTo(b[0],b[1]);d.lineTo(b[2],b[3]);break;case "a":d.arc(b[0],b[1],Math.abs(b[2]),b[3],b[4],0>b[2])}d.strokeStyle="#060";d.lineCap="round";d.lineWidth=.1*a.ka.rb;d.stroke();d.restore();a.xg=!0;ok(a)}}
function kk(a){a.w.b=[];a.w.add(new gk([-a.b.width/2,a.b.width/2,a.b.width/2,-a.b.width/2],[-a.b.height/2,-a.b.height/2,a.b.height/2,a.b.height/2],!0))}
function qk(a,c){var b=a.M;kk(b);if(b.ca=c){var d=new zf(c),e=b.b.width/d.D[2],f=-b.b.width*(.5+d.D[0]/d.D[2]),g=-b.b.height/d.D[3],k=b.b.height*(.5+d.D[1]/d.D[3]);d.J(null,{Ea:{line:function(a,c,d){b.w.add(new gk(a.map(function(a){return f+e*a}),c.map(function(a){return k+g*a}),d))},Kf:function(a,c,d){b.w.add(new hk(f+e*a,k+g*c,(e-g)/2*d))}}})}b.Qe=null!=c;mk(b);Cc(a)}
function rk(a,c,b){c=Math.round(a.u.width*(c+a.b.width/2)/a.b.width);b=Math.round(a.u.height*(a.b.height/2-b)/a.b.height);return a.u.getContext("2d").getImageData(c,b,1,1).data[0]/255}function sk(a,c,b){if(null==a.Rb)return 0;c=Math.round(a.l.width*(c+a.b.width/2)/a.b.width);b=Math.round(a.l.height*(a.b.height/2-b)/a.b.height);a=a.l.getContext("2d").getImageData(c,b,1,1).data;return-(a[0]+a[1]+a[2])/765}
function lk(a){for(var c=[],b=0;2>b;b++)c.push(rk(a,a.ka.b[0]+a.ka.tc*Math.cos(a.ka.i)+(0===b?-1:1)*a.ka.Ad*Math.sin(a.ka.i),a.ka.b[1]+a.ka.tc*Math.sin(a.ka.i)-(0===b?-1:1)*a.ka.Ad*Math.cos(a.ka.i))+sh(a.ka,.05));a.ka.set("prox.ground.delta",c)}
function mk(a){var c=Math.cos(a.ka.i),b=Math.sin(a.ka.i),d=[{be:70,ae:60,kb:.7},{be:85,ae:30,kb:.35},{be:95,ae:0,kb:0},{be:85,ae:-30,kb:-.35},{be:70,ae:-60,kb:-.7},{be:-25,ae:35,kb:2.8},{be:-25,ae:-35,kb:-2.8}].map(function(a){var d=this.w,e=this.ka.b[0]+a.be*c-a.ae*b,k=this.ka.b[1]+a.be*b+a.ae*c;a=this.ka.i+a.kb;for(var l=Infinity,h=0;h<d.b.length;h++)l=Math.min(l,d.b[h].b(e,k,a));d=l+sh(this.ka,.01*this.ka.r);return 100>d?1:300<d?0:(d-300)*(d-300)/4E4},a);a.ka.set("prox.horizontal",d)}
function nk(a){for(var c=[0,0,a.ka.r],b=[-a.ka.r,a.ka.r,0],d=[],e=0;3>e;e++)d.push(sk(a,a.ka.b[0]+c[e]*Math.cos(a.ka.i)+b[e]*Math.sin(a.ka.i),a.ka.b[1]+c[e]*Math.sin(a.ka.i)-b[e]*Math.cos(a.ka.i)));c=200*(d[1]-d[0])/(2*a.ka.r);d=200*(d[2]-(d[0]+d[1])/2)/a.ka.tc;a.ka.set("acc",[c+sh(a.ka,.02),d+sh(a.ka,.02),Math.sqrt(1-c*c-d*d)+sh(a.ka,.02)])}
function Gg(a,c,b){switch(b||a.M.Mc){case jk:a.M.Of=null==c?a.M.uc:null;a.M.uc=c;pk(a);lk(a.M);Cc(a);break;case "height":a.M.Pf=null==c?a.M.Rb:null,b=a.M,b.Rb=c,b.Rb?(b.l.width=b.Rb.width,b.l.height=b.Rb.height,c=b.l.getContext("2d"),c.fillStyle="white",c.fillRect(0,0,b.Rb.width,b.Rb.height),c.drawImage(b.Rb,0,0,b.Rb.width,b.Rb.height)):(b.l.width=1,b.l.height=1),nk(b),Cc(a)}}function Fg(a,c,b){switch(b||a.M.Mc){case "obstacle":a.M.Qf=null==c?a.M.ca:null,qk(a,c)}}
Ub.prototype.start=function(a){this.M.paused=a;this.M.Ye=!a;Cc(this)};function tk(a){a=[a[0],Math.max(.2+.8*a[1],a[2]/2),a[2]];var c=Math.max(a[0],Math.max(a[1],a[2]));return"rgb("+a.map(function(a){return Math.round(225*(1-c)+(30+225*c)*a)}).join(",")+")"}function uk(a){return function(c){a.H!==c&&(a.H=c,ak(a))}}function fg(a,c,b,d,e){var f=new Uc(a.b);ld(f,a,c,["sim","top"],a.M.he||sc,a.M.bf||gd);Wc(f,b,e,d);return f}
function Cc(a){function c(a){return function(){d.H!==a&&(d.H=a,ak(d))}}function b(a,b,c,f){var h=(e.bf||gd)(a,g.A);c=Math.min(c.width/(h.oa-h.Y),c.height/(h.pa-h.ba));b.save();b.translate(-h.Y,-h.ba);b.scale(c,c);(e.he||sc)(d,a,b,g.A,g.ia,["sim","event"],null,!0,!1,f);b.restore()}var d=a,e=a.M,f=e.ka,g=a.b;if(g.S){e.ma||(e.ma=!0,e.resize(a),pk(a));g.ob=[];var k=e.Mg||a.Za,l=wc(a,k,["sim","top"]),h=nd(l),q=Qd(g);Pd(g);var p=N(g.ia,{tag:"view",ga:["sim"]}),t=N(g.ia,{tag:"button",ga:["sim","event"]}),
u=N(g.ia,{tag:"sim-controller"}),w=N(g.ia,{tag:"separator",id:"sim-controller-separator"}),m=N(g.ia,{tag:"separator",ga:["sim","top"]}),n=N(g.ia,{tag:"toolbar",ga:["sim","top"]}),E=N(g.ia,{tag:"sim-playground-area"}),r=N(g.ia,{tag:"sim-playground"});p.Tc(q.width);p.Dc(q.height);p.setPosition(0,0);var v=Math.max(t.width,t.height);u.width=3*L(t);u.Dc(p.height);u.setPosition(p.x+p.width-L(u),p.y);n.Tc(p.width-L(u));n.height=h;n.setPosition(p.x,p.y);E.Tc(p.width-L(u));E.Dc(p.height-n.ra());E.setPosition(p.x,
p.y+n.ra());Yc(g,function(a){p.J(a)});Xc(fg(a,k,n,m,l),n,l,uk(a));Yc(g,function(a){u.J(a)});k=[];l=u.y+t.offsetTop();k.push($c(g,u.x+L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:forward",a,c,d)},{oe:function(){f.set("button.forward",!0);f.sendEvent("button.forward",null)},pe:function(){f.set("button.forward",!1);f.sendEvent("button.forward",null)},zc:c("sim:btn-button.forward")},"button.forward"));l+=t.ra();k.push($c(g,u.x+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:left",a,c,d)},{oe:function(){f.set("button.left",
!0);f.sendEvent("button.left",null)},pe:function(){f.set("button.left",!1);f.sendEvent("button.left",null)},zc:c("sim:btn-button.left")},"button.left"));k.push($c(g,u.x+L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:center",a,c,d)},{oe:function(){f.set("button.center",!0);f.sendEvent("button.center",null)},pe:function(){f.set("button.center",!1);f.sendEvent("button.center",null)},zc:c("sim:btn-button.center")},"button.center"));k.push($c(g,u.x+2*L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:right",
a,c,d)},{oe:function(){f.set("button.center",!0);f.sendEvent("button.center",null)},pe:function(){f.set("button.center",!1);f.sendEvent("button.center",null)},zc:c("sim:btn-button.right")},"button.right"));l+=t.ra();k.push($c(g,u.x+L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:backward",a,c,d)},{oe:function(){f.set("button.backward",!0);f.sendEvent("button.backward",null)},pe:function(){f.set("button.backward",!1);f.sendEvent("button.backward",null)},zc:c("sim:btn-button.backward")},"button.backward"));
l+=t.ra()+w.ra();k.push($c(g,u.x+.5*L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:tap",a,c,d)},{action:function(){f.sendEvent("tap",null)},zc:c("sim:btn-tap")},"tap"));k.push($c(g,u.x+1.5*L(t)+t.offsetLeft(),l,t,function(a,c,d){b("sim-event:clap",a,c,d)},{action:function(){f.sendEvent("mic",null)},zc:c("sim:btn-clap")},"clap"));l+=2*v;var C=u.x+1.5*L(t),R=l+3.5*v;k.push(Yc(g,function(a){function b(b,c,d,e,f,g){function h(b,c){a.beginPath();a.arc(0,0,b,0,2*Math.PI);a.fillStyle=c;a.fill()}a.save();
a.translate(b,c);h(d,g||"#222");h(.95*d,f||"#bbb");h(.95*d*e,g||"#222");a.restore()}a.save();a.beginPath();a.moveTo(C-1.2*v,R);a.lineTo(C-1.2*v,R-1.8*v);a.bezierCurveTo(C-.72*v,R-2.4*v,C-.05*v,R-2.4*v,C,R-2.4*v);a.bezierCurveTo(C+.05*v,R-2.4*v,C+.72*v,R-2.4*v,C+1.2*v,R-1.8*v);a.lineTo(C+1.2*v,R);a.closePath();a.lineWidth=2;a.strokeStyle="black";a.stroke();var c=f.get("prox.ground.delta");b(C-.45*v,R-1.8*v,.4*v,c[0],"#afa","#060");b(C+.45*v,R-1.8*v,.4*v,c[1],"#9f9","#060");c=f.get("prox.horizontal");
b(C-1.45*v,R-2.3*v,.4*v,c[0],"#fcc","#d00");b(C-.8*v,R-2.8*v,.4*v,c[1],"#fcc","#d00");b(C,R-3*v,.4*v,c[2],"#fcc","#d00");b(C+.8*v,R-2.8*v,.4*v,c[3],"#fcc","#d00");b(C+1.45*v,R-2.3*v,.4*v,c[4],"#fcc","#d00");b(C-.8*v,R+.5*v,.4*v,c[5],"#fcc","#d00");b(C+.8*v,R+.5*v,.4*v,c[6],"#fcc","#d00");a.restore()}));var S=l+=5*v;k.push(Yc(g,function(a){function b(b,c,d,e){e=Math.max(-1,Math.min(1,e));a.save();a.translate(b,c);a.beginPath();a.arc(0,0,d,0,2*Math.PI);a.fillStyle="#ccc";a.fill();a.beginPath();a.moveTo(0,
0);a.lineTo(d*Math.sin(3*e),-d*Math.cos(3*e));a.lineWidth=Math.max(d/6,1);a.strokeStyle="black";a.stroke();a.restore()}a.save();a.fillStyle="black";a.fillRect(C-1.15*v,S+.5*v,.3*v,.6*v);a.fillRect(C+.85*v,S+.5*v,.3*v,.6*v);a.fillStyle=tk(f.get("leds.top"));a.fillRect(C-1.2*v,S,2.4*v,.5*v);a.fillStyle=tk(f.get("leds.bottom.left"));a.fillRect(C-1.2*v,S+.5*v,1.2*v,.5*v);a.fillStyle=tk(f.get("leds.bottom.right"));a.fillRect(C,S+.5*v,1.2*v,.5*v);a.lineWidth=1;a.beginPath();a.moveTo(C-1.2*v,S+.5*v);a.lineTo(C+
1.2*v,S+.5*v);a.moveTo(C,S+.5*v);a.lineTo(C,S+v);a.strokeStyle="white";a.stroke();a.lineJoin="round";a.strokeStyle="black";a.strokeRect(C-1.2*v,S,2.4*v,v);b(C-1.7*v,S+v,.4*v,f.get("motor.left")/2);b(C+1.7*v,S+v,.4*v,f.get("motor.right")/2);a.restore()}));l+=1.5*v;if(null!=e.Rb){var Ga=l+1.5*v;k.push(Yc(g,function(a){var b=f.get("acc");b=[Math.atan2(b[0],b[1]),Math.atan2(b[1],b[2]),Math.atan2(b[0],b[2])];a.save();a.strokeStyle="black";a.lineWidth=.7*g.A.ua;for(var c=0;3>c;c++){a.save();a.translate(C+
(c-1)*v,Ga);a.save();a.strokeStyle="silver";a.beginPath();a.moveTo(-.4*v,0);a.lineTo(.4*v,0);a.moveTo(0,-.4*v);a.lineTo(0,.4*v);a.stroke();a.restore();a.rotate(-b[c]);switch(c){case 0:var d=.25*v;a.translate(0,1.2*d);a.beginPath();a.moveTo(-1.2*d,0);a.lineTo(-1.2*d,-1.8*d);a.bezierCurveTo(-.72*d,-2.4*d,-.05*d,-2.4*d,0,-2.4*d);a.bezierCurveTo(.05*d,-2.4*d,.72*d,-2.4*d,1.2*d,-1.8*d);a.lineTo(1.2*d,0);a.closePath();a.lineWidth=2;a.strokeStyle="black";a.stroke();break;case 1:a.strokeRect(-.4*v,-.15*v,
.8*v,.3*v);a.beginPath();a.arc(-.2*v,.05*v,.15*v,0,2*Math.PI);a.fillStyle="white";a.fill();a.lineWidth=.07*v;a.stroke();break;case 2:a.strokeRect(-.4*v,-.15*v,.8*v,.3*v),a.fillStyle="black",a.fillRect(-.35*v,.15*v,.15*v,.08*v),a.fillRect(.2*v,.15*v,.15*v,.08*v)}a.restore()}a.restore()}));l+=2.5*v}if(f.Wc){var qa=l+2*v;k.push(Yc(g,function(a){for(var b=f.get("leds.circle"),c=0;8>c;c++)cf(a,C,qa,.9*v,1.2*v,Math.PI*(.44-.25*c),Math.PI*(.56-.25*c),b[c]?"#fa0":"white","black",g.A.ua)}));l+=3.5*v}var za=
l+1.5*v,ma=f.getTimer(0);0<=ma?(k.push(Yc(g,function(a){g.state.af?"lin"===g.state.af&&4<ma&&(g.state.af="log"):g.state.af=4<ma?"log":"lin";$e(a,C,za,v,g.A.ua,function(b){a.textAlign="start";a.textBaseline="top";a.font=(v/2).toFixed(1)+"px sans-serif";a.fillStyle="black";a.fillText(b.toFixed(1),u.x,za-v)},Math.min(ma,"log"===g.state.af?9.9:3.95),!1,"log"===g.state.af)})),l+=2.5*v):g.state.af=!1;var P=Math.min((E.y-u.y+u.y+u.height-l)/2,u.y+u.height-l);0<P&&k.forEach(function(a){a.y+=P});var Q=E.x,
Aa=E.y,Oa=E.width,z=E.height;var T=Math.min(Oa/e.b.width,z/e.b.height);t=(Oa-e.b.width*T)/2;w=(z-e.b.height*T)/2;r.width=e.b.width*T;r.height=e.b.height*T;r.x=Q+t;r.y=Aa+w;if(a.W.hc){var M=N(g.ia,{tag:"widget",id:"vpl-customize"});Yc(g,function(){Hd(g,"vpl:customize",Q+Oa/2,Aa+z/2,M)})}else{var K=f.rb,Ma=!1;t=new ud(null,e.b.width*T,e.b.height*T,Q+t,Aa+w,function(a,b,c,h){a=a.N;a.save();E.J(a);r.J(a);if(null===d.wd)switch(e.Mc){case jk:a.drawImage(e.i,b.x+c,b.y+h,b.width,b.height);break;case "height":null!=
e.Rb&&a.drawImage(e.l,b.x+c,b.y+h,b.width,b.height);break;case "obstacle":a.save(),a.translate(b.x+c+b.width/2,b.y+h+b.height/2),a.scale(T,-T),e.w.J(a),a.restore()}else a.drawImage(e.i,b.x+c,b.y+h,b.width,b.height),null!=e.Rb&&(a.save(),a.globalAlpha=.5,a.drawImage(e.l,b.x+c,b.y+h,b.width,b.height),a.restore()),e.Qe&&(a.save(),a.translate(b.x+c+b.width/2,b.y+h+b.height/2),a.scale(T,-T),e.w.J(a),a.restore());a.translate(b.x+c+b.width/2,b.y+h+b.height/2);a.scale(T,T);a.translate(f.b[0],-f.b[1]);a.rotate(.5*
Math.PI-f.i);a.beginPath();a.moveTo(0,.2*K);a.lineTo(.5*K,.2*K);a.lineTo(.5*K,-.55*K);a.bezierCurveTo(.3*K,-.8*K,.02*K,-.8*K,0,-.8*K);a.bezierCurveTo(-.02*K,-.8*K,-.3*K,-.8*K,-.5*K,-.55*K);a.lineTo(-.5*K,.2*K);a.closePath();a.fillStyle=tk(f.get("leds.top"));a.strokeStyle="black";a.lineJoin="round";a.lineWidth=2;a.moveTo(.05*K,0);a.arc(0,0,.05*K,0,2*Math.PI);a.fill();a.stroke();if(!e.Ye||e.paused)a.beginPath(),a.arc(0,0,K,0,2*Math.PI),a.strokeStyle=g.state.rh?"navy":"#3cf",a.lineWidth=.1*K,a.stroke(),
a.beginPath(),a.arc(0,-K,.15*K,0,2*Math.PI),a.fillStyle=g.state.Cg?"navy":"white",a.strokeStyle=g.state.Cg?"navy":"#3cf",a.lineWidth=.06*K,a.fill(),a.stroke();a.restore()},{fa:function(a,b,c,d,h,k,l){a=(l.x-h-c/2)/T;d=(d/2-(l.y-k))/T;k=a-f.b[0];l=d-f.b[1];b=K*Math.cos(f.i);c=K*Math.sin(f.i);return(!e.Ye||e.paused)&&(k-b)*(k-b)+(l-c)*(l-c)<.1*K*K?(g.state.x=a,g.state.y=d,g.state.Cg=!0,1):k*k+l*l<K*K?(e.paused?Ma=!1:(f.suspend(),Ma=!0),g.state.x=a,g.state.y=d,g.state.rh=!0,0):null},Qa:function(a,b,
c,d,h,k,l,m){a=(m.x-k-d/2)/T;h=(h/2-(m.y-l))/T;switch(c){case 0:c=f.b;f.setPosition([f.b[0]+a-g.state.x,f.b[1]+h-g.state.y],f.i);ck(e,"l",[c[0],c[1],f.b[0],f.b[1]]);break;case 1:f.setPosition(f.b,f.i+(Math.atan2(h-f.b[1],a-f.b[0])-Math.atan2(g.state.y-f.b[1],g.state.x-f.b[0])))}g.state.x=a;g.state.y=h},dd:function(){g.state.rh=!1;g.state.Cg=!1;Ma&&f.resume(bk())}});t.l=!1;Ad(g,t)}a.H&&Yc(g,function(a){var b=N(g.ia,{tag:"hint"});a.fillStyle=b.color;a.font=bd(b);a.textAlign="start";a.textBaseline="middle";
var c=d.i.translate(d.H);b.width=a.measureText(c).width;b.height=1.2*b.fontSize;Zc(b,a,b.marginLeft,q.height-b.ra()+b.marginTop,!0);a.fillText(c,b.offsetLeft(),q.height-b.ra()+b.offsetTop()+b.height/2)});J(g);!e.paused&&f.shouldRunContinuously()&&ak(a)}}function ak(a){a.M.S||(a.M.S=!0,window.requestAnimationFrame(function(){a.M.S=!1;Cc(a)}))}function bk(){return.001*(new Date).getTime()}
dk.prototype.resize=function(a){var c=window.innerWidth,b=window.innerHeight;window.vplDisableResize&&(b=this.H.b.getBoundingClientRect(),c=b.width,b=b.height);this.H.A=this.H.A;this.H.resize(c,b);Cc(a)};function kh(a){a.I.add("sim:close",{action:function(a){a.qb(["sim"],{Nf:!0})},object:a,$:function(a){return 1<a.Ka.length&&0<=a.Ka.indexOf("sim")}});a.I.add("sim:restart",{action:function(a){pk(a);a.M.ka.reset(bk());a.M.ka.start();a.M.Ye=!0;a.M.paused=!1;Cc(a)},object:a});a.I.add("sim:pause",{action:function(a){a.M.Ye&&(a.M.paused=!a.M.paused,a.M.paused?a.M.ka.suspend():(a.M.ka.resume(bk()),Cc(a)))},isEnabled:function(a){return a.M.Ye},Pa:function(a){return a.M.paused},object:a,lb:[{selected:!1},
{selected:!0}]});a.I.add("sim:speedup",{action:function(a){var b=[.5,1,2,5,10];a.M.ka.ee=b[(b.indexOf(a.M.ka.ee)+1)%b.length]},Pa:function(a){return 1!==a.M.ka.ee},getState:function(a){return a.M.ka.ee},object:a,lb:[{selected:!1,state:1},{selected:!0,state:.5},{selected:!0,state:2},{selected:!0,state:5},{selected:!0,state:10}]});a.I.add("sim:noise",{action:function(a){a.M.ka.Xf=!a.M.ka.Xf},Pa:function(a){return a.M.ka.Xf},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("sim:pen",{action:function(a){a.M.cg=
!a.M.cg},Pa:function(a){return a.M.cg},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("sim:clear",{action:function(a){pk(a)},isEnabled:function(a){return a.M.xg},object:a});a.I.add("sim:map-kind",{action:function(a){switch(a.M.Mc){case jk:a.M.Mc="height";break;case "height":a.M.Mc="obstacle";break;case "obstacle":a.M.Mc=jk}},getState:function(a){switch(a.M.Mc){case jk:return"ground";case "height":return"height";case "obstacle":return"obstacles";default:return"ground"}},object:a,lb:[{state:"ground"},
{state:"height"},{state:"obstacles"}],$:function(a){return null===a.wd}});a.I.add("sim:map",{action:function(a){switch(a.M.Mc){case jk:Gg(a,null==a.M.uc?a.M.Of:null);break;case "height":Gg(a,null==a.M.Rb?a.M.Pf:null);break;case "obstacle":Fg(a,a.M.Qe?null:a.M.Qf)}},Pa:function(a){switch(a.M.Mc){case jk:return null!=a.M.uc;case "height":return null!=a.M.Rb;case "obstacle":return a.M.Qe}throw"internal";},getState:function(a){switch(a.M.Mc){case jk:return"ground";case "height":return"height";case "obstacle":return"obstacles";
default:return"ground"}},object:a,lb:[{selected:!1,state:"ground"},{selected:!1,state:"height"},{selected:!1,state:"obstacles"},{selected:!0,state:"ground"},{selected:!0,state:"height"},{selected:!0,state:"obstacles"}],$:function(a){return null===a.wd}});a.I.add("sim:map-ground",{action:function(a,b){b?a.Te.show("Open ground image file",".gif,.png,.jpg,.svg",function(b){var c=new window.FileReader;c.onload=function(b){b=b.target.result;var c=new Image;c.addEventListener("load",function(){Gg(a,c,jk)});
c.src=b};c.readAsDataURL(b)}):Gg(a,null==a.M.uc?a.M.Of:null,jk)},Pa:function(a){return null!=a.M.uc},object:a,lb:[{selected:!1},{selected:!0}],$:function(a){return a.wd&&0<=a.wd.indexOf("ground")}});a.I.add("sim:map-height",{action:function(a,b){b?a.Te.show("Open height image file",".gif,.png,.jpg,.svg",function(b){var c=new window.FileReader;c.onload=function(b){b=b.target.result;var c=new Image;c.addEventListener("load",function(){Gg(a,c,"height")});c.src=b};c.readAsDataURL(b)}):Gg(a,null==a.M.Rb?
a.M.Pf:null,"height")},Pa:function(a){return null!=a.M.Rb},object:a,lb:[{selected:!1},{selected:!0}],$:function(a){return a.wd&&0<=a.wd.indexOf("height")}});a.I.add("sim:map-obstacles",{action:function(a,b){b?a.Te.show("Open obstacle SVG file",".svg",function(b){var c=new window.FileReader;c.onload=function(b){Fg(a,b.target.result,"obstacle")};c.readAsText(b)}):Fg(a,a.M.Qe?null:a.M.Qf,"obstacle")},Pa:function(a){return a.M.Qe},object:a,lb:[{selected:!1},{selected:!0}],$:function(a){return a.wd&&0<=
a.wd.indexOf("obstacles")}});a.I.add("sim:vpl",{action:function(a){a.we?a.qb(["vpl"],{ye:!0}):a.qb(["vpl"],{ue:"sim"})},isEnabled:function(a){return null==a.O||lg(a.O)},object:a,$:function(a){return(null==a.O||!a.O.ta)&&0>a.Ka.indexOf("vpl")}});a.I.add("sim:text",{action:function(a){a.we?a.qb(["src"],{ye:!0,Qg:!a.O.nd}):a.qb(["src"],{ue:"sim",Qg:!a.O.nd})},object:a,$:function(a){return 0>a.Ka.indexOf("src")}});a.I.add("sim:teacher-reset",{action:function(a){a.M.We();Cc(a)},object:a,pd:!0,$:function(a){return a.M.Zb&&
a.M.W.hc}});a.I.add("sim:teacher",{action:function(a){a.M.W.hc=!a.M.W.hc;Cc(a)},Pa:function(a){return a.M.W.hc},object:a,pd:!0,$:function(a){return a.M.Zb},lb:[{selected:!1},{selected:!0}]})};function Vg(a,c){return new sg({nc:function(b,c){a.Ga[a.la].Ma.state.b(c)},wc:function(){try{var b=(c?c.Th:hh("asebahttp"))||("http:"!==document.location.origin.slice(0,5)?"http://127.0.0.1:3000":document.location.origin);xa(b,function(){a.Ga[a.la].Ma.state=sa[0];Me(a.aa)})}catch(d){console.info(d),Me(a.aa)}},isConnected:function(){return null!=a.Ga[a.la].Ma.state},isEnabled:function(b){return"aseba"===b&&null!=a.Ga[a.la].Ma.state},getName:function(){return"Thymio (HTTP)"},fd:"aseba",languages:["aseba",
"l2"],state:null})};function Wg(a,c){var b=null;void 0==c&&(c={rc:hh("w"),vh:hh("pass")||"",Nh:hh("uuid")||"auto"});return new sg({nc:function(a,c){b.declareCustomEvents([{name:"trace",fixed_size:1},{name:"user",fixed_size:1}]);b.run(c,null,function(a){console.info("Run error");console.info(a)})},check:function(a,c,f){b.declareCustomEvents([{name:"trace",fixed_size:1},{name:"user",fixed_size:1}]);b.check(c,function(){f(null)},function(a){f(a)});return null},wc:function(){try{b=new window.TDM(c.rc,{password:c.vh||"",
uuid:c.Nh||"auto",change:function(b){a.Ga[a.la].Ma.state=b?{}:null;Me(a.aa)},events:function(b,c){"trace"===b&&be(a,c[0])}})}catch(d){console.info(d),Me(a.aa)}},close:function(){b.close()},isConnected:function(){return null!=a.Ga[a.la].Ma.state&&b.isConnected()},isEnabled:function(c){return"aseba"===c&&null!=a.Ga[a.la].Ma.state&&b.canRun()},getName:function(){return"Thymio (TDM)"},Tf:function(a,c){b.flash(c)},pf:function(c){return"aseba"===c&&null!=a.Ga[a.la].Ma.state&&b.canRun()},fd:"aseba",languages:["aseba"],
$e:!0,state:null,ja:c})};function vk(a){this.u=a||"ws://127.0.0.1:8002/";this.l={};this.i=this.b=null}vk.prototype.connect=function(){this.sc=new WebSocket(this.u);var a=this;this.sc.addEventListener("open",function(){a.sc.send(JSON.stringify({type:"nodes"}))});this.sc.addEventListener("message",function(c){try{var b=JSON.parse(c.data);switch(b.type){case "connect":if(b.id){var d=b.id;a.l[d]=b;a.b&&a.b(d,b.descr)}break;case "disconnect":d=b.id,delete a.l[d],a.i&&a.i(d)}}catch(e){}})};
vk.prototype.nc=function(a,c){this.sc.send(JSON.stringify({type:"run",id:a,bc:c}))};function jh(a){var c=null,b=hh("uuid")||null;b&&(b=b.replace(/^\{(.*)\}$/,"$1"));var d=null;return new sg({nc:function(a,f){switch(a){case "aseba":a=new Lb(d,f);a.S=Mb;var e=Nb(a);break;case "l2":a=new Lb(d,f);a.S=nh;e=Nb(a);break;case "asm":a=new ph(d,f),e=oh(a)}c.nc(b,e)},wc:function(){try{var e=hh("w")||("http:"!==document.location.origin.slice(0,5)?"ws://127.0.0.1:8002":document.location.origin.replace(/^http/,"ws"));c=new vk(e);c.b=function(c,e){if(null==b||c===b)d=new Jb(e),a.Ga[a.la].Ma.state=
{},Me(a.aa)};c.i=function(c){if(null==b||c===b)a.Ga[a.la].Ma.state=null,Me(a.aa)};c.connect()}catch(f){console.info(f),Me(a.aa)}},isConnected:function(){return null!=a.Ga[a.la].Ma.state},isEnabled:function(b){return("aseba"===b||"l2"===b||"asm"===b)&&null!=a.Ga[a.la].Ma.state},getName:function(){return"Thymio (JWS)"},fd:"aseba",languages:["aseba","l2","asm"],state:null})};
}).call(this);
